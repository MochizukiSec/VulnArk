"use strict";(self["webpackChunkvuln_management_frontend"]=self["webpackChunkvuln_management_frontend"]||[]).push([[644],{48598:(e,a,t)=>{var n=t(46518),r=t(79504),l=t(47055),s=t(25397),i=t(34598),o=r([].join),u=l!==Object,c=u||!i("join",",");n({target:"Array",proto:!0,forced:c},{join:function(e){return o(s(this),void 0===e?",":e)}})},58644:(e,a,t)=>{t.r(a),t.d(a,{default:()=>R});t(62010),t(27495),t(5746);var n=t(20641),r=t(90033),l={class:"user-management-page"},s={class:"page-header"},i={class:"header-actions"},o={class:"filter-container"},u={class:"user-table-container"},c={class:"card-header"},d={class:"table-actions"},f={class:"user-info"},p={class:"username"},m={class:"email-info"},k={class:"login-info"},g={class:"table-actions"},v={class:"pagination-container"},b={key:0,class:"dialog-header"},h={class:"user-preview"},F={class:"preview-info"},w={key:0,class:"form-tip"},_={key:0,class:"password-section"},L={class:"dialog-footer"};function y(e,a,t,y,C,V){var U=(0,n.g2)("el-button"),x=(0,n.g2)("el-option"),z=(0,n.g2)("el-select"),A=(0,n.g2)("el-form-item"),D=(0,n.g2)("el-input"),S=(0,n.g2)("el-form"),E=(0,n.g2)("el-card"),R=(0,n.g2)("el-tooltip"),W=(0,n.g2)("el-avatar"),P=(0,n.g2)("el-table-column"),T=(0,n.g2)("el-tag"),j=(0,n.g2)("el-table"),K=(0,n.g2)("el-pagination"),M=(0,n.g2)("el-dialog"),N=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",l,[(0,n.Lk)("div",s,[a[15]||(a[15]=(0,n.Fv)('<div class="header-content" data-v-4afba281><h1 class="page-title" data-v-4afba281><span class="title-icon" data-v-4afba281><i class="el-icon-user" data-v-4afba281></i></span> 用户管理 <span class="title-highlight" data-v-4afba281>中心</span></h1><p class="page-subtitle" data-v-4afba281>管理系统用户、权限和组织结构</p></div>',1)),(0,n.Lk)("div",i,[(0,n.bF)(U,{type:"primary",onClick:y.showAddUserDialog,class:"add-user-btn"},{default:(0,n.k6)((function(){return a[14]||(a[14]=[(0,n.Lk)("i",{class:"el-icon-plus"},null,-1),(0,n.eW)(" 添加用户 ")])})),_:1},8,["onClick"])])]),(0,n.Lk)("div",o,[(0,n.bF)(E,{shadow:"hover",class:"filter-card"},{header:(0,n.k6)((function(){return a[16]||(a[16]=[(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h3",{class:"filter-title"},[(0,n.Lk)("i",{class:"el-icon-search"}),(0,n.eW)(" 高级筛选 ")])],-1)])})),default:(0,n.k6)((function(){return[(0,n.bF)(S,{inline:!0,model:y.filterForm,class:"filter-form"},{default:(0,n.k6)((function(){return[(0,n.bF)(A,{label:"状态"},{default:(0,n.k6)((function(){return[(0,n.bF)(z,{modelValue:y.filterForm.status,"onUpdate:modelValue":a[0]||(a[0]=function(e){return y.filterForm.status=e}),placeholder:"选择状态",clearable:"",class:"filter-select"},{default:(0,n.k6)((function(){return[(0,n.bF)(x,{label:"已激活",value:"active"},{default:(0,n.k6)((function(){return a[17]||(a[17]=[(0,n.Lk)("div",{class:"status-option"},[(0,n.Lk)("span",{class:"status-dot active"}),(0,n.Lk)("span",null,"已激活")],-1)])})),_:1}),(0,n.bF)(x,{label:"未激活",value:"inactive"},{default:(0,n.k6)((function(){return a[18]||(a[18]=[(0,n.Lk)("div",{class:"status-option"},[(0,n.Lk)("span",{class:"status-dot inactive"}),(0,n.Lk)("span",null,"未激活")],-1)])})),_:1}),(0,n.bF)(x,{label:"已禁用",value:"disabled"},{default:(0,n.k6)((function(){return a[19]||(a[19]=[(0,n.Lk)("div",{class:"status-option"},[(0,n.Lk)("span",{class:"status-dot disabled"}),(0,n.Lk)("span",null,"已禁用")],-1)])})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,n.bF)(A,{label:"角色"},{default:(0,n.k6)((function(){return[(0,n.bF)(z,{modelValue:y.filterForm.role,"onUpdate:modelValue":a[1]||(a[1]=function(e){return y.filterForm.role=e}),placeholder:"选择角色",clearable:"",class:"filter-select"},{default:(0,n.k6)((function(){return[(0,n.bF)(x,{label:"管理员",value:"admin"},{default:(0,n.k6)((function(){return a[20]||(a[20]=[(0,n.Lk)("div",{class:"role-option"},[(0,n.Lk)("i",{class:"el-icon-s-tools role-icon admin"}),(0,n.Lk)("span",null,"管理员")],-1)])})),_:1}),(0,n.bF)(x,{label:"普通用户",value:"user"},{default:(0,n.k6)((function(){return a[21]||(a[21]=[(0,n.Lk)("div",{class:"role-option"},[(0,n.Lk)("i",{class:"el-icon-user role-icon user"}),(0,n.Lk)("span",null,"普通用户")],-1)])})),_:1}),(0,n.bF)(x,{label:"只读用户",value:"readonly"},{default:(0,n.k6)((function(){return a[22]||(a[22]=[(0,n.Lk)("div",{class:"role-option"},[(0,n.Lk)("i",{class:"el-icon-view role-icon readonly"}),(0,n.Lk)("span",null,"只读用户")],-1)])})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,n.bF)(A,{label:"搜索"},{default:(0,n.k6)((function(){return[(0,n.bF)(D,{modelValue:y.filterForm.search,"onUpdate:modelValue":a[2]||(a[2]=function(e){return y.filterForm.search=e}),placeholder:"搜索用户名、邮箱或姓名",clearable:"","prefix-icon":"el-icon-search",class:"search-input"},null,8,["modelValue"])]})),_:1}),(0,n.bF)(A,{class:"filter-buttons"},{default:(0,n.k6)((function(){return[(0,n.bF)(U,{type:"primary",onClick:y.searchUsers,class:"search-btn"},{default:(0,n.k6)((function(){return a[23]||(a[23]=[(0,n.Lk)("i",{class:"el-icon-search"},null,-1),(0,n.eW)(" 搜索 ")])})),_:1},8,["onClick"]),(0,n.bF)(U,{onClick:y.resetFilter,class:"reset-btn"},{default:(0,n.k6)((function(){return a[24]||(a[24]=[(0,n.Lk)("i",{class:"el-icon-refresh"},null,-1),(0,n.eW)(" 重置 ")])})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model"])]})),_:1})]),(0,n.Lk)("div",u,[(0,n.bF)(E,{shadow:"hover",class:"user-table-card"},{header:(0,n.k6)((function(){return[(0,n.Lk)("div",c,[a[26]||(a[26]=(0,n.Lk)("h3",{class:"user-table-title"},[(0,n.Lk)("i",{class:"el-icon-user-solid"}),(0,n.eW)(" 用户列表 ")],-1)),(0,n.Lk)("div",d,[(0,n.bF)(R,{content:"刷新列表",placement:"top"},{default:(0,n.k6)((function(){return[(0,n.bF)(U,{circle:"",size:"small",onClick:y.searchUsers},{default:(0,n.k6)((function(){return a[25]||(a[25]=[(0,n.Lk)("i",{class:"el-icon-refresh"},null,-1)])})),_:1},8,["onClick"])]})),_:1})])])]})),default:(0,n.k6)((function(){return[(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",null,[(0,n.bF)(j,{data:y.users,style:{width:"100%"},class:"user-table","header-cell-style":{background:"#f5f7fa",color:"#606266"}},{default:(0,n.k6)((function(){return[(0,n.bF)(P,{prop:"username",label:"用户名","min-width":"120"},{default:(0,n.k6)((function(e){return[(0,n.Lk)("div",f,[(0,n.bF)(W,{size:32,src:e.row.profile_picture,class:"user-avatar"},{default:(0,n.k6)((function(){return[(0,n.eW)((0,r.v_)(e.row.username.charAt(0).toUpperCase()),1)]})),_:2},1032,["src"]),(0,n.Lk)("span",p,(0,r.v_)(e.row.username),1)])]})),_:1}),(0,n.bF)(P,{prop:"name",label:"姓名","min-width":"120"},{default:(0,n.k6)((function(e){return[(0,n.Lk)("span",null,(0,r.v_)((e.row.first_name||"")+" "+(e.row.last_name||"")),1)]})),_:1}),(0,n.bF)(P,{prop:"email",label:"邮箱","min-width":"180"},{default:(0,n.k6)((function(e){return[(0,n.Lk)("div",m,[a[27]||(a[27]=(0,n.Lk)("i",{class:"el-icon-message email-icon"},null,-1)),(0,n.Lk)("span",null,(0,r.v_)(e.row.email),1)])]})),_:1}),(0,n.bF)(P,{prop:"role",label:"角色",width:"120"},{default:(0,n.k6)((function(e){return[(0,n.bF)(T,{type:y.getRoleTagType(e.row.role),effect:"light",class:"role-tag"},{default:(0,n.k6)((function(){return[(0,n.Lk)("i",{class:(0,r.C4)(["role-icon",y.getRoleIcon(e.row.role)])},null,2),(0,n.eW)(" "+(0,r.v_)(y.getRoleDisplayName(e.row.role)),1)]})),_:2},1032,["type"])]})),_:1}),(0,n.bF)(P,{prop:"status",label:"状态",width:"100"},{default:(0,n.k6)((function(e){return[(0,n.bF)(T,{type:y.getStatusTagType(e.row.status),effect:"light",class:"status-tag"},{default:(0,n.k6)((function(){return[(0,n.Lk)("span",{class:(0,r.C4)(["status-dot",e.row.status])},null,2),(0,n.eW)(" "+(0,r.v_)(y.getStatusDisplayName(e.row.status)),1)]})),_:2},1032,["type"])]})),_:1}),(0,n.bF)(P,{prop:"last_login",label:"最后登录",width:"180"},{default:(0,n.k6)((function(e){return[(0,n.Lk)("div",k,[a[28]||(a[28]=(0,n.Lk)("i",{class:"el-icon-time login-icon"},null,-1)),(0,n.Lk)("span",null,(0,r.v_)(y.formatDateTime(e.row.last_login)),1)])]})),_:1}),(0,n.bF)(P,{label:"操作",width:"220",fixed:"right"},{default:(0,n.k6)((function(e){return[(0,n.Lk)("div",g,[(0,n.bF)(U,{size:"small",type:"primary",onClick:function(a){return y.showEditUserDialog(e.row)},class:"action-btn edit-btn"},{default:(0,n.k6)((function(){return a[29]||(a[29]=[(0,n.Lk)("i",{class:"el-icon-edit"},null,-1),(0,n.eW)(" 编辑 ")])})),_:2},1032,["onClick"]),(0,n.bF)(U,{size:"small",type:"active"===e.row.status?"warning":"success",onClick:function(a){return y.toggleUserStatus(e.row)},class:"action-btn toggle-btn"},{default:(0,n.k6)((function(){return[(0,n.Lk)("i",{class:(0,r.C4)("active"===e.row.status?"el-icon-lock":"el-icon-unlock")},null,2),(0,n.eW)(" "+(0,r.v_)("active"===e.row.status?"禁用":"启用"),1)]})),_:2},1032,["type","onClick"]),(0,n.bF)(U,{size:"small",type:"danger",onClick:function(a){return y.confirmDeleteUser(e.row)},class:"action-btn delete-btn"},{default:(0,n.k6)((function(){return a[30]||(a[30]=[(0,n.Lk)("i",{class:"el-icon-delete"},null,-1),(0,n.eW)(" 删除 ")])})),_:2},1032,["onClick"])])]})),_:1})]})),_:1},8,["data"]),(0,n.Lk)("div",v,[(0,n.bF)(K,{currentPage:y.pagination.page,"onUpdate:currentPage":a[3]||(a[3]=function(e){return y.pagination.page=e}),"page-size":y.pagination.pageSize,"onUpdate:pageSize":a[4]||(a[4]=function(e){return y.pagination.pageSize=e}),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:y.pagination.total,onSizeChange:y.handleSizeChange,onCurrentChange:y.handlePageChange,background:"",class:"pagination"},null,8,["currentPage","page-size","total","onSizeChange","onCurrentChange"])])])),[[N,y.loading]])]})),_:1})]),(0,n.bF)(M,{title:y.isEditMode?"编辑用户":"添加用户",modelValue:y.userDialogVisible,"onUpdate:modelValue":a[13]||(a[13]=function(e){return y.userDialogVisible=e}),width:"520px",class:"user-dialog","destroy-on-close":""},{footer:(0,n.k6)((function(){return[(0,n.Lk)("div",L,[(0,n.bF)(U,{onClick:a[12]||(a[12]=function(e){return y.userDialogVisible=!1}),class:"cancel-btn"},{default:(0,n.k6)((function(){return a[39]||(a[39]=[(0,n.eW)("取消")])})),_:1}),(0,n.bF)(U,{type:"primary",onClick:y.submitUserForm,loading:y.submitting,class:"submit-btn"},{default:(0,n.k6)((function(){return[(0,n.eW)((0,r.v_)(y.isEditMode?"保存修改":"创建用户"),1)]})),_:1},8,["onClick","loading"])])]})),default:(0,n.k6)((function(){return[y.isEditMode?((0,n.uX)(),(0,n.CE)("div",b,[(0,n.Lk)("div",h,[(0,n.bF)(W,{size:60,src:y.userForm.profile_picture,class:"preview-avatar"},{default:(0,n.k6)((function(){return[(0,n.eW)((0,r.v_)(y.userForm.username?y.userForm.username.charAt(0).toUpperCase():"U"),1)]})),_:1},8,["src"]),(0,n.Lk)("div",F,[(0,n.Lk)("h3",null,(0,r.v_)(y.userForm.username||"新用户"),1),(0,n.Lk)("p",null,(0,r.v_)(y.userForm.email||"无邮箱信息"),1)])])])):(0,n.Q3)("",!0),(0,n.bF)(S,{ref:"userFormRef",model:y.userForm,rules:y.userFormRules,"label-width":"100px",class:"user-form"},{default:(0,n.k6)((function(){return[(0,n.bF)(A,{label:"用户名",prop:"username"},{default:(0,n.k6)((function(){return[(0,n.bF)(D,{modelValue:y.userForm.username,"onUpdate:modelValue":a[5]||(a[5]=function(e){return y.userForm.username=e}),disabled:y.isEditMode,"prefix-icon":"el-icon-user",placeholder:"请输入用户名"},null,8,["modelValue","disabled"]),y.isEditMode?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",w,"用户名一旦创建无法修改"))]})),_:1}),(0,n.bF)(A,{label:"姓名",prop:"name"},{default:(0,n.k6)((function(){return[(0,n.bF)(D,{modelValue:y.userForm.name,"onUpdate:modelValue":a[6]||(a[6]=function(e){return y.userForm.name=e}),"prefix-icon":"el-icon-user",placeholder:"请输入姓名"},null,8,["modelValue"])]})),_:1}),(0,n.bF)(A,{label:"邮箱",prop:"email"},{default:(0,n.k6)((function(){return[(0,n.bF)(D,{modelValue:y.userForm.email,"onUpdate:modelValue":a[7]||(a[7]=function(e){return y.userForm.email=e}),type:"email","prefix-icon":"el-icon-message",placeholder:"请输入邮箱地址"},null,8,["modelValue"])]})),_:1}),(0,n.bF)(A,{label:"角色",prop:"role"},{default:(0,n.k6)((function(){return[(0,n.bF)(z,{modelValue:y.userForm.role,"onUpdate:modelValue":a[8]||(a[8]=function(e){return y.userForm.role=e}),style:{width:"100%"},placeholder:"请选择用户角色"},{default:(0,n.k6)((function(){return[(0,n.bF)(x,{label:"管理员",value:"admin"},{default:(0,n.k6)((function(){return a[31]||(a[31]=[(0,n.Lk)("div",{class:"role-option"},[(0,n.Lk)("i",{class:"el-icon-s-tools role-icon admin"}),(0,n.Lk)("span",null,"管理员")],-1)])})),_:1}),(0,n.bF)(x,{label:"普通用户",value:"user"},{default:(0,n.k6)((function(){return a[32]||(a[32]=[(0,n.Lk)("div",{class:"role-option"},[(0,n.Lk)("i",{class:"el-icon-user role-icon user"}),(0,n.Lk)("span",null,"普通用户")],-1)])})),_:1}),(0,n.bF)(x,{label:"只读用户",value:"readonly"},{default:(0,n.k6)((function(){return a[33]||(a[33]=[(0,n.Lk)("div",{class:"role-option"},[(0,n.Lk)("i",{class:"el-icon-view role-icon readonly"}),(0,n.Lk)("span",null,"只读用户")],-1)])})),_:1})]})),_:1},8,["modelValue"]),a[34]||(a[34]=(0,n.Lk)("div",{class:"form-tip"},"管理员拥有系统所有权限",-1))]})),_:1}),(0,n.bF)(A,{label:"状态",prop:"status"},{default:(0,n.k6)((function(){return[(0,n.bF)(z,{modelValue:y.userForm.status,"onUpdate:modelValue":a[9]||(a[9]=function(e){return y.userForm.status=e}),style:{width:"100%"},placeholder:"请选择账户状态"},{default:(0,n.k6)((function(){return[(0,n.bF)(x,{label:"已激活",value:"active"},{default:(0,n.k6)((function(){return a[35]||(a[35]=[(0,n.Lk)("div",{class:"status-option"},[(0,n.Lk)("span",{class:"status-dot active"}),(0,n.Lk)("span",null,"已激活")],-1)])})),_:1}),(0,n.bF)(x,{label:"未激活",value:"inactive"},{default:(0,n.k6)((function(){return a[36]||(a[36]=[(0,n.Lk)("div",{class:"status-option"},[(0,n.Lk)("span",{class:"status-dot inactive"}),(0,n.Lk)("span",null,"未激活")],-1)])})),_:1}),(0,n.bF)(x,{label:"已禁用",value:"disabled"},{default:(0,n.k6)((function(){return a[37]||(a[37]=[(0,n.Lk)("div",{class:"status-option"},[(0,n.Lk)("span",{class:"status-dot disabled"}),(0,n.Lk)("span",null,"已禁用")],-1)])})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),y.isEditMode?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",_,[a[38]||(a[38]=(0,n.Lk)("div",{class:"section-header"},[(0,n.Lk)("i",{class:"el-icon-lock"}),(0,n.Lk)("span",null,"密码设置")],-1)),(0,n.bF)(A,{label:"密码",prop:"password"},{default:(0,n.k6)((function(){return[(0,n.bF)(D,{modelValue:y.userForm.password,"onUpdate:modelValue":a[10]||(a[10]=function(e){return y.userForm.password=e}),type:"password","prefix-icon":"el-icon-lock",placeholder:"请输入密码","show-password":""},null,8,["modelValue"])]})),_:1}),(0,n.bF)(A,{label:"确认密码",prop:"confirmPassword"},{default:(0,n.k6)((function(){return[(0,n.bF)(D,{modelValue:y.userForm.confirmPassword,"onUpdate:modelValue":a[11]||(a[11]=function(e){return y.userForm.confirmPassword=e}),type:"password","prefix-icon":"el-icon-lock",placeholder:"请再次输入密码","show-password":""},null,8,["modelValue"])]})),_:1})]))]})),_:1},8,["model","rules"])]})),_:1},8,["title","modelValue"])])}var C=t(14048),V=t(30388),U=(t(16280),t(76918),t(28706),t(48598),t(34782),t(23288),t(42762),t(50953)),x=t(20163),z=t(77918),A=t(66278);const D={name:"UserManagement",setup:function(){var e=(0,A.Pj)(),a=(0,U.KR)(!1),t=(0,U.KR)(!1),r=(0,U.Kh)({status:"",role:"",search:""}),l=(0,U.Kh)({page:1,pageSize:10,total:0}),s=(0,U.KR)(!1),i=(0,U.KR)(null),o=(0,U.KR)(!1),u=(0,U.Kh)({id:"",username:"",name:"",email:"",role:"user",status:"active",password:"",confirmPassword:""}),c={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在3到20个字符之间",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码至少需要6个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:function(e,a,t){a!==u.password?t(new Error("两次输入的密码不一致")):t()},trigger:"blur"}]},d=(0,n.EW)((function(){return e.getters["user/allUsers"]})),f=function(e){var a={admin:"管理员",user:"普通用户",readonly:"只读用户"};return a[e]||e},p=function(e){var a={admin:"danger",user:"primary",readonly:"info"};return a[e]||""},m=function(e){var a={admin:"el-icon-s-tools",user:"el-icon-user",readonly:"el-icon-view"};return a[e]||"el-icon-user"},k=function(e){var a={active:"已激活",inactive:"未激活",disabled:"已禁用"};return a[e]||e},g=function(e){var a={active:"success",inactive:"warning",disabled:"info"};return a[e]||""},v=function(e){if(!e)return"从未登录";try{var a=new Date(e);return isNaN(a.getTime())?"无效日期":a.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("日期格式化错误:",t),"无效日期"}},b=function(){var t=(0,V.A)((0,C.A)().mark((function t(){var n;return(0,C.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a.value=!0,t.prev=1,t.next=4,e.dispatch("user/fetchUsers",{page:l.page,limit:l.pageSize,search:r.search,status:r.status,role:r.role});case 4:n=e.getters["user/pagination"],l.total=n.total,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),x.nk.error("加载用户数据失败: ".concat(t.t0.message||"未知错误"));case 11:return t.prev=11,a.value=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,8,11,14]])})));return function(){return t.apply(this,arguments)}}();(0,n.sV)((function(){b()}));var h=function(e){l.page=e,b()},F=function(e){l.pageSize=e,l.page=1,b()},w=function(){o.value=!1,Object.assign(u,{id:"",username:"",name:"",email:"",role:"user",status:"active",password:"",confirmPassword:""}),s.value=!0},_=function(e){o.value=!0,Object.assign(u,{id:e.id,username:e.username,first_name:e.first_name||"",last_name:e.last_name||"",name:"".concat(e.first_name||""," ").concat(e.last_name||"").trim(),email:e.email,role:e.role,status:e.status,password:"",confirmPassword:""}),s.value=!0},L=function(){var a=(0,V.A)((0,C.A)().mark((function a(){return(0,C.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,i.value.validate(function(){var a=(0,V.A)((0,C.A)().mark((function a(n,r){var l,i,c,d,f;return(0,C.A)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!n){a.next=29;break}if(t.value=!0,a.prev=2,l=u.name.trim().split(" "),i=l[0]||"",c=l.length>1?l.slice(1).join(" "):"",d={username:u.username,email:u.email,first_name:i,last_name:c||" ",department:"",role:u.role,status:u.status},o.value?u.password&&(d.new_password=u.password):d.password=u.password,console.log("提交的用户数据:",d),!o.value){a.next=15;break}return a.next=12,e.dispatch("user/updateUser",{id:u.id,data:d});case 12:x.nk.success("用户信息已成功更新"),a.next=18;break;case 15:return a.next=17,e.dispatch("user/createUser",d);case 17:x.nk.success("用户已成功创建");case 18:s.value=!1,b(),a.next=26;break;case 22:a.prev=22,a.t0=a["catch"](2),console.error("操作失败:",a.t0),x.nk.error("操作失败: ".concat((null===(f=a.t0.response)||void 0===f||null===(f=f.data)||void 0===f?void 0:f.error)||a.t0.message||"未知错误"));case 26:return a.prev=26,t.value=!1,a.finish(26);case 29:case"end":return a.stop()}}),a,null,[[2,22,26,29]])})));return function(e,t){return a.apply(this,arguments)}}());case 2:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),y=function(t){z.s.confirm("确定要删除用户 ".concat(t.name||t.username," 吗？此操作不可恢复。"),"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((0,V.A)((0,C.A)().mark((function n(){var r;return(0,C.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.value=!0,n.prev=1,n.next=4,e.dispatch("user/deleteUser",t.id);case 4:x.nk.success("用户已成功删除"),b(),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](1),x.nk.error("删除失败: ".concat((null===(r=n.t0.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.error)||n.t0.message||"未知错误"));case 11:return n.prev=11,a.value=!1,n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[1,8,11,14]])}))))["catch"]((function(){}))},D=function(){var t=(0,V.A)((0,C.A)().mark((function t(n){var r,l;return(0,C.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a.value=!0,t.prev=1,r="active"===n.status?"disabled":"active",t.next=5,e.dispatch("user/updateUser",{id:n.id,data:{status:r}});case 5:x.nk.success("用户状态已更新为".concat(k(r))),b(),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),console.error("状态更新失败:",t.t0),x.nk.error("更新状态失败: ".concat((null===(l=t.t0.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.error)||t.t0.message||"未知错误"));case 13:return t.prev=13,a.value=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,9,13,16]])})));return function(e){return t.apply(this,arguments)}}(),S=function(){Object.assign(r,{status:"",role:"",search:""}),b()};return{users:d,loading:a,submitting:t,filterForm:r,pagination:l,userDialogVisible:s,userFormRef:i,userForm:u,userFormRules:c,isEditMode:o,getRoleDisplayName:f,getRoleTagType:p,getRoleIcon:m,getStatusDisplayName:k,getStatusTagType:g,formatDateTime:v,searchUsers:b,resetFilter:S,handlePageChange:h,handleSizeChange:F,showAddUserDialog:w,showEditUserDialog:_,submitUserForm:L,confirmDeleteUser:y,toggleUserStatus:D}}};var S=t(66262);const E=(0,S.A)(D,[["render",y],["__scopeId","data-v-4afba281"]]),R=E}}]);
//# sourceMappingURL=644.c5dc67d1.js.map