"use strict";(self["webpackChunkvuln_management_frontend"]=self["webpackChunkvuln_management_frontend"]||[]).push([[805],{20713:(e,t,r)=>{var n=r(69565),a=r(79306),u=r(28551),o=r(1767),l=r(19462),i=r(96319),s=l((function(){var e=this.iterator,t=u(n(this.next,e)),r=this.done=!!t.done;if(!r)return i(e,this.mapper,[t.value,this.counter++],!0)}));e.exports=function(e){return u(this),a(e),new s(o(this),{mapper:e})}},21699:(e,t,r)=>{var n=r(46518),a=r(79504),u=r(60511),o=r(67750),l=r(655),i=r(41436),s=a("".indexOf);n({target:"String",proto:!0,forced:!i("includes")},{includes:function(e){return!!~s(l(o(this)),l(u(e)),arguments.length>1?arguments[1]:void 0)}})},32375:(e,t,r)=>{r.d(t,{A:()=>u});r(28706);var n=r(94335),a="http://server:8080";const u={getAssets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return console.log("获取资产列表:",{baseURL:n.A.defaults.baseURL,endpoint:"".concat(a,"/api/assets"),params:e}),n.A.get("".concat(a,"/api/assets"),{params:e})},getAssetById:function(e){return n.A.get("".concat(a,"/api/assets/").concat(e))},createAsset:function(e){return n.A.post("".concat(a,"/api/assets"),e)},updateAsset:function(e,t){return n.A.put("".concat(a,"/api/assets/").concat(e),t)},deleteAsset:function(e){return n.A["delete"]("".concat(a,"/api/assets/").concat(e))},getAssetVulnerabilities:function(e){return n.A.get("".concat(a,"/api/assets/").concat(e,"/vulnerabilities"))},addVulnerabilityToAsset:function(e,t){return console.log("添加漏洞到资产: ".concat(e,", 漏洞ID: ").concat(t)),n.A.post("".concat(a,"/api/assets/").concat(e,"/vulnerabilities"),{vulnerabilityId:t})},removeVulnerabilityFromAsset:function(e,t){return n.A["delete"]("".concat(a,"/api/assets/").concat(e,"/vulnerabilities/").concat(t))},addAssetNote:function(e,t){return n.A.post("".concat(a,"/api/assets/").concat(e,"/notes"),{content:t})},importAssets:function(e){return n.A.post("".concat(a,"/api/assets/import"),e,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4,onUploadProgress:function(e){console.log("上传进度:",Math.round(100*e.loaded/e.total)+"%")}})},downloadImportTemplate:function(){return n.A.get("".concat(a,"/api/assets/import-template"),{responseType:"blob"})}}},41436:(e,t,r)=>{var n=r(78227),a=n("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[a]=!1,"/./"[e](t)}catch(n){}}return!1}},52703:(e,t,r)=>{var n=r(44576),a=r(79039),u=r(79504),o=r(655),l=r(43802).trim,i=r(47452),s=n.parseInt,c=n.Symbol,d=c&&c.iterator,p=/^[+-]?0x/i,f=u(p.exec),m=8!==s(i+"08")||22!==s(i+"0x16")||d&&!a((function(){s(Object(d))}));e.exports=m?function(e,t){var r=l(o(e));return s(r,t>>>0||(f(p,r)?16:10))}:s},58940:(e,t,r)=>{var n=r(46518),a=r(52703);n({global:!0,forced:parseInt!==a},{parseInt:a})},60511:(e,t,r)=>{var n=r(60788),a=TypeError;e.exports=function(e){if(n(e))throw new a("The method doesn't accept regular expressions");return e}},60788:(e,t,r)=>{var n=r(20034),a=r(22195),u=r(78227),o=u("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[o])?!!t:"RegExp"===a(e))}},61701:(e,t,r)=>{var n=r(46518),a=r(20713),u=r(96395);n({target:"Iterator",proto:!0,real:!0,forced:u},{map:a})},62062:(e,t,r)=>{var n=r(46518),a=r(59213).map,u=r(70597),o=u("map");n({target:"Array",proto:!0,forced:!o},{map:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},74423:(e,t,r)=>{var n=r(46518),a=r(19617).includes,u=r(79039),o=r(6469),l=u((function(){return!Array(1).includes()}));n({target:"Array",proto:!0,forced:l},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},95805:(e,t,r)=>{r.r(t),r.d(t,{default:()=>y});r(52675),r(89463),r(62010);var n=r(20641),a=r(90033),u=r(53751),o={class:"asset-form"},l={class:"back-link"},i={class:"page-title"},s={class:"form-actions"};function c(e,t,r,c,d,p){var f=(0,n.g2)("el-button"),m=(0,n.g2)("el-input"),b=(0,n.g2)("el-form-item"),v=(0,n.g2)("el-col"),g=(0,n.g2)("el-option"),k=(0,n.g2)("el-select"),A=(0,n.g2)("el-row"),F=(0,n.g2)("el-radio"),h=(0,n.g2)("el-radio-group"),_=(0,n.g2)("el-tag"),y=(0,n.g2)("el-form"),V=(0,n.g2)("el-card"),x=(0,n.gN)("loading");return(0,n.bo)(((0,n.uX)(),(0,n.CE)("div",o,[(0,n.Lk)("div",l,[(0,n.bF)(f,{onClick:t[0]||(t[0]=function(t){return e.$router.back()}),icon:"el-icon-arrow-left",type:"text"},{default:(0,n.k6)((function(){return t[14]||(t[14]=[(0,n.eW)("返回")])})),_:1})]),(0,n.Lk)("h1",i,(0,a.v_)(c.isEdit?"编辑资产":"创建资产"),1),(0,n.bF)(V,{class:"form-card"},{default:(0,n.k6)((function(){return[(0,n.bF)(y,{ref:"formRef",model:c.formData,rules:c.rules,"label-width":"100px","label-position":"top"},{default:(0,n.k6)((function(){return[t[24]||(t[24]=(0,n.Lk)("h2",{class:"form-section-title"},"基本信息",-1)),(0,n.bF)(A,{gutter:20},{default:(0,n.k6)((function(){return[(0,n.bF)(v,{span:12},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"资产名称",prop:"name"},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:c.formData.name,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.formData.name=e}),placeholder:"请输入资产名称"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.bF)(v,{span:12},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"资产类型",prop:"type"},{default:(0,n.k6)((function(){return[(0,n.bF)(k,{modelValue:c.formData.type,"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.formData.type=e}),placeholder:"请选择资产类型",style:{width:"100%"}},{default:(0,n.k6)((function(){return[(0,n.bF)(g,{label:"服务器",value:"server"}),(0,n.bF)(g,{label:"网络设备",value:"network_device"}),(0,n.bF)(g,{label:"应用程序",value:"application"}),(0,n.bF)(g,{label:"数据库",value:"database"}),(0,n.bF)(g,{label:"云资源",value:"cloud_resource"}),(0,n.bF)(g,{label:"物联网设备",value:"iot_device"}),(0,n.bF)(g,{label:"其他",value:"other"})]})),_:1},8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(b,{label:"描述",prop:"description"},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:c.formData.description,"onUpdate:modelValue":t[3]||(t[3]=function(e){return c.formData.description=e}),type:"textarea",rows:3,placeholder:"请输入资产描述"},null,8,["modelValue"])]})),_:1}),(0,n.bF)(A,{gutter:20},{default:(0,n.k6)((function(){return[(0,n.bF)(v,{span:12},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"IP地址",prop:"ipAddress"},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:c.formData.ipAddress,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.formData.ipAddress=e}),placeholder:"例如: 192.168.1.1"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.bF)(v,{span:12},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"域名",prop:"domain"},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:c.formData.domain,"onUpdate:modelValue":t[5]||(t[5]=function(e){return c.formData.domain=e}),placeholder:"例如: example.com"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(A,{gutter:20},{default:(0,n.k6)((function(){return[(0,n.bF)(v,{span:12},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"MAC地址",prop:"macAddress"},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:c.formData.macAddress,"onUpdate:modelValue":t[6]||(t[6]=function(e){return c.formData.macAddress=e}),placeholder:"例如: 00:1A:2B:3C:4D:5E"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.bF)(v,{span:12},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"操作系统",prop:"operatingSystem"},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:c.formData.operatingSystem,"onUpdate:modelValue":t[7]||(t[7]=function(e){return c.formData.operatingSystem=e}),placeholder:"例如: Windows Server 2019"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(A,{gutter:20},{default:(0,n.k6)((function(){return[(0,n.bF)(v,{span:12},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"责任人",prop:"owner"},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:c.formData.owner,"onUpdate:modelValue":t[8]||(t[8]=function(e){return c.formData.owner=e}),placeholder:"请输入责任人姓名"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.bF)(v,{span:12},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"部门",prop:"department"},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:c.formData.department,"onUpdate:modelValue":t[9]||(t[9]=function(e){return c.formData.department=e}),placeholder:"请输入所属部门"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.bF)(b,{label:"环境",prop:"environment"},{default:(0,n.k6)((function(){return[(0,n.bF)(h,{modelValue:c.formData.environment,"onUpdate:modelValue":t[10]||(t[10]=function(e){return c.formData.environment=e})},{default:(0,n.k6)((function(){return[(0,n.bF)(F,{label:"production"},{default:(0,n.k6)((function(){return t[15]||(t[15]=[(0,n.eW)("生产环境")])})),_:1}),(0,n.bF)(F,{label:"testing"},{default:(0,n.k6)((function(){return t[16]||(t[16]=[(0,n.eW)("测试环境")])})),_:1}),(0,n.bF)(F,{label:"development"},{default:(0,n.k6)((function(){return t[17]||(t[17]=[(0,n.eW)("开发环境")])})),_:1}),(0,n.bF)(F,{label:"staging"},{default:(0,n.k6)((function(){return t[18]||(t[18]=[(0,n.eW)("预生产环境")])})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,n.bF)(b,{label:"状态",prop:"status"},{default:(0,n.k6)((function(){return[(0,n.bF)(h,{modelValue:c.formData.status,"onUpdate:modelValue":t[11]||(t[11]=function(e){return c.formData.status=e})},{default:(0,n.k6)((function(){return[(0,n.bF)(F,{label:"active"},{default:(0,n.k6)((function(){return t[19]||(t[19]=[(0,n.eW)("活动")])})),_:1}),(0,n.bF)(F,{label:"inactive"},{default:(0,n.k6)((function(){return t[20]||(t[20]=[(0,n.eW)("不活动")])})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,n.bF)(b,{label:"开放端口",prop:"ports"},{default:(0,n.k6)((function(){return[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(c.formData.ports,(function(e){return(0,n.uX)(),(0,n.Wv)(_,{key:e,closable:"",onClose:function(t){return c.removePort(e)},class:"port-tag"},{default:(0,n.k6)((function(){return[(0,n.eW)((0,a.v_)(e),1)]})),_:2},1032,["onClose"])})),128)),c.portInputVisible?((0,n.uX)(),(0,n.Wv)(m,{key:0,ref:"portInputRef",modelValue:c.portInput,"onUpdate:modelValue":t[12]||(t[12]=function(e){return c.portInput=e}),class:"port-input",size:"small",onKeyup:(0,u.jR)(c.addPort,["enter"]),onBlur:c.addPort},null,8,["modelValue","onKeyup","onBlur"])):((0,n.uX)(),(0,n.Wv)(f,{key:1,size:"small",onClick:c.showPortInput},{default:(0,n.k6)((function(){return t[21]||(t[21]=[(0,n.eW)("+ 添加端口")])})),_:1},8,["onClick"]))]})),_:1}),t[25]||(t[25]=(0,n.Lk)("h2",{class:"form-section-title"},"自定义属性",-1)),t[26]||(t[26]=(0,n.Lk)("p",{class:"section-description"},"添加此资产的自定义属性",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(c.attributes,(function(e,t){return(0,n.uX)(),(0,n.CE)("div",{key:t,class:"attribute-item"},[(0,n.bF)(A,{gutter:20},{default:(0,n.k6)((function(){return[(0,n.bF)(v,{span:10},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"属性名 ".concat(t+1),prop:"attributes[".concat(t,"].key"),rules:c.attributeRules.key},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:e.key,"onUpdate:modelValue":function(t){return e.key=t},placeholder:"请输入属性名"},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["label","prop","rules"])]})),_:2},1024),(0,n.bF)(v,{span:10},{default:(0,n.k6)((function(){return[(0,n.bF)(b,{label:"属性值 ".concat(t+1),prop:"attributes[".concat(t,"].value"),rules:c.attributeRules.value},{default:(0,n.k6)((function(){return[(0,n.bF)(m,{modelValue:e.value,"onUpdate:modelValue":function(t){return e.value=t},placeholder:"请输入属性值"},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["label","prop","rules"])]})),_:2},1024),(0,n.bF)(v,{span:4,class:"delete-col"},{default:(0,n.k6)((function(){return[(0,n.bF)(f,{type:"danger",icon:"el-icon-delete",circle:"",onClick:function(e){return c.removeAttribute(t)},size:"small",class:"delete-btn"},null,8,["onClick"])]})),_:2},1024)]})),_:2},1024)])})),128)),(0,n.bF)(f,{type:"dashed",icon:"el-icon-plus",onClick:c.addAttribute,class:"add-attribute-btn"},{default:(0,n.k6)((function(){return t[22]||(t[22]=[(0,n.eW)(" 添加自定义属性 ")])})),_:1},8,["onClick"]),(0,n.Lk)("div",s,[(0,n.bF)(f,{onClick:t[13]||(t[13]=function(t){return e.$router.back()})},{default:(0,n.k6)((function(){return t[23]||(t[23]=[(0,n.eW)("取消")])})),_:1}),(0,n.bF)(f,{type:"primary",onClick:c.submitForm},{default:(0,n.k6)((function(){return[(0,n.eW)((0,a.v_)(c.isEdit?"保存修改":"创建资产"),1)]})),_:1},8,["onClick"])])]})),_:1},8,["model","rules"])]})),_:1})])),[[x,c.loading]])}var d=r(29201),p=r(14048),f=r(54119),m=r(78676),b=r(30388),v=(r(2008),r(51629),r(74423),r(62062),r(44114),r(54554),r(60739),r(18111),r(22489),r(7588),r(61701),r(33110),r(5506),r(79432),r(26099),r(58940),r(21699),r(42762),r(23500),r(50953)),g=r(75220),k=r(20163),A=r(32375);const F={name:"AssetForm",setup:function(){var e=(0,g.lq)(),t=(0,g.rd)(),r=(0,v.KR)(null),a=(0,v.KR)(!1),u=(0,n.EW)((function(){return!!e.params.id})),o=(0,v.Kh)({name:"",type:"",description:"",ipAddress:"",domain:"",macAddress:"",operatingSystem:"",owner:"",department:"",environment:"production",status:"active",ports:[]}),l=(0,v.KR)(!1),i=(0,v.KR)(null),s=(0,v.KR)(""),c=(0,v.KR)([]),F={name:[{required:!0,message:"请输入资产名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择资产类型",trigger:"change"}],status:[{required:!0,message:"请选择资产状态",trigger:"change"}],description:[{max:500,message:"描述不能超过500个字符",trigger:"blur"}],ipAddress:[{pattern:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,message:"请输入有效的IP地址",trigger:"blur"}],domain:[{pattern:/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,message:"请输入有效的域名",trigger:"blur"}],macAddress:[{pattern:/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/,message:"请输入有效的MAC地址",trigger:"blur"}],environment:[{required:!0,message:"请选择环境",trigger:"change"}]},h={key:[{required:!0,message:"请输入属性名",trigger:"blur"},{max:50,message:"属性名不能超过50个字符",trigger:"blur"}],value:[{required:!0,message:"请输入属性值",trigger:"blur"},{max:200,message:"属性值不能超过200个字符",trigger:"blur"}]},_=function(){var t=(0,b.A)((0,p.A)().mark((function t(){var r,n;return(0,p.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(u.value){t.next=2;break}return t.abrupt("return");case 2:return a.value=!0,t.prev=3,t.next=6,A.A.getAssetById(e.params.id);case 6:r=t.sent,n=r.data,Object.keys(o).forEach((function(e){e in n&&(o[e]=n[e])})),n.attributes&&(c.value=Object.entries(n.attributes).map((function(e){var t=(0,m.A)(e,2),r=t[0],n=t[1];return{key:r,value:"object"===(0,f.A)(n)?JSON.stringify(n):n}}))),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](3),console.error("获取资产详情失败:",t.t0),k.nk.error("获取资产详情失败，请重试");case 16:return t.prev=16,a.value=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[3,12,16,19]])})));return function(){return t.apply(this,arguments)}}(),y=function(){l.value=!0,(0,n.dY)((function(){i.value.focus()}))},V=function(){if(s.value&&s.value.trim()){var e=parseInt(s.value.trim());!isNaN(e)&&e>0&&e<=65535?o.ports.includes(e)||o.ports.push(e):k.nk.warning("请输入有效的端口号(1-65535)")}l.value=!1,s.value=""},x=function(e){o.ports=o.ports.filter((function(t){return t!==e}))},w=function(){c.value.push({key:"",value:""})},D=function(e){c.value.splice(e,1)},I=function(){var n=(0,b.A)((0,p.A)().mark((function n(){return(0,p.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.value){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,r.value.validate(function(){var r=(0,b.A)((0,p.A)().mark((function r(n){var l,i;return(0,p.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n){r.next=3;break}return k.nk.error("请正确填写表单信息"),r.abrupt("return");case 3:if(l={},c.value.forEach((function(e){e.key&&e.value&&(l[e.key]=e.value)})),i=(0,d.A)((0,d.A)({},o),{},{attributes:l}),a.value=!0,r.prev=7,!u.value){r.next=14;break}return r.next=11,A.A.updateAsset(e.params.id,i);case 11:k.nk.success("资产更新成功"),r.next=17;break;case 14:return r.next=16,A.A.createAsset(i);case 16:k.nk.success("资产创建成功");case 17:t.push({name:"AssetList"}),r.next=24;break;case 20:r.prev=20,r.t0=r["catch"](7),console.error("操作失败:",r.t0),k.nk.error("".concat(u.value?"更新":"创建","资产失败，请重试"));case 24:return r.prev=24,a.value=!1,r.finish(24);case 27:case"end":return r.stop()}}),r,null,[[7,20,24,27]])})));return function(e){return r.apply(this,arguments)}}());case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,n.sV)((function(){_()})),{formRef:r,formData:o,rules:F,attributeRules:h,loading:a,isEdit:u,attributes:c,portInputVisible:l,portInputRef:i,portInput:s,showPortInput:y,addPort:V,removePort:x,addAttribute:w,removeAttribute:D,submitForm:I}}};var h=r(66262);const _=(0,h.A)(F,[["render",c],["__scopeId","data-v-ef7fb0de"]]),y=_}}]);
//# sourceMappingURL=805.1b374fd6.js.map