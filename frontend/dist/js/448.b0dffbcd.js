"use strict";(self["webpackChunkvuln_management_frontend"]=self["webpackChunkvuln_management_frontend"]||[]).push([[448],{30448:(e,n,r)=>{r.r(n),r.d(n,{default:()=>k});r(52675),r(89463);var t=r(20641),l={class:"vuln-create-container"},u={class:"form-container"},a={class:"form-actions"};function o(e,n,r,o,s,d){var i=(0,t.g2)("el-page-header"),c=(0,t.g2)("el-input"),f=(0,t.g2)("el-form-item"),m=(0,t.g2)("el-col"),p=(0,t.g2)("el-input-number"),b=(0,t.g2)("el-option"),v=(0,t.g2)("el-select"),F=(0,t.g2)("el-row"),k=(0,t.g2)("el-card"),g=(0,t.g2)("el-date-picker"),h=(0,t.g2)("Delete"),V=(0,t.g2)("el-icon"),_=(0,t.g2)("el-button"),y=(0,t.g2)("Plus"),D=(0,t.g2)("el-form"),C=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",l,[(0,t.bF)(i,{title:"漏洞库",onBack:o.goBack},{content:(0,t.k6)((function(){return n[9]||(n[9]=[(0,t.Lk)("span",{class:"header-title"},"创建新漏洞",-1)])})),_:1},8,["onBack"]),(0,t.Lk)("div",u,[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(D,{ref:"vulnFormRef",model:o.vulnForm,rules:o.rules,"label-position":"top",class:"vuln-form"},{default:(0,t.k6)((function(){return[(0,t.bF)(k,{class:"form-card"},{header:(0,t.k6)((function(){return n[10]||(n[10]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h3",null,"基本信息"),(0,t.Lk)("div",{class:"required-note"},"* 必填项")],-1)])})),default:(0,t.k6)((function(){return[(0,t.bF)(F,{gutter:20},{default:(0,t.k6)((function(){return[(0,t.bF)(m,{sm:24,md:12},{default:(0,t.k6)((function(){return[(0,t.bF)(f,{label:"CVE ID",prop:"cveId"},{default:(0,t.k6)((function(){return[(0,t.bF)(c,{modelValue:o.vulnForm.cveId,"onUpdate:modelValue":n[0]||(n[0]=function(e){return o.vulnForm.cveId=e}),placeholder:"例如: CVE-2023-1234"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,t.bF)(m,{sm:24,md:12},{default:(0,t.k6)((function(){return[(0,t.bF)(f,{label:"标题",prop:"title",required:""},{default:(0,t.k6)((function(){return[(0,t.bF)(c,{modelValue:o.vulnForm.title,"onUpdate:modelValue":n[1]||(n[1]=function(e){return o.vulnForm.title=e}),placeholder:"输入漏洞标题"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,t.bF)(m,{sm:24,md:12},{default:(0,t.k6)((function(){return[(0,t.bF)(f,{label:"CVSS评分",prop:"cvss"},{default:(0,t.k6)((function(){return[(0,t.bF)(p,{modelValue:o.vulnForm.cvss,"onUpdate:modelValue":n[2]||(n[2]=function(e){return o.vulnForm.cvss=e}),min:0,max:10,precision:1,step:.1,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,t.bF)(m,{sm:24,md:12},{default:(0,t.k6)((function(){return[(0,t.bF)(f,{label:"严重程度",prop:"severity",required:""},{default:(0,t.k6)((function(){return[(0,t.bF)(v,{modelValue:o.vulnForm.severity,"onUpdate:modelValue":n[3]||(n[3]=function(e){return o.vulnForm.severity=e}),placeholder:"选择严重程度",style:{width:"100%"}},{default:(0,t.k6)((function(){return[(0,t.bF)(b,{label:"严重",value:"critical"}),(0,t.bF)(b,{label:"高危",value:"high"}),(0,t.bF)(b,{label:"中危",value:"medium"}),(0,t.bF)(b,{label:"低危",value:"low"}),(0,t.bF)(b,{label:"信息",value:"info"})]})),_:1},8,["modelValue"])]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,t.bF)(k,{class:"form-card"},{header:(0,t.k6)((function(){return n[11]||(n[11]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h3",null,"详细描述")],-1)])})),default:(0,t.k6)((function(){return[(0,t.bF)(f,{label:"漏洞描述",prop:"description",required:""},{default:(0,t.k6)((function(){return[(0,t.bF)(c,{modelValue:o.vulnForm.description,"onUpdate:modelValue":n[4]||(n[4]=function(e){return o.vulnForm.description=e}),type:"textarea",rows:5,placeholder:"请详细描述此漏洞，包括其影响、利用方式等"},null,8,["modelValue"])]})),_:1}),(0,t.bF)(f,{label:"受影响系统",prop:"affectedSystems"},{default:(0,t.k6)((function(){return[(0,t.bF)(c,{modelValue:o.vulnForm.affectedSystems,"onUpdate:modelValue":n[5]||(n[5]=function(e){return o.vulnForm.affectedSystems=e}),placeholder:"列出受影响的操作系统、软件或硬件"},null,8,["modelValue"])]})),_:1}),(0,t.bF)(f,{label:"解决方案",prop:"solution"},{default:(0,t.k6)((function(){return[(0,t.bF)(c,{modelValue:o.vulnForm.solution,"onUpdate:modelValue":n[6]||(n[6]=function(e){return o.vulnForm.solution=e}),type:"textarea",rows:3,placeholder:"提供修复或缓解此漏洞的建议措施"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,t.bF)(k,{class:"form-card"},{header:(0,t.k6)((function(){return n[12]||(n[12]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h3",null,"时间信息")],-1)])})),default:(0,t.k6)((function(){return[(0,t.bF)(F,{gutter:20},{default:(0,t.k6)((function(){return[(0,t.bF)(m,{sm:24,md:12},{default:(0,t.k6)((function(){return[(0,t.bF)(f,{label:"发布日期",prop:"publishedDate"},{default:(0,t.k6)((function(){return[(0,t.bF)(g,{modelValue:o.vulnForm.publishedDate,"onUpdate:modelValue":n[7]||(n[7]=function(e){return o.vulnForm.publishedDate=e}),type:"date",placeholder:"选择发布日期",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,t.bF)(m,{sm:24,md:12},{default:(0,t.k6)((function(){return[(0,t.bF)(f,{label:"更新日期",prop:"lastModifiedDate"},{default:(0,t.k6)((function(){return[(0,t.bF)(g,{modelValue:o.vulnForm.lastModifiedDate,"onUpdate:modelValue":n[8]||(n[8]=function(e){return o.vulnForm.lastModifiedDate=e}),type:"date",placeholder:"选择最后更新日期",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,t.bF)(k,{class:"form-card"},{header:(0,t.k6)((function(){return n[13]||(n[13]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h3",null,"参考资料")],-1)])})),default:(0,t.k6)((function(){return[(0,t.bF)(f,{label:"参考链接",prop:"references"},{default:(0,t.k6)((function(){return[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(o.vulnForm.references,(function(e,n){return(0,t.uX)(),(0,t.CE)("div",{key:n,class:"reference-item"},[(0,t.bF)(c,{modelValue:o.vulnForm.references[n],"onUpdate:modelValue":function(e){return o.vulnForm.references[n]=e},placeholder:"输入参考链接URL",class:"reference-input"},{append:(0,t.k6)((function(){return[(0,t.bF)(_,{onClick:function(e){return o.removeReference(n)},type:"danger"},{default:(0,t.k6)((function(){return[(0,t.bF)(V,null,{default:(0,t.k6)((function(){return[(0,t.bF)(h)]})),_:1})]})),_:2},1032,["onClick"])]})),_:2},1032,["modelValue","onUpdate:modelValue"])])})),128)),(0,t.bF)(_,{onClick:o.addReference,type:"primary",plain:"",class:"add-reference-btn"},{default:(0,t.k6)((function(){return[(0,t.bF)(V,null,{default:(0,t.k6)((function(){return[(0,t.bF)(y)]})),_:1}),n[14]||(n[14]=(0,t.eW)(" 添加参考链接 "))]})),_:1},8,["onClick"])]})),_:1})]})),_:1}),(0,t.Lk)("div",a,[(0,t.bF)(_,{onClick:o.goBack},{default:(0,t.k6)((function(){return n[15]||(n[15]=[(0,t.eW)("取消")])})),_:1},8,["onClick"]),(0,t.bF)(_,{type:"primary",onClick:o.submitForm,loading:o.submitting},{default:(0,t.k6)((function(){return n[16]||(n[16]=[(0,t.eW)("保存漏洞")])})),_:1},8,["onClick","loading"])])]})),_:1},8,["model","rules"])),[[C,o.loading]])])])}var s=r(14048),d=r(30388),i=(r(16280),r(76918),r(2008),r(44114),r(54554),r(60739),r(18111),r(22489),r(33110),r(26099),r(47764),r(42762),r(62953),r(3296),r(27208),r(48408),r(14603),r(47566),r(98721),r(50953)),c=r(75220),f=r(20163),m=r(48548),p=r(94335);const b={name:"VulnDatabaseCreate",components:{Plus:m.Plus,Delete:m.Delete},setup:function(){var e=(0,c.rd)(),n=(0,i.KR)(null),r=(0,i.KR)(!1),t=(0,i.KR)(!1),l=(0,i.Kh)({cveId:"",title:"",description:"",cvss:5,severity:"",affectedSystems:"",solution:"",publishedDate:"",lastModifiedDate:"",references:[""]}),u={title:[{required:!0,message:"请输入漏洞标题",trigger:"blur"},{min:5,max:100,message:"标题长度应在5-100个字符之间",trigger:"blur"}],description:[{required:!0,message:"请输入漏洞描述",trigger:"blur"},{min:10,message:"描述应至少包含10个字符",trigger:"blur"}],severity:[{required:!0,message:"请选择严重程度",trigger:"change"}],cveId:[{pattern:/^CVE-\d{4}-\d{4,}$/,message:"CVE ID格式应为CVE-YYYY-XXXXX",trigger:"blur"}],cvss:[{type:"number",min:0,max:10,message:"CVSS评分应在0-10之间",trigger:"blur"}],references:[{type:"array",validator:function(e,n,r){var t=n.filter((function(e){return e&&!a(e)}));t.length>0?r(new Error("请输入有效的URL地址")):r()},trigger:"blur"}]},a=function(e){try{return new URL(e),!0}catch(n){return!1}},o=function(){l.references.push("")},b=function(e){l.references.splice(e,1),0===l.references.length&&l.references.push("")},v=function(){e.push("/vulndatabase")},F=function(){var n=(0,d.A)((0,s.A)().mark((function n(){var r;return(0,s.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return l.references=l.references.filter((function(e){return""!==e.trim()})),l.lastModifiedDate||(l.lastModifiedDate=l.publishedDate),t.value=!0,console.log("准备提交表单数据:",l),console.log("提交URL:",p.A.defaults.baseURL+"/api/vulndatabase"),n.prev=5,console.log("创建漏洞，URL:",p.A.defaults.baseURL+"/api/vulndatabase"),console.log("请求数据:",JSON.stringify(l,null,2)),n.next=10,p.A.post("/api/vulndatabase",l);case 10:r=n.sent,console.log("创建漏洞成功:",r.data),f.nk.success("成功创建漏洞"),e.push("/vulndatabase/".concat(r.data.cveId||r.data.id)),n.next=20;break;case 16:n.prev=16,n.t0=n["catch"](5),console.error("创建漏洞失败，详细信息:",{error:n.t0,message:n.t0.message,config:n.t0.config,response:n.t0.response?{status:n.t0.response.status,statusText:n.t0.response.statusText,data:n.t0.response.data}:"无响应数据"}),f.nk.error("创建漏洞失败，请稍后重试");case 20:return n.prev=20,t.value=!1,n.finish(20);case 23:case"end":return n.stop()}}),n,null,[[5,16,20,23]])})));return function(){return n.apply(this,arguments)}}();return{vulnFormRef:n,vulnForm:l,rules:u,loading:r,submitting:t,addReference:o,removeReference:b,goBack:v,submitForm:F,Plus:m.Plus,Delete:m.Delete}}};var v=r(66262);const F=(0,v.A)(b,[["render",o],["__scopeId","data-v-6c25fe23"]]),k=F}}]);
//# sourceMappingURL=448.b0dffbcd.js.map