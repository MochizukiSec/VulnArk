"use strict";(self["webpackChunkvuln_management_frontend"]=self["webpackChunkvuln_management_frontend"]||[]).push([[363],{26363:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});n(52675),n(89463);var r=n(20641),a=n(90033),i={class:"vuln-detail-container"},l={class:"header-section"},u={class:"vuln-detail-header"},c={class:"header-content"},s={class:"cve-id"},o={class:"header-actions"},d={class:"vuln-title"},v={key:1,class:"vuln-detail-content"},f={class:"description-content"},b={key:0},k={key:1},p={class:"solution-content"},y={key:0},g={key:1},h={class:"references-content"},m={key:0,class:"reference-list"},_={key:1};function F(e,t,n,F,L,C){var w=(0,r.g2)("el-tag"),A=(0,r.g2)("el-page-header"),D=(0,r.g2)("DocumentAdd"),S=(0,r.g2)("el-icon"),E=(0,r.g2)("el-button"),X=(0,r.g2)("el-skeleton"),x=(0,r.g2)("el-link"),I=(0,r.g2)("el-descriptions-item"),W=(0,r.g2)("el-descriptions"),V=(0,r.g2)("el-card"),B=(0,r.g2)("el-col"),j=(0,r.g2)("el-row");return(0,r.uX)(),(0,r.CE)("div",i,[(0,r.Lk)("div",l,[(0,r.Lk)("div",u,[(0,r.bF)(A,{title:"漏洞数据库",onBack:F.goBack},{content:(0,r.k6)((function(){return[(0,r.Lk)("div",c,[(0,r.Lk)("span",s,(0,a.v_)(F.vulnerability.cveId),1),F.vulnerability.severity?((0,r.uX)(),(0,r.Wv)(w,{key:0,type:F.getSeverityType(F.vulnerability.severity),size:"large",class:"severity-tag"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(F.getSeverityLabel(F.vulnerability.severity)),1)]})),_:1},8,["type"])):(0,r.Q3)("",!0)])]})),_:1},8,["onBack"]),(0,r.Lk)("div",o,[(0,r.bF)(E,{type:"primary",onClick:F.importVulnerability},{default:(0,r.k6)((function(){return[(0,r.bF)(S,null,{default:(0,r.k6)((function(){return[(0,r.bF)(D)]})),_:1}),t[0]||(t[0]=(0,r.eW)(" 添加到漏洞列表 "))]})),_:1},8,["onClick"])])]),(0,r.Lk)("h1",d,(0,a.v_)(F.vulnerability.title),1)]),F.loading?((0,r.uX)(),(0,r.Wv)(X,{key:0,loading:F.loading,animated:"",rows:10},null,8,["loading"])):((0,r.uX)(),(0,r.CE)("div",v,[(0,r.bF)(j,{gutter:20},{default:(0,r.k6)((function(){return[(0,r.bF)(B,{span:24},{default:(0,r.k6)((function(){return[(0,r.bF)(V,{class:"info-card"},{header:(0,r.k6)((function(){return t[1]||(t[1]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"基本信息")],-1)])})),default:(0,r.k6)((function(){return[(0,r.bF)(W,{column:3,border:""},{default:(0,r.k6)((function(){return[(0,r.bF)(I,{label:"CVE ID"},{default:(0,r.k6)((function(){return[(0,r.bF)(x,{type:"primary",href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=".concat(F.vulnerability.cveId),target:"_blank"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(F.vulnerability.cveId),1)]})),_:1},8,["href"])]})),_:1}),(0,r.bF)(I,{label:"CVSS 评分"},{default:(0,r.k6)((function(){return[(0,r.Lk)("span",{class:(0,a.C4)(["cvss-score",F.getCvssScoreClass(F.vulnerability.cvss)])},(0,a.v_)(F.vulnerability.cvss),3)]})),_:1}),(0,r.bF)(I,{label:"严重程度"},{default:(0,r.k6)((function(){return[(0,r.bF)(w,{type:F.getSeverityType(F.vulnerability.severity),size:"default"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(F.getSeverityLabel(F.vulnerability.severity)),1)]})),_:1},8,["type"])]})),_:1}),(0,r.bF)(I,{label:"发布日期"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(F.formatDate(F.vulnerability.publishedDate)),1)]})),_:1}),(0,r.bF)(I,{label:"最后更新日期"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(F.formatDate(F.vulnerability.lastModifiedDate)),1)]})),_:1}),(0,r.bF)(I,{label:"受影响系统"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(F.vulnerability.affectedSystems||"未提供"),1)]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,r.bF)(B,{span:24,class:"mt-4"},{default:(0,r.k6)((function(){return[(0,r.bF)(V,{class:"info-card"},{header:(0,r.k6)((function(){return t[2]||(t[2]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"漏洞描述")],-1)])})),default:(0,r.k6)((function(){return[(0,r.Lk)("div",f,[F.vulnerability.description?((0,r.uX)(),(0,r.CE)("p",b,(0,a.v_)(F.vulnerability.description),1)):((0,r.uX)(),(0,r.CE)("p",k,"暂无描述信息"))])]})),_:1})]})),_:1}),(0,r.bF)(B,{span:24,class:"mt-4"},{default:(0,r.k6)((function(){return[(0,r.bF)(V,{class:"info-card"},{header:(0,r.k6)((function(){return t[3]||(t[3]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"解决方案")],-1)])})),default:(0,r.k6)((function(){return[(0,r.Lk)("div",p,[F.vulnerability.solution?((0,r.uX)(),(0,r.CE)("p",y,(0,a.v_)(F.vulnerability.solution),1)):((0,r.uX)(),(0,r.CE)("p",g,"暂无解决方案信息"))])]})),_:1})]})),_:1}),(0,r.bF)(B,{span:24,class:"mt-4"},{default:(0,r.k6)((function(){return[(0,r.bF)(V,{class:"info-card"},{header:(0,r.k6)((function(){return t[4]||(t[4]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"参考链接")],-1)])})),default:(0,r.k6)((function(){return[(0,r.Lk)("div",h,[F.vulnerability.references&&F.vulnerability.references.length?((0,r.uX)(),(0,r.CE)("ul",m,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(F.vulnerability.references,(function(e,t){return(0,r.uX)(),(0,r.CE)("li",{key:t},[(0,r.bF)(x,{href:e,type:"primary",target:"_blank"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(e),1)]})),_:2},1032,["href"])])})),128))])):((0,r.uX)(),(0,r.CE)("p",_,"暂无参考链接"))])]})),_:1})]})),_:1})]})),_:1})]))])}var L=n(14048),C=n(30388),w=(n(48598),n(44114),n(23288),n(50953)),A=n(75220),D=n(20163),S=n(77918),E=n(48548),X=n(94335);const x={name:"VulnDatabaseDetail",components:{DocumentAdd:E.DocumentAdd},setup:function(){var e=(0,A.lq)(),t=(0,A.rd)(),n=(0,w.KR)(!0),a=(0,w.KR)({}),i=function(){var t=(0,C.A)((0,L.A)().mark((function t(){var r,i;return(0,L.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.params.cveId,r){t.next=5;break}return D.nk.error("未提供有效的CVE ID"),o(),t.abrupt("return");case 5:return n.value=!0,t.prev=6,console.log("获取漏洞详情:",{baseURL:X.A.defaults.baseURL,endpoint:"/api/vulndatabase/".concat(r),cveId:r}),t.next=10,X.A.get("/api/vulndatabase/".concat(r));case 10:i=t.sent,console.log("获取漏洞详情成功:",i.data),a.value=i.data,t.next=20;break;case 15:t.prev=15,t.t0=t["catch"](6),console.error("获取漏洞详情失败:",t.t0),console.error("详细错误信息:",{message:t.t0.message,response:t.t0.response?{status:t.t0.response.status,data:t.t0.response.data}:"无响应"}),D.nk.error("获取漏洞详情失败，请稍后重试");case 20:return t.prev=20,n.value=!1,t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[6,15,20,23]])})));return function(){return t.apply(this,arguments)}}(),l=function(e){if(!e)return"未知";try{var t=new Date(e);return t.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})}catch(n){return e}},u=function(e){var t={critical:"danger",high:"danger",medium:"warning",low:"info",info:"info"};return t[e]||"info"},c=function(e){var t={critical:"严重",high:"高危",medium:"中危",low:"低危",info:"信息"};return t[e]||"未知"},s=function(e){return e>=9?"critical":e>=7?"high":e>=4?"medium":"low"},o=function(){t.push("/vulndatabase")},d=function(){var e=(0,C.A)((0,L.A)().mark((function e(){var n,r,i,l;return(0,L.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r=a.value,i={title:r.title,description:r.description,cve:r.cveId,cvss:r.cvss,severity:r.severity,affectedSystems:r.affectedSystems,references:(null===(n=r.references)||void 0===n?void 0:n.join("\n"))||"",remediation:r.solution},e.next=5,S.s.confirm("确定要将此漏洞添加到您的漏洞管理列表中吗？","导入漏洞",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"});case 5:return e.next=7,X.A.post("/api/vulnerabilities",i);case 7:l=e.sent,D.nk.success("漏洞已成功导入到您的漏洞管理列表"),t.push("/vulnerabilities/".concat(l.data.id)),e.next=18;break;case 12:if(e.prev=12,e.t0=e["catch"](0),"cancel"!==e.t0){e.next=16;break}return e.abrupt("return");case 16:console.error("导入漏洞失败:",e.t0),D.nk.error("导入漏洞失败，请稍后重试");case 18:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return(0,r.sV)((function(){i()})),{loading:n,vulnerability:a,formatDate:l,getSeverityType:u,getSeverityLabel:c,getCvssScoreClass:s,goBack:o,importVulnerability:d}}};var I=n(66262);const W=(0,I.A)(x,[["render",F],["__scopeId","data-v-731f8d5e"]]),V=W},48598:(e,t,n)=>{var r=n(46518),a=n(79504),i=n(47055),l=n(25397),u=n(34598),c=a([].join),s=i!==Object,o=s||!u("join",",");r({target:"Array",proto:!0,forced:o},{join:function(e){return c(l(this),void 0===e?",":e)}})}}]);
//# sourceMappingURL=363.74eab45d.js.map