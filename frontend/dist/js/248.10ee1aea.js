"use strict";(self["webpackChunkvuln_management_frontend"]=self["webpackChunkvuln_management_frontend"]||[]).push([[248],{9868:(e,t,n)=>{var a=n(46518),r=n(79504),i=n(91291),s=n(31240),l=n(72333),c=n(79039),u=RangeError,d=String,o=Math.floor,v=r(l),f=r("".slice),k=r(1..toFixed),p=function(e,t,n){return 0===t?n:t%2===1?p(e,t-1,n*e):p(e*e,t/2,n)},y=function(e){var t=0,n=e;while(n>=4096)t+=12,n/=4096;while(n>=2)t+=1,n/=2;return t},b=function(e,t,n){var a=-1,r=n;while(++a<6)r+=t*e[a],e[a]=r%1e7,r=o(r/1e7)},h=function(e,t){var n=6,a=0;while(--n>=0)a+=e[n],e[n]=o(a/t),a=a%t*1e7},m=function(e){var t=6,n="";while(--t>=0)if(""!==n||0===t||0!==e[t]){var a=d(e[t]);n=""===n?a:n+v("0",7-a.length)+a}return n},L=c((function(){return"0.000"!==k(8e-5,3)||"1"!==k(.9,0)||"1.25"!==k(1.255,2)||"1000000000000000128"!==k(0xde0b6b3a7640080,0)}))||!c((function(){k({})}));a({target:"Number",proto:!0,forced:L},{toFixed:function(e){var t,n,a,r,l=s(this),c=i(e),o=[0,0,0,0,0,0],k="",L="0";if(c<0||c>20)throw new u("Incorrect fraction digits");if(l!==l)return"NaN";if(l<=-1e21||l>=1e21)return d(l);if(l<0&&(k="-",l=-l),l>1e-21)if(t=y(l*p(2,69,1))-69,n=t<0?l*p(2,-t,1):l/p(2,t,1),n*=4503599627370496,t=52-t,t>0){b(o,0,n),a=c;while(a>=7)b(o,1e7,0),a-=7;b(o,p(10,a,1),0),a=t-1;while(a>=23)h(o,1<<23),a-=23;h(o,1<<a),b(o,1,1),h(o,2),L=m(o)}else b(o,0,n),b(o,1<<-t,0),L=m(o)+v("0",c);return c>0?(r=L.length,L=k+(r<=c?"0."+v("0",c-r)+L:f(L,0,r-c)+"."+f(L,r-c))):L=k+L,L}})},70248:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ae});n(62010),n(9868);var a=n(20641),r=n(90033),i={class:"vulnerability-details-page"},s={class:"page-header"},l={class:"header-back"},c={class:"header-actions"},u={class:"vuln-header"},d={class:"vuln-title-section"},o={class:"vuln-title"},v={class:"vuln-meta"},f={class:"vuln-id"},k={key:0,class:"vuln-cve"},p={class:"vuln-dates"},y={class:"date-item"},b={class:"date-value"},h={class:"date-item"},m={class:"date-value"},L={class:"details-grid"},g={class:"card-section"},_=["innerHTML"],C={key:0,class:"card-section"},w=["innerHTML"],W={key:1,class:"card-section"},E=["innerHTML"],F={key:2,class:"card-section"},X=["innerHTML"],x={class:"side-cards"},T={class:"cvss-score"},A={class:"score-value"},Q={class:"score-text"},I={class:"score-level"},S={key:0,class:"cvss-vector"},D={class:"vector-value"},M={class:"assets-list"},V={class:"asset-name"},H={key:0,class:"asset-details"},$={class:"references-list"},B=["href"],K={class:"tags-container"},R={class:"history-item"},N={class:"history-action"},j={key:0,class:"history-user"},q={key:0,class:"history-details"};function z(e,t,n,z,P,G){var J=(0,a.g2)("el-button"),O=(0,a.g2)("el-dropdown-item"),U=(0,a.g2)("el-dropdown-menu"),Y=(0,a.g2)("el-dropdown"),Z=(0,a.g2)("el-empty"),ee=(0,a.g2)("el-tag"),te=(0,a.g2)("el-card"),ne=(0,a.g2)("el-timeline-item"),ae=(0,a.g2)("el-timeline"),re=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",s,[(0,a.Lk)("div",l,[(0,a.bF)(J,{onClick:z.goBack,icon:"el-icon-arrow-left",type:"text"},{default:(0,a.k6)((function(){return t[0]||(t[0]=[(0,a.eW)(" 返回列表 ")])})),_:1},8,["onClick"])]),(0,a.Lk)("div",c,[(0,a.bF)(J,{onClick:z.handleEdit,type:"primary",plain:"",disabled:!z.canEdit},{default:(0,a.k6)((function(){return t[1]||(t[1]=[(0,a.eW)(" 编辑 ")])})),_:1},8,["onClick","disabled"]),(0,a.bF)(Y,{onCommand:z.handleCommand,trigger:"click"},{dropdown:(0,a.k6)((function(){return[(0,a.bF)(U,null,{default:(0,a.k6)((function(){return[(0,a.bF)(O,{command:"open",disabled:"open"===z.vulnerability.status},{default:(0,a.k6)((function(){return t[3]||(t[3]=[(0,a.eW)(" 标记为开放 ")])})),_:1},8,["disabled"]),(0,a.bF)(O,{command:"in_progress",disabled:"in_progress"===z.vulnerability.status},{default:(0,a.k6)((function(){return t[4]||(t[4]=[(0,a.eW)(" 标记为处理中 ")])})),_:1},8,["disabled"]),(0,a.bF)(O,{command:"resolved",disabled:"resolved"===z.vulnerability.status},{default:(0,a.k6)((function(){return t[5]||(t[5]=[(0,a.eW)(" 标记为已解决 ")])})),_:1},8,["disabled"]),(0,a.bF)(O,{command:"false_positive",disabled:"false_positive"===z.vulnerability.status},{default:(0,a.k6)((function(){return t[6]||(t[6]=[(0,a.eW)(" 标记为误报 ")])})),_:1},8,["disabled"]),(0,a.bF)(O,{command:"closed",disabled:"closed"===z.vulnerability.status},{default:(0,a.k6)((function(){return t[7]||(t[7]=[(0,a.eW)(" 标记为已关闭 ")])})),_:1},8,["disabled"]),(0,a.bF)(O,{divided:"",command:"delete",type:"danger"},{default:(0,a.k6)((function(){return t[8]||(t[8]=[(0,a.Lk)("span",{style:{color:"#F56C6C"}},"删除漏洞",-1)])})),_:1})]})),_:1})]})),default:(0,a.k6)((function(){return[(0,a.bF)(J,null,{default:(0,a.k6)((function(){return t[2]||(t[2]=[(0,a.eW)(" 操作 "),(0,a.Lk)("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)])})),_:1})]})),_:1},8,["onCommand"])])]),(0,a.bo)(((0,a.uX)(),(0,a.CE)("div",null,[z.loading||z.vulnerability.id?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(Z,{key:0,description:"未找到漏洞信息"},{default:(0,a.k6)((function(){return[(0,a.bF)(J,{type:"primary",onClick:z.goBack},{default:(0,a.k6)((function(){return t[9]||(t[9]=[(0,a.eW)("返回列表")])})),_:1},8,["onClick"])]})),_:1})),z.vulnerability.id?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.Lk)("div",u,[(0,a.Lk)("div",d,[(0,a.Lk)("h1",o,(0,r.v_)(z.vulnerability.title),1),(0,a.Lk)("div",v,[(0,a.bF)(ee,{class:"vuln-severity",type:e.$filters.severityClass(z.vulnerability.severity)},{default:(0,a.k6)((function(){return[(0,a.eW)((0,r.v_)(e.$filters.severityText(z.vulnerability.severity)),1)]})),_:1},8,["type"]),(0,a.bF)(ee,{class:"vuln-status",type:e.$filters.statusClass(z.vulnerability.status)},{default:(0,a.k6)((function(){return[(0,a.eW)((0,r.v_)(e.$filters.statusText(z.vulnerability.status)),1)]})),_:1},8,["type"]),(0,a.Lk)("span",f,"ID: "+(0,r.v_)(z.vulnerability.id),1),z.vulnerability.cve?((0,a.uX)(),(0,a.CE)("span",k," CVE: "+(0,r.v_)(z.vulnerability.cve),1)):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",p,[(0,a.Lk)("div",y,[t[10]||(t[10]=(0,a.Lk)("div",{class:"date-label"},"发现时间",-1)),(0,a.Lk)("div",b,(0,r.v_)(e.$filters.formatDate(z.vulnerability.discoveredAt)),1)]),(0,a.Lk)("div",h,[t[11]||(t[11]=(0,a.Lk)("div",{class:"date-label"},"上次更新",-1)),(0,a.Lk)("div",m,(0,r.v_)(e.$filters.formatDate(z.vulnerability.updatedAt)),1)])])]),(0,a.Lk)("div",L,[(0,a.bF)(te,{class:"details-card main-info-card"},{header:(0,a.k6)((function(){return t[12]||(t[12]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("h3",null,[(0,a.Lk)("i",{class:"el-icon-info"}),(0,a.eW)(" 漏洞详情 ")])],-1)])})),default:(0,a.k6)((function(){return[(0,a.Lk)("div",g,[t[13]||(t[13]=(0,a.Lk)("h4",{class:"section-title"},"描述",-1)),(0,a.Lk)("div",{class:"section-content markdown-body",innerHTML:z.renderedDescription},null,8,_)]),z.vulnerability.impact?((0,a.uX)(),(0,a.CE)("div",C,[t[14]||(t[14]=(0,a.Lk)("h4",{class:"section-title"},"影响",-1)),(0,a.Lk)("div",{class:"section-content markdown-body",innerHTML:z.renderedImpact},null,8,w)])):(0,a.Q3)("",!0),z.vulnerability.steps_to_reproduce?((0,a.uX)(),(0,a.CE)("div",W,[t[15]||(t[15]=(0,a.Lk)("h4",{class:"section-title"},"复现步骤",-1)),(0,a.Lk)("div",{class:"section-content markdown-body",innerHTML:z.renderedStepsToReproduce},null,8,E)])):(0,a.Q3)("",!0),z.vulnerability.recommendation?((0,a.uX)(),(0,a.CE)("div",F,[t[16]||(t[16]=(0,a.Lk)("h4",{class:"section-title"},"修复建议",-1)),(0,a.Lk)("div",{class:"section-content markdown-body",innerHTML:z.renderedRecommendation},null,8,X)])):(0,a.Q3)("",!0)]})),_:1}),(0,a.Lk)("div",x,[(0,a.bF)(te,{class:"details-card risk-score-card"},{header:(0,a.k6)((function(){return t[17]||(t[17]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("h3",null,[(0,a.Lk)("i",{class:"el-icon-warning"}),(0,a.eW)(" 风险评估 ")])],-1)])})),default:(0,a.k6)((function(){var e;return[(0,a.Lk)("div",T,[(0,a.Lk)("div",{class:(0,r.C4)(["score-circle",z.cvssScoreClass])},[(0,a.Lk)("span",A,(0,r.v_)((null===(e=z.vulnerability.cvss)||void 0===e?void 0:e.toFixed(1))||"N/A"),1)],2),(0,a.Lk)("div",Q,[(0,a.Lk)("div",I,(0,r.v_)(z.cvssScoreText),1),t[18]||(t[18]=(0,a.Lk)("div",{class:"score-label"},"CVSS 评分",-1))])]),z.vulnerability.cvss_vector?((0,a.uX)(),(0,a.CE)("div",S,[t[19]||(t[19]=(0,a.Lk)("div",{class:"vector-label"},"CVSS 向量:",-1)),(0,a.Lk)("div",D,(0,r.v_)(z.vulnerability.cvss_vector),1)])):(0,a.Q3)("",!0)]})),_:1}),z.vulnerability.affected_assets&&z.vulnerability.affected_assets.length?((0,a.uX)(),(0,a.Wv)(te,{key:0,class:"details-card assets-card"},{header:(0,a.k6)((function(){return t[20]||(t[20]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("h3",null,[(0,a.Lk)("i",{class:"el-icon-collection"}),(0,a.eW)(" 受影响资产 ")])],-1)])})),default:(0,a.k6)((function(){return[(0,a.Lk)("ul",M,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(z.vulnerability.affected_assets,(function(e,t){return(0,a.uX)(),(0,a.CE)("li",{key:t,class:"asset-item"},[(0,a.Lk)("div",V,(0,r.v_)(e.name||"未命名资产"),1),e.details?((0,a.uX)(),(0,a.CE)("div",H,(0,r.v_)(e.details),1)):(0,a.Q3)("",!0)])})),128))])]})),_:1})):(0,a.Q3)("",!0),z.vulnerability.references&&z.vulnerability.references.length?((0,a.uX)(),(0,a.Wv)(te,{key:1,class:"details-card references-card"},{header:(0,a.k6)((function(){return t[21]||(t[21]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("h3",null,[(0,a.Lk)("i",{class:"el-icon-link"}),(0,a.eW)(" 参考资料 ")])],-1)])})),default:(0,a.k6)((function(){return[(0,a.Lk)("ul",$,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(z.vulnerability.references,(function(e,t){return(0,a.uX)(),(0,a.CE)("li",{key:t,class:"reference-item"},[(0,a.Lk)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},(0,r.v_)(e.title||e.url),9,B)])})),128))])]})),_:1})):(0,a.Q3)("",!0),z.vulnerability.tags&&z.vulnerability.tags.length?((0,a.uX)(),(0,a.Wv)(te,{key:2,class:"details-card tags-card"},{header:(0,a.k6)((function(){return t[22]||(t[22]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("h3",null,[(0,a.Lk)("i",{class:"el-icon-price-tag"}),(0,a.eW)(" 标签 ")])],-1)])})),default:(0,a.k6)((function(){return[(0,a.Lk)("div",K,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(z.vulnerability.tags,(function(e){return(0,a.uX)(),(0,a.Wv)(ee,{key:e,class:"tag-item",size:"medium"},{default:(0,a.k6)((function(){return[(0,a.eW)((0,r.v_)(e),1)]})),_:2},1024)})),128))])]})),_:1})):(0,a.Q3)("",!0)])]),z.vulnerability.history&&z.vulnerability.history.length?((0,a.uX)(),(0,a.Wv)(te,{key:0,class:"details-card history-card"},{header:(0,a.k6)((function(){return t[23]||(t[23]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("h3",null,[(0,a.Lk)("i",{class:"el-icon-time"}),(0,a.eW)(" 历史记录 ")])],-1)])})),default:(0,a.k6)((function(){return[(0,a.bF)(ae,null,{default:(0,a.k6)((function(){return[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(z.vulnerability.history,(function(n,i){return(0,a.uX)(),(0,a.Wv)(ne,{key:i,timestamp:e.$filters.formatDateTime(n.timestamp),type:z.historyItemType(n.action)},{default:(0,a.k6)((function(){return[(0,a.Lk)("div",R,[(0,a.Lk)("span",N,(0,r.v_)(z.historyActionText(n)),1),n.user?((0,a.uX)(),(0,a.CE)("span",j,[t[24]||(t[24]=(0,a.eW)(" 由 ")),(0,a.Lk)("strong",null,(0,r.v_)(n.user.name||n.user.username),1),t[25]||(t[25]=(0,a.eW)(" 操作 "))])):(0,a.Q3)("",!0)]),n.details?((0,a.uX)(),(0,a.CE)("div",q,(0,r.v_)(n.details),1)):(0,a.Q3)("",!0)]})),_:2},1032,["timestamp","type"])})),128))]})),_:1})]})),_:1})):(0,a.Q3)("",!0)],64)):(0,a.Q3)("",!0)])),[[re,z.loading]])])}var P=n(14048),G=n(30388),J=(n(52675),n(89463),n(44114),n(50953)),O=n(66278),U=n(75220),Y=n(20163),Z=n(77918);const ee={name:"VulnerabilityDetails",setup:function(){var e=(0,O.Pj)(),t=(0,U.lq)(),n=(0,U.rd)(),r=(0,J.KR)(!0),i=(0,a.EW)((function(){return e.getters["vulnerability/currentVulnerability"]||{}})),s=(0,a.EW)((function(){return e.getters["auth/isAuthenticated"]})),l=(0,a.EW)((function(){var e=i.value.cvss;return e?e>=9?"critical":e>=7?"high":e>=4?"medium":"low":""})),c=(0,a.EW)((function(){var e=i.value.cvss;return e?e>=9?"严重":e>=7?"高危":e>=4?"中危":e>0?"低危":"未评分":"未评分"})),u=(0,a.EW)((function(){return i.value.description?"<p>".concat(i.value.description,"</p>"):"<p>暂无描述</p>"})),d=(0,a.EW)((function(){return i.value.impact?"<p>".concat(i.value.impact,"</p>"):""})),o=(0,a.EW)((function(){return i.value.steps_to_reproduce?"<p>".concat(i.value.steps_to_reproduce,"</p>"):""})),v=(0,a.EW)((function(){return i.value.recommendation?"<p>".concat(i.value.recommendation,"</p>"):""})),f=function(){var n=(0,G.A)((0,P.A)().mark((function n(){return(0,P.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r.value=!0,n.prev=1,n.next=4,e.dispatch("vulnerability/fetchVulnerabilityById",t.params.id);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),Y.nk.error("获取漏洞详情失败: "+(n.t0.message||"未知错误"));case 9:return n.prev=9,r.value=!1,n.finish(9);case 12:case"end":return n.stop()}}),n,null,[[1,6,9,12]])})));return function(){return n.apply(this,arguments)}}(),k=function(){n.push("/vulnerabilities")},p=function(){n.push("/vulnerabilities/".concat(i.value.id,"/edit"))},y=function(e){"delete"===e?b():m(e)},b=function(){Z.s.confirm('确定要删除漏洞 "'.concat(i.value.title,'" 吗？'),"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){h()}))["catch"]((function(){(0,Y.nk)({type:"info",message:"已取消删除"})}))},h=function(){var t=(0,G.A)((0,P.A)().mark((function t(){return(0,P.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.dispatch("vulnerability/deleteVulnerability",i.value.id);case 3:e.dispatch("dashboard/fetchDashboardData"),(0,Y.nk)({type:"success",message:"漏洞已成功删除"}),n.push("/vulnerabilities"),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),(0,Y.nk)({type:"error",message:"删除失败: "+(t.t0.message||"未知错误")});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}(),m=function(){var t=(0,G.A)((0,P.A)().mark((function t(n){return(0,P.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.dispatch("vulnerability/updateVulnerability",{id:i.value.id,data:{status:n}});case 3:(0,Y.nk)({type:"success",message:"漏洞状态已更新"}),f(),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),(0,Y.nk)({type:"error",message:"更新状态失败: "+(t.t0.message||"未知错误")});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),L=function(e){switch(e){case"create":return"success";case"update":return"warning";case"delete":return"danger";case"status_change":return"primary";default:return"info"}},g=function(e){switch(e.action){case"create":return"创建漏洞";case"update":return"更新漏洞信息";case"delete":return"删除漏洞";case"status_change":return"状态变更为 ".concat(e.details||"未知状态");default:return e.action||"未知操作"}};return(0,a.sV)((function(){f()})),{loading:r,vulnerability:i,canEdit:s,cvssScoreClass:l,cvssScoreText:c,renderedDescription:u,renderedImpact:d,renderedStepsToReproduce:o,renderedRecommendation:v,goBack:k,handleEdit:p,handleCommand:y,confirmDelete:b,historyItemType:L,historyActionText:g}}};var te=n(66262);const ne=(0,te.A)(ee,[["render",z],["__scopeId","data-v-4828a23a"]]),ae=ne}}]);
//# sourceMappingURL=248.10ee1aea.js.map