"use strict";(self["webpackChunkvuln_management_frontend"]=self["webpackChunkvuln_management_frontend"]||[]).push([[647],{2478:(e,t,n)=>{var a=n(79504),r=n(48981),o=Math.floor,i=a("".charAt),l=a("".replace),c=a("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,a,d,p){var f=n+e.length,v=a.length,g=u;return void 0!==d&&(d=r(d),g=s),l(p,g,(function(r,l){var s;switch(i(l,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,n);case"'":return c(t,f);case"<":s=d[c(l,1,-1)];break;default:var u=+l;if(0===u)return r;if(u>v){var p=o(u/10);return 0===p?r:p<=v?void 0===a[p-1]?i(l,1):a[p-1]+i(l,1):r}s=a[u-1]}return void 0===s?"":s}))}},9868:(e,t,n)=>{var a=n(46518),r=n(79504),o=n(91291),i=n(31240),l=n(72333),c=n(79039),s=RangeError,u=String,d=Math.floor,p=r(l),f=r("".slice),v=r(1..toFixed),g=function(e,t,n){return 0===t?n:t%2===1?g(e,t-1,n*e):g(e*e,t/2,n)},h=function(e){var t=0,n=e;while(n>=4096)t+=12,n/=4096;while(n>=2)t+=1,n/=2;return t},b=function(e,t,n){var a=-1,r=n;while(++a<6)r+=t*e[a],e[a]=r%1e7,r=d(r/1e7)},m=function(e,t){var n=6,a=0;while(--n>=0)a+=e[n],e[n]=d(a/t),a=a%t*1e7},k=function(e){var t=6,n="";while(--t>=0)if(""!==n||0===t||0!==e[t]){var a=u(e[t]);n=""===n?a:n+p("0",7-a.length)+a}return n},A=c((function(){return"0.000"!==v(8e-5,3)||"1"!==v(.9,0)||"1.25"!==v(1.255,2)||"1000000000000000128"!==v(0xde0b6b3a7640080,0)}))||!c((function(){v({})}));a({target:"Number",proto:!0,forced:A},{toFixed:function(e){var t,n,a,r,l=i(this),c=o(e),d=[0,0,0,0,0,0],v="",A="0";if(c<0||c>20)throw new s("Incorrect fraction digits");if(l!==l)return"NaN";if(l<=-1e21||l>=1e21)return u(l);if(l<0&&(v="-",l=-l),l>1e-21)if(t=h(l*g(2,69,1))-69,n=t<0?l*g(2,-t,1):l/g(2,t,1),n*=4503599627370496,t=52-t,t>0){b(d,0,n),a=c;while(a>=7)b(d,1e7,0),a-=7;b(d,g(10,a,1),0),a=t-1;while(a>=23)m(d,1<<23),a-=23;m(d,1<<a),b(d,1,1),m(d,2),A=k(d)}else b(d,0,n),b(d,1<<-t,0),A=k(d)+p("0",c);return c>0?(r=A.length,A=v+(r<=c?"0."+p("0",c-r)+A:f(A,0,r-c)+"."+f(A,r-c))):A=v+A,A}})},25440:(e,t,n)=>{var a=n(18745),r=n(69565),o=n(79504),i=n(89228),l=n(79039),c=n(28551),s=n(94901),u=n(64117),d=n(91291),p=n(18014),f=n(655),v=n(67750),g=n(57829),h=n(55966),b=n(2478),m=n(56682),k=n(78227),A=k("replace"),w=Math.max,F=Math.min,_=o([].concat),y=o([].push),C=o("".indexOf),x=o("".slice),T=function(e){return void 0===e?e:String(e)},S=function(){return"$0"==="a".replace(/./,"$0")}(),$=function(){return!!/./[A]&&""===/./[A]("a","$0")}(),D=!l((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));i("replace",(function(e,t,n){var o=$?"$":"$0";return[function(e,n){var a=v(this),o=u(e)?void 0:h(e,A);return o?r(o,e,a,n):r(t,f(a),e,n)},function(e,r){var i=c(this),l=f(e);if("string"==typeof r&&-1===C(r,o)&&-1===C(r,"$<")){var u=n(t,i,l,r);if(u.done)return u.value}var v=s(r);v||(r=f(r));var h,k=i.global;k&&(h=i.unicode,i.lastIndex=0);var A,S=[];while(1){if(A=m(i,l),null===A)break;if(y(S,A),!k)break;var $=f(A[0]);""===$&&(i.lastIndex=g(l,p(i.lastIndex),h))}for(var D="",I=0,V=0;V<S.length;V++){A=S[V];for(var z,L=f(A[0]),P=w(F(d(A.index),l.length),0),R=[],W=1;W<A.length;W++)y(R,T(A[W]));var E=A.groups;if(v){var M=_([L],R,P,l);void 0!==E&&y(M,E),z=f(a(r,void 0,M))}else z=b(L,l,P,R,E,r);P>=I&&(D+=x(l,I,P)+z,I=P+L.length)}return D+x(l,I)}]}),!D||!S||$)},32375:(e,t,n)=>{n.d(t,{A:()=>o});n(28706);var a=n(94335),r="http://server:8080";const o={getAssets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return console.log("获取资产列表:",{baseURL:a.A.defaults.baseURL,endpoint:"".concat(r,"/api/assets"),params:e}),a.A.get("".concat(r,"/api/assets"),{params:e})},getAssetById:function(e){return a.A.get("".concat(r,"/api/assets/").concat(e))},createAsset:function(e){return a.A.post("".concat(r,"/api/assets"),e)},updateAsset:function(e,t){return a.A.put("".concat(r,"/api/assets/").concat(e),t)},deleteAsset:function(e){return a.A["delete"]("".concat(r,"/api/assets/").concat(e))},getAssetVulnerabilities:function(e){return a.A.get("".concat(r,"/api/assets/").concat(e,"/vulnerabilities"))},addVulnerabilityToAsset:function(e,t){return console.log("添加漏洞到资产: ".concat(e,", 漏洞ID: ").concat(t)),a.A.post("".concat(r,"/api/assets/").concat(e,"/vulnerabilities"),{vulnerabilityId:t})},removeVulnerabilityFromAsset:function(e,t){return a.A["delete"]("".concat(r,"/api/assets/").concat(e,"/vulnerabilities/").concat(t))},addAssetNote:function(e,t){return a.A.post("".concat(r,"/api/assets/").concat(e,"/notes"),{content:t})},importAssets:function(e){return a.A.post("".concat(r,"/api/assets/import"),e,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4,onUploadProgress:function(e){console.log("上传进度:",Math.round(100*e.loaded/e.total)+"%")}})},downloadImportTemplate:function(){return a.A.get("".concat(r,"/api/assets/import-template"),{responseType:"blob"})}}},57829:(e,t,n)=>{var a=n(68183).charAt;e.exports=function(e,t,n){return t+(n?a(e,t).length:1)}},68156:(e,t,n)=>{var a=n(46518),r=n(60533).start,o=n(83063);a({target:"String",proto:!0,forced:o},{padStart:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},73647:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});n(52675),n(89463),n(62010);var a=n(20641),r=n(53751),o=n(90033),i={class:"asset-list"},l={class:"page-header"},c={class:"header-actions"},s={class:"filter-card"},u={class:"pagination-container"};function d(e,t,n,d,p,f){var v=(0,a.g2)("el-button"),g=(0,a.g2)("el-option"),h=(0,a.g2)("el-select"),b=(0,a.g2)("el-form-item"),m=(0,a.g2)("el-input"),k=(0,a.g2)("el-form"),A=(0,a.g2)("el-table-column"),w=(0,a.g2)("router-link"),F=(0,a.g2)("el-tooltip"),_=(0,a.g2)("el-tag"),y=(0,a.g2)("el-badge"),C=(0,a.g2)("el-table"),x=(0,a.g2)("el-pagination"),T=(0,a.g2)("el-card"),S=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",l,[t[5]||(t[5]=(0,a.Fv)('<div class="header-content" data-v-cc1d5108><h1 class="page-title" data-v-cc1d5108><span class="title-icon" data-v-cc1d5108><i class="el-icon-office-building" data-v-cc1d5108></i></span> 资产列表 <span class="title-highlight" data-v-cc1d5108>管理</span></h1><p class="page-subtitle" data-v-cc1d5108>查看和管理所有资产信息，监控资产安全状态</p></div>',1)),(0,a.Lk)("div",c,[(0,a.bF)(v,{type:"primary",onClick:d.goToCreate,class:"action-btn"},{default:(0,a.k6)((function(){return t[3]||(t[3]=[(0,a.Lk)("i",{class:"el-icon-plus"},null,-1),(0,a.eW)(" 添加资产 ")])})),_:1},8,["onClick"]),(0,a.bF)(v,{type:"success",onClick:d.goToImport,class:"action-btn import-btn"},{default:(0,a.k6)((function(){return t[4]||(t[4]=[(0,a.Lk)("i",{class:"el-icon-upload2"},null,-1),(0,a.eW)(" 批量导入 ")])})),_:1},8,["onClick"])])]),(0,a.Lk)("div",s,[(0,a.bF)(k,{inline:!0,model:d.searchParams,class:"search-form"},{default:(0,a.k6)((function(){return[(0,a.bF)(b,{label:"类型"},{default:(0,a.k6)((function(){return[(0,a.bF)(h,{modelValue:d.searchParams.type,"onUpdate:modelValue":t[0]||(t[0]=function(e){return d.searchParams.type=e}),placeholder:"选择资产类型",clearable:""},{default:(0,a.k6)((function(){return[(0,a.bF)(g,{label:"服务器",value:"server"}),(0,a.bF)(g,{label:"网络设备",value:"network_device"}),(0,a.bF)(g,{label:"应用程序",value:"application"}),(0,a.bF)(g,{label:"数据库",value:"database"}),(0,a.bF)(g,{label:"云资源",value:"cloud_resource"}),(0,a.bF)(g,{label:"物联网设备",value:"iot_device"}),(0,a.bF)(g,{label:"其他",value:"other"})]})),_:1},8,["modelValue"])]})),_:1}),(0,a.bF)(b,{label:"环境"},{default:(0,a.k6)((function(){return[(0,a.bF)(h,{modelValue:d.searchParams.environment,"onUpdate:modelValue":t[1]||(t[1]=function(e){return d.searchParams.environment=e}),placeholder:"选择环境",clearable:""},{default:(0,a.k6)((function(){return[(0,a.bF)(g,{label:"生产",value:"production"}),(0,a.bF)(g,{label:"测试",value:"testing"}),(0,a.bF)(g,{label:"开发",value:"development"}),(0,a.bF)(g,{label:"预生产",value:"staging"})]})),_:1},8,["modelValue"])]})),_:1}),(0,a.bF)(b,{label:"搜索"},{default:(0,a.k6)((function(){return[(0,a.bF)(m,{modelValue:d.searchParams.searchTerm,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d.searchParams.searchTerm=e}),placeholder:"搜索名称、描述或IP地址",clearable:"",onKeyup:(0,r.jR)(d.fetchAssets,["enter"])},{append:(0,a.k6)((function(){return[(0,a.bF)(v,{icon:"el-icon-search",onClick:d.fetchAssets},null,8,["onClick"])]})),_:1},8,["modelValue","onKeyup"])]})),_:1}),(0,a.bF)(b,null,{default:(0,a.k6)((function(){return[(0,a.bF)(v,{type:"primary",onClick:d.fetchAssets},{default:(0,a.k6)((function(){return t[6]||(t[6]=[(0,a.eW)("筛选")])})),_:1},8,["onClick"]),(0,a.bF)(v,{onClick:d.resetFilters},{default:(0,a.k6)((function(){return t[7]||(t[7]=[(0,a.eW)("重置")])})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model"])]),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(T,{class:"list-card"},{default:(0,a.k6)((function(){return[(0,a.bF)(C,{data:d.assets,style:{width:"100%"},border:"",onRowClick:d.handleRowClick,"empty-text":d.loading?"加载中...":"未找到符合条件的资产"},{default:(0,a.k6)((function(){return[(0,a.bF)(A,{label:"序号",type:"index",index:d.indexMethod,width:"80"},null,8,["index"]),(0,a.bF)(A,{label:"名称",prop:"name","min-width":"150"},{default:(0,a.k6)((function(e){return[(0,a.bF)(F,{content:e.row.description,placement:"top"},{default:(0,a.k6)((function(){return[(0,a.bF)(w,{to:{name:"AssetDetail",params:{id:e.row.id}},class:"asset-link"},{default:(0,a.k6)((function(){return[(0,a.eW)((0,o.v_)(e.row.name),1)]})),_:2},1032,["to"])]})),_:2},1032,["content"])]})),_:1}),(0,a.bF)(A,{label:"类型",prop:"type",width:"120"},{default:(0,a.k6)((function(e){return[(0,a.bF)(_,{type:d.getAssetTypeTag(e.row.type)},{default:(0,a.k6)((function(){return[(0,a.eW)((0,o.v_)(d.getAssetTypeLabel(e.row.type)),1)]})),_:2},1032,["type"])]})),_:1}),(0,a.bF)(A,{label:"IP地址",prop:"ipAddress",width:"150"}),(0,a.bF)(A,{label:"环境",prop:"environment",width:"100"},{default:(0,a.k6)((function(e){return[(0,a.bF)(_,{type:d.getEnvironmentTag(e.row.environment)},{default:(0,a.k6)((function(){return[(0,a.eW)((0,o.v_)(d.getEnvironmentLabel(e.row.environment)),1)]})),_:2},1032,["type"])]})),_:1}),(0,a.bF)(A,{label:"漏洞数量",prop:"vulnerabilityCount",width:"100",align:"center"},{default:(0,a.k6)((function(e){return[(0,a.bF)(y,{value:e.row.vulnerabilityCount||0,type:"danger"},null,8,["value"])]})),_:1}),(0,a.bF)(A,{label:"创建时间",prop:"createdAt",width:"180"},{default:(0,a.k6)((function(e){return[(0,a.eW)((0,o.v_)(d.formatDate(e.row.createdAt)),1)]})),_:1}),(0,a.bF)(A,{label:"操作",width:"200",fixed:"right"},{default:(0,a.k6)((function(e){return[(0,a.bF)(v,{size:"small",type:"primary",plain:"",onClick:(0,r.D$)((function(t){return d.goToDetails(e.row.id)}),["stop"])},{default:(0,a.k6)((function(){return t[8]||(t[8]=[(0,a.eW)(" 详情 ")])})),_:2},1032,["onClick"]),(0,a.bF)(v,{size:"small",type:"warning",plain:"",onClick:(0,r.D$)((function(t){return d.goToEdit(e.row.id)}),["stop"])},{default:(0,a.k6)((function(){return t[9]||(t[9]=[(0,a.eW)(" 编辑 ")])})),_:2},1032,["onClick"]),(0,a.bF)(v,{size:"small",type:"danger",plain:"",onClick:(0,r.D$)((function(t){return d.confirmDelete(e.row)}),["stop"])},{default:(0,a.k6)((function(){return t[10]||(t[10]=[(0,a.eW)(" 删除 ")])})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data","onRowClick","empty-text"]),(0,a.Lk)("div",u,[(0,a.bF)(x,{"current-page":d.currentPage,"page-sizes":[10,20,50,100],"page-size":d.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:d.totalAssets,onSizeChange:d.handleSizeChange,onCurrentChange:d.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]})),_:1})),[[S,d.loading]])])}var p=n(14048),f=n(29201),v=n(30388),g=(n(51629),n(44114),n(18111),n(7588),n(79432),n(26099),n(23500),n(50953)),h=n(75220),b=n(20163),m=n(77918),k=n(32375),A=n(78870);const w={name:"AssetList",setup:function(){var e=(0,h.rd)(),t=(0,g.KR)(!1),n=(0,g.KR)([]),r=(0,g.KR)(1),o=(0,g.KR)(10),i=(0,g.KR)(0),l=(0,g.Kh)({type:"",environment:"",searchTerm:""}),c=function(){var e=(0,v.A)((0,p.A)().mark((function e(){var a,c;return(0,p.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.value=!0,e.prev=1,a=(0,f.A)((0,f.A)({},l),{},{limit:o.value,skip:(r.value-1)*o.value}),e.next=5,k.A.getAssets(a);case 5:c=e.sent,n.value=c.data.assets||[],i.value=c.data.total||0,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](1),console.error("获取资产列表失败:",e.t0),b.nk.error("获取资产列表失败，请重试");case 14:return e.prev=14,t.value=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,10,14,17]])})));return function(){return e.apply(this,arguments)}}(),s=function(e){o.value=e,c()},u=function(e){r.value=e,c()},d=function(){Object.keys(l).forEach((function(e){l[e]=""})),c()},w=function(t){e.push({name:"AssetDetail",params:{id:t.id}})},F=function(){e.push({name:"AssetCreate"})},_=function(){e.push({name:"AssetImport"})},y=function(t){e.push({name:"AssetDetail",params:{id:t}})},C=function(t){e.push({name:"AssetEdit",params:{id:t}})},x=function(e){m.s.confirm('确定要删除资产 "'.concat(e.name,'" 吗？此操作不可恢复。'),"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){T(e.id)}))["catch"]((function(){}))},T=function(){var e=(0,v.A)((0,p.A)().mark((function e(t){return(0,p.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.A.deleteAsset(t);case 3:b.nk.success("资产已成功删除"),c(),e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),console.error("删除资产失败:",e.t0),b.nk.error("删除资产失败，请重试");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),S=function(e){var t={server:"服务器",network_device:"网络设备",application:"应用程序",database:"数据库",cloud_resource:"云资源",iot_device:"物联网设备",other:"其他"};return t[e]||e},$=function(e){var t={server:"primary",network_device:"success",application:"warning",database:"danger",cloud_resource:"info",iot_device:"",other:"info"};return t[e]||"info"},D=function(e){var t={production:"生产",testing:"测试",development:"开发",staging:"预生产"};return t[e]||e},I=function(e){var t={production:"danger",testing:"warning",development:"success",staging:"info"};return t[e]||"info"},V=function(e){return(r.value-1)*o.value+e+1};return(0,a.sV)((function(){c()})),{loading:t,assets:n,currentPage:r,pageSize:o,totalAssets:i,searchParams:l,formatDate:A.Yq,fetchAssets:c,handleSizeChange:s,handleCurrentChange:u,resetFilters:d,handleRowClick:w,goToCreate:F,goToImport:_,goToDetails:y,goToEdit:C,confirmDelete:x,getAssetTypeLabel:S,getAssetTypeTag:$,getEnvironmentLabel:D,getEnvironmentTag:I,indexMethod:V}}};var F=n(66262);const _=(0,F.A)(w,[["render",d],["__scopeId","data-v-cc1d5108"]]),y=_},78870:(e,t,n)=>{n.d(t,{Yq:()=>a});n(76918),n(28706),n(23288),n(9868),n(26099),n(27495),n(38781),n(68156),n(25440);function a(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";var n=new Date(e);if(isNaN(n.getTime()))return"";var a=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getDate()).padStart(2,"0");if(!t)return"".concat(a,"-").concat(r,"-").concat(o);var i=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0"),c=String(n.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(o," ").concat(i,":").concat(l,":").concat(c)}},83063:(e,t,n)=>{var a=n(82839);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(a)}}]);
//# sourceMappingURL=647.f29bbffe.js.map