"use strict";(self["webpackChunkvuln_management_frontend"]=self["webpackChunkvuln_management_frontend"]||[]).push([[502],{78502:(e,l,a)=>{a.r(l),a.d(l,{default:()=>A});a(62010);var t=a(20641),n=a(53751),s=a(90033),o={class:"vulnerability-import"},i={class:"page-header"},r={class:"header-actions"},u={class:"import-card"},c={class:"tab-content"},d={class:"import-description"},p={class:"format-notice"},m={class:"import-options"},f={class:"import-actions"},k={class:"tab-content"},v={class:"import-description"},b={class:"scanner-grid"},L={class:"scanner-format"},g={class:"import-options"},h={class:"import-actions"},y={class:"progress-dialog-content"},F={class:"progress-info"},_={key:0,class:"import-summary"},V={class:"summary-item"},S={class:"summary-value success"},C={class:"summary-item"},w={class:"summary-value skipped"},I={class:"summary-item"},x={class:"summary-value error"},O={class:"dialog-footer"};function W(e,l,a,W,T,M){var K=(0,t.g2)("el-button"),R=(0,t.g2)("el-alert"),B=(0,t.g2)("el-upload"),P=(0,t.g2)("el-radio"),N=(0,t.g2)("el-radio-group"),U=(0,t.g2)("el-form-item"),A=(0,t.g2)("el-option"),E=(0,t.g2)("el-select"),D=(0,t.g2)("el-switch"),X=(0,t.g2)("el-form"),q=(0,t.g2)("el-tab-pane"),j=(0,t.g2)("el-tabs"),Q=(0,t.g2)("el-progress"),z=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.CE)("div",o,[(0,t.Lk)("div",i,[l[12]||(l[12]=(0,t.Fv)('<div class="header-content" data-v-f6208e02><h1 class="page-title" data-v-f6208e02><span class="title-icon" data-v-f6208e02><i class="el-icon-upload2" data-v-f6208e02></i></span> 漏洞导入 <span class="title-highlight" data-v-f6208e02>工具</span></h1><p class="page-subtitle" data-v-f6208e02>批量导入安全漏洞数据，支持多种格式和扫描工具结果</p></div>',1)),(0,t.Lk)("div",r,[(0,t.bF)(K,{onClick:W.cancel,class:"action-btn"},{default:(0,t.k6)((function(){return l[11]||(l[11]=[(0,t.Lk)("i",{class:"el-icon-back"},null,-1),(0,t.eW)(" 返回列表 ")])})),_:1},8,["onClick"])])]),(0,t.Lk)("div",u,[(0,t.bF)(j,{modelValue:W.activeTab,"onUpdate:modelValue":l[9]||(l[9]=function(e){return W.activeTab=e}),type:"border-card",class:"import-tabs"},{default:(0,t.k6)((function(){return[(0,t.bF)(q,{label:"文件导入",name:"file"},{default:(0,t.k6)((function(){return[(0,t.Lk)("div",c,[(0,t.Lk)("div",d,[l[16]||(l[16]=(0,t.Lk)("div",{class:"description-header"},[(0,t.Lk)("i",{class:"el-icon-document format-icon"}),(0,t.Lk)("h3",null,"支持的文件格式")],-1)),l[17]||(l[17]=(0,t.Lk)("div",{class:"format-grid"},[(0,t.Lk)("div",{class:"format-item"},[(0,t.Lk)("div",{class:"format-icon-wrapper csv"},[(0,t.Lk)("i",{class:"el-icon-document"})]),(0,t.Lk)("span",null,"CSV文件 (.csv)")]),(0,t.Lk)("div",{class:"format-item"},[(0,t.Lk)("div",{class:"format-icon-wrapper excel"},[(0,t.Lk)("i",{class:"el-icon-document"})]),(0,t.Lk)("span",null,"Excel文件 (.xlsx, .xls)")]),(0,t.Lk)("div",{class:"format-item"},[(0,t.Lk)("div",{class:"format-icon-wrapper json"},[(0,t.Lk)("i",{class:"el-icon-document"})]),(0,t.Lk)("span",null,"JSON文件 (.json)")]),(0,t.Lk)("div",{class:"format-item"},[(0,t.Lk)("div",{class:"format-icon-wrapper xml"},[(0,t.Lk)("i",{class:"el-icon-document"})]),(0,t.Lk)("span",null,"XML文件 (.xml)")])],-1)),(0,t.Lk)("p",p,[l[14]||(l[14]=(0,t.eW)("请确保文件包含必要的字段，如漏洞标题、严重程度、描述等。 ")),(0,t.Lk)("a",{href:"#",onClick:l[0]||(l[0]=(0,n.D$)((function(){return W.downloadTemplate&&W.downloadTemplate.apply(W,arguments)}),["prevent"])),class:"download-link"},l[13]||(l[13]=[(0,t.Lk)("i",{class:"el-icon-download"},null,-1),(0,t.eW)(" 下载模板文件 ")]))]),(0,t.bF)(R,{type:"warning","show-icon":"",closable:!1,class:"import-alert"},{default:(0,t.k6)((function(){return l[15]||(l[15]=[(0,t.Lk)("p",null,"导入大量数据可能需要一些时间，请耐心等待并不要刷新页面。",-1)])})),_:1})]),(0,t.bF)(B,{class:"upload-area",drag:"",action:"/api/vulnerabilities/import","auto-upload":!1,"on-change":W.handleFileChange,"on-success":W.handleImportSuccess,"on-error":W.handleImportError,"before-upload":W.beforeImport,"file-list":W.fileList,limit:1},{tip:(0,t.k6)((function(){return l[18]||(l[18]=[(0,t.Lk)("div",{class:"el-upload__tip"},"支持CSV、Excel、JSON和XML文件，文件大小不超过10MB",-1)])})),default:(0,t.k6)((function(){return[l[19]||(l[19]=(0,t.Lk)("i",{class:"el-icon-upload"},null,-1)),l[20]||(l[20]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)("将文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))]})),_:1},8,["on-change","on-success","on-error","before-upload","file-list"]),(0,t.Lk)("div",m,[l[32]||(l[32]=(0,t.Lk)("div",{class:"options-header"},[(0,t.Lk)("i",{class:"el-icon-setting"}),(0,t.Lk)("h3",null,"导入选项")],-1)),(0,t.bF)(X,{model:W.importOptions,"label-width":"180px"},{default:(0,t.k6)((function(){return[(0,t.bF)(U,{label:"导入重复项时"},{default:(0,t.k6)((function(){return[(0,t.bF)(N,{modelValue:W.importOptions.duplicateStrategy,"onUpdate:modelValue":l[1]||(l[1]=function(e){return W.importOptions.duplicateStrategy=e})},{default:(0,t.k6)((function(){return[(0,t.bF)(P,{label:"skip"},{default:(0,t.k6)((function(){return l[21]||(l[21]=[(0,t.eW)("跳过重复项")])})),_:1}),(0,t.bF)(P,{label:"update"},{default:(0,t.k6)((function(){return l[22]||(l[22]=[(0,t.eW)("更新重复项")])})),_:1}),(0,t.bF)(P,{label:"create_new"},{default:(0,t.k6)((function(){return l[23]||(l[23]=[(0,t.eW)("创建为新记录")])})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,t.bF)(U,{label:"默认严重程度"},{default:(0,t.k6)((function(){return[(0,t.bF)(E,{modelValue:W.importOptions.defaultSeverity,"onUpdate:modelValue":l[2]||(l[2]=function(e){return W.importOptions.defaultSeverity=e}),placeholder:"选择默认严重程度"},{default:(0,t.k6)((function(){return[(0,t.bF)(A,{label:"未指定",value:""}),(0,t.bF)(A,{label:"严重",value:"critical"},{default:(0,t.k6)((function(){return l[24]||(l[24]=[(0,t.Lk)("div",{class:"severity-option"},[(0,t.Lk)("span",{class:"severity-dot critical"}),(0,t.Lk)("span",null,"严重")],-1)])})),_:1}),(0,t.bF)(A,{label:"高危",value:"high"},{default:(0,t.k6)((function(){return l[25]||(l[25]=[(0,t.Lk)("div",{class:"severity-option"},[(0,t.Lk)("span",{class:"severity-dot high"}),(0,t.Lk)("span",null,"高危")],-1)])})),_:1}),(0,t.bF)(A,{label:"中危",value:"medium"},{default:(0,t.k6)((function(){return l[26]||(l[26]=[(0,t.Lk)("div",{class:"severity-option"},[(0,t.Lk)("span",{class:"severity-dot medium"}),(0,t.Lk)("span",null,"中危")],-1)])})),_:1}),(0,t.bF)(A,{label:"低危",value:"low"},{default:(0,t.k6)((function(){return l[27]||(l[27]=[(0,t.Lk)("div",{class:"severity-option"},[(0,t.Lk)("span",{class:"severity-dot low"}),(0,t.Lk)("span",null,"低危")],-1)])})),_:1}),(0,t.bF)(A,{label:"信息",value:"info"},{default:(0,t.k6)((function(){return l[28]||(l[28]=[(0,t.Lk)("div",{class:"severity-option"},[(0,t.Lk)("span",{class:"severity-dot info"}),(0,t.Lk)("span",null,"信息")],-1)])})),_:1})]})),_:1},8,["modelValue"]),l[29]||(l[29]=(0,t.Lk)("div",{class:"option-description"},"当导入数据未指定严重程度时使用",-1))]})),_:1}),(0,t.bF)(U,{label:"默认状态"},{default:(0,t.k6)((function(){return[(0,t.bF)(E,{modelValue:W.importOptions.defaultStatus,"onUpdate:modelValue":l[3]||(l[3]=function(e){return W.importOptions.defaultStatus=e}),placeholder:"选择默认状态"},{default:(0,t.k6)((function(){return[(0,t.bF)(A,{label:"开放",value:"open"}),(0,t.bF)(A,{label:"处理中",value:"in_progress"}),(0,t.bF)(A,{label:"已解决",value:"resolved"}),(0,t.bF)(A,{label:"已关闭",value:"closed"}),(0,t.bF)(A,{label:"误报",value:"false_positive"})]})),_:1},8,["modelValue"]),l[30]||(l[30]=(0,t.Lk)("div",{class:"option-description"},"当导入数据未指定状态时使用",-1))]})),_:1}),(0,t.bF)(U,{label:"发送通知"},{default:(0,t.k6)((function(){return[(0,t.bF)(D,{modelValue:W.importOptions.sendNotifications,"onUpdate:modelValue":l[4]||(l[4]=function(e){return W.importOptions.sendNotifications=e})},null,8,["modelValue"]),l[31]||(l[31]=(0,t.Lk)("div",{class:"option-description"},"完成导入后是否发送通知",-1))]})),_:1})]})),_:1},8,["model"])])]),(0,t.Lk)("div",f,[(0,t.bF)(K,{onClick:W.cancel,class:"cancel-btn"},{default:(0,t.k6)((function(){return l[33]||(l[33]=[(0,t.eW)("取消")])})),_:1},8,["onClick"]),(0,t.bF)(K,{type:"primary",onClick:W.startImport,loading:W.importing,disabled:0===W.fileList.length,class:"import-btn"},{default:(0,t.k6)((function(){return l[34]||(l[34]=[(0,t.Lk)("i",{class:"el-icon-upload"},null,-1),(0,t.eW)(" 开始导入 ")])})),_:1},8,["onClick","loading","disabled"])])]})),_:1}),(0,t.bF)(q,{label:"扫描结果导入",name:"scan"},{default:(0,t.k6)((function(){return[(0,t.Lk)("div",k,[(0,t.Lk)("div",v,[l[37]||(l[37]=(0,t.Lk)("div",{class:"description-header"},[(0,t.Lk)("i",{class:"el-icon-monitor format-icon"}),(0,t.Lk)("h3",null,"支持的扫描工具")],-1)),(0,t.Lk)("div",b,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(W.scanners,(function(e,a){return(0,t.uX)(),(0,t.CE)("div",{class:"scanner-item",key:a},[(0,t.Lk)("div",{class:(0,s.C4)(["scanner-icon-wrapper",e["class"]])},l[35]||(l[35]=[(0,t.Lk)("i",{class:"el-icon-cpu"},null,-1)]),2),(0,t.Lk)("span",null,(0,s.v_)(e.name),1),(0,t.Lk)("span",L,(0,s.v_)(e.format),1)])})),128))]),l[38]||(l[38]=(0,t.Lk)("p",{class:"format-notice"},"系统会自动解析扫描工具的报告格式，并将漏洞信息导入到平台中。",-1)),(0,t.bF)(R,{type:"info","show-icon":"",closable:!1,class:"import-alert"},{default:(0,t.k6)((function(){return l[36]||(l[36]=[(0,t.Lk)("p",null,"导入后请检查数据准确性，不同扫描工具的数据格式可能略有差异。",-1)])})),_:1})]),(0,t.bF)(B,{class:"upload-area",drag:"",action:"/api/vulnerabilities/import/scan","auto-upload":!1,"on-change":W.handleScanFileChange,"on-success":W.handleImportSuccess,"on-error":W.handleImportError,"before-upload":W.beforeImport,"file-list":W.scanFileList,limit:1},{tip:(0,t.k6)((function(){return l[39]||(l[39]=[(0,t.Lk)("div",{class:"el-upload__tip"},"支持各种扫描工具生成的报告文件，文件大小不超过50MB",-1)])})),default:(0,t.k6)((function(){return[l[40]||(l[40]=(0,t.Lk)("i",{class:"el-icon-upload"},null,-1)),l[41]||(l[41]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)("将扫描报告文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))]})),_:1},8,["on-change","on-success","on-error","before-upload","file-list"]),(0,t.Lk)("div",g,[l[52]||(l[52]=(0,t.Lk)("div",{class:"options-header"},[(0,t.Lk)("i",{class:"el-icon-setting"}),(0,t.Lk)("h3",null,"导入选项")],-1)),(0,t.bF)(X,{model:W.scanImportOptions,"label-width":"180px"},{default:(0,t.k6)((function(){return[(0,t.bF)(U,{label:"扫描工具类型"},{default:(0,t.k6)((function(){return[(0,t.bF)(E,{modelValue:W.scanImportOptions.scannerType,"onUpdate:modelValue":l[5]||(l[5]=function(e){return W.scanImportOptions.scannerType=e}),placeholder:"选择扫描工具类型"},{default:(0,t.k6)((function(){return[(0,t.bF)(A,{label:"自动检测",value:"auto"}),(0,t.bF)(A,{label:"Nessus",value:"nessus"}),(0,t.bF)(A,{label:"OpenVAS/Greenbone",value:"openvas"}),(0,t.bF)(A,{label:"OWASP ZAP",value:"zap"}),(0,t.bF)(A,{label:"Qualys",value:"qualys"}),(0,t.bF)(A,{label:"Acunetix",value:"acunetix"}),(0,t.bF)(A,{label:"Burp Suite",value:"burp"})]})),_:1},8,["modelValue"]),l[42]||(l[42]=(0,t.Lk)("div",{class:"option-description"},"通常情况下可以使用自动检测",-1))]})),_:1}),(0,t.bF)(U,{label:"最低严重程度"},{default:(0,t.k6)((function(){return[(0,t.bF)(E,{modelValue:W.scanImportOptions.minimumSeverity,"onUpdate:modelValue":l[6]||(l[6]=function(e){return W.scanImportOptions.minimumSeverity=e}),placeholder:"选择最低严重程度"},{default:(0,t.k6)((function(){return[(0,t.bF)(A,{label:"全部导入",value:""}),(0,t.bF)(A,{label:"严重",value:"critical"},{default:(0,t.k6)((function(){return l[43]||(l[43]=[(0,t.Lk)("div",{class:"severity-option"},[(0,t.Lk)("span",{class:"severity-dot critical"}),(0,t.Lk)("span",null,"严重")],-1)])})),_:1}),(0,t.bF)(A,{label:"高危",value:"high"},{default:(0,t.k6)((function(){return l[44]||(l[44]=[(0,t.Lk)("div",{class:"severity-option"},[(0,t.Lk)("span",{class:"severity-dot high"}),(0,t.Lk)("span",null,"高危")],-1)])})),_:1}),(0,t.bF)(A,{label:"中危",value:"medium"},{default:(0,t.k6)((function(){return l[45]||(l[45]=[(0,t.Lk)("div",{class:"severity-option"},[(0,t.Lk)("span",{class:"severity-dot medium"}),(0,t.Lk)("span",null,"中危")],-1)])})),_:1}),(0,t.bF)(A,{label:"低危",value:"low"},{default:(0,t.k6)((function(){return l[46]||(l[46]=[(0,t.Lk)("div",{class:"severity-option"},[(0,t.Lk)("span",{class:"severity-dot low"}),(0,t.Lk)("span",null,"低危")],-1)])})),_:1})]})),_:1},8,["modelValue"]),l[47]||(l[47]=(0,t.Lk)("div",{class:"option-description"},"仅导入选定严重程度及以上的漏洞",-1))]})),_:1}),(0,t.bF)(U,{label:"导入重复项时"},{default:(0,t.k6)((function(){return[(0,t.bF)(N,{modelValue:W.scanImportOptions.duplicateStrategy,"onUpdate:modelValue":l[7]||(l[7]=function(e){return W.scanImportOptions.duplicateStrategy=e})},{default:(0,t.k6)((function(){return[(0,t.bF)(P,{label:"skip"},{default:(0,t.k6)((function(){return l[48]||(l[48]=[(0,t.eW)("跳过重复项")])})),_:1}),(0,t.bF)(P,{label:"update"},{default:(0,t.k6)((function(){return l[49]||(l[49]=[(0,t.eW)("更新重复项")])})),_:1}),(0,t.bF)(P,{label:"create_new"},{default:(0,t.k6)((function(){return l[50]||(l[50]=[(0,t.eW)("创建为新记录")])})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,t.bF)(U,{label:"发送通知"},{default:(0,t.k6)((function(){return[(0,t.bF)(D,{modelValue:W.scanImportOptions.sendNotifications,"onUpdate:modelValue":l[8]||(l[8]=function(e){return W.scanImportOptions.sendNotifications=e})},null,8,["modelValue"]),l[51]||(l[51]=(0,t.Lk)("div",{class:"option-description"},"完成导入后是否发送通知",-1))]})),_:1})]})),_:1},8,["model"])])]),(0,t.Lk)("div",h,[(0,t.bF)(K,{onClick:W.cancel,class:"cancel-btn"},{default:(0,t.k6)((function(){return l[53]||(l[53]=[(0,t.eW)("取消")])})),_:1},8,["onClick"]),(0,t.bF)(K,{type:"primary",onClick:W.startScanImport,loading:W.importing,disabled:0===W.scanFileList.length,class:"import-btn"},{default:(0,t.k6)((function(){return l[54]||(l[54]=[(0,t.Lk)("i",{class:"el-icon-upload"},null,-1),(0,t.eW)(" 开始导入 ")])})),_:1},8,["onClick","loading","disabled"])])]})),_:1})]})),_:1},8,["modelValue"])]),(0,t.bF)(z,{title:"导入进度",modelValue:W.progressDialogVisible,"onUpdate:modelValue":l[10]||(l[10]=function(e){return W.progressDialogVisible=e}),"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"500px",class:"progress-dialog"},{footer:(0,t.k6)((function(){return[(0,t.Lk)("span",O,[W.importCompleted?((0,t.uX)(),(0,t.Wv)(K,{key:0,type:"primary",onClick:W.closeProgressDialog},{default:(0,t.k6)((function(){return l[58]||(l[58]=[(0,t.eW)(" 关闭 ")])})),_:1},8,["onClick"])):(0,t.Q3)("",!0),W.importProgress<100&&!W.importing?((0,t.uX)(),(0,t.Wv)(K,{key:1,type:"danger",onClick:W.cancelImport},{default:(0,t.k6)((function(){return l[59]||(l[59]=[(0,t.eW)(" 取消导入 ")])})),_:1},8,["onClick"])):(0,t.Q3)("",!0)])]})),default:(0,t.k6)((function(){return[(0,t.Lk)("div",y,[(0,t.bF)(Q,{percentage:W.importProgress,status:100===W.importProgress?"success":"","stroke-width":10,class:"import-progress"},null,8,["percentage","status"]),(0,t.Lk)("div",F,[(0,t.Lk)("p",null,(0,s.v_)(W.progressMessage),1),W.importCompleted?((0,t.uX)(),(0,t.CE)("div",_,[(0,t.Lk)("div",V,[l[55]||(l[55]=(0,t.Lk)("div",{class:"summary-label"},"成功导入：",-1)),(0,t.Lk)("div",S,(0,s.v_)(W.importResults.successful),1)]),(0,t.Lk)("div",C,[l[56]||(l[56]=(0,t.Lk)("div",{class:"summary-label"},"重复跳过：",-1)),(0,t.Lk)("div",w,(0,s.v_)(W.importResults.duplicates),1)]),(0,t.Lk)("div",I,[l[57]||(l[57]=(0,t.Lk)("div",{class:"summary-label"},"导入失败：",-1)),(0,t.Lk)("div",x,(0,s.v_)(W.importResults.failed),1)])])):(0,t.Q3)("",!0)])])]})),_:1},8,["modelValue"])])}a(44114),a(76031);var T=a(50953),M=a(75220),K=a(20163),R=a(77918),B=a(66278);const P={name:"VulnerabilityImport",setup:function(){var e=(0,M.rd)(),l=(0,B.Pj)(),a=(0,T.KR)("file"),t=(0,T.KR)([]),n=(0,T.KR)([]),s=(0,T.KR)(!1),o=(0,T.KR)(!1),i=(0,T.KR)(0),r=(0,T.KR)("准备导入..."),u=(0,T.KR)(!1),c=(0,T.Kh)({successful:0,duplicates:0,failed:0}),d=[{name:"Nessus",format:".nessus",class:"nessus"},{name:"OpenVAS/Greenbone",format:".xml",class:"openvas"},{name:"OWASP ZAP",format:".xml, .json",class:"zap"},{name:"Qualys",format:".xml",class:"qualys"},{name:"Acunetix",format:".xml",class:"acunetix"},{name:"Burp Suite",format:".xml",class:"burp"}],p=(0,T.Kh)({duplicateStrategy:"skip",defaultSeverity:"medium",defaultStatus:"open",sendNotifications:!0}),m=(0,T.Kh)({scannerType:"auto",minimumSeverity:"",duplicateStrategy:"skip",sendNotifications:!0}),f=function(e){t.value=[e]},k=function(e){n.value=[e]},v=function(e){var l=e.size/1024/1024;return!(l>50)||(K.nk.error("文件大小不能超过50MB"),!1)},b=function(){K.nk.info("模板文件下载功能尚未实现")},L=function(){0!==t.value.length?R.s.confirm("确定要开始导入文件吗？根据数据量大小，这可能需要一些时间。","开始导入",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(){s.value=!0,o.value=!0,i.value=0,r.value="正在解析文件...",h(),setTimeout((function(){var e=document.querySelector(".upload-area .el-upload").querySelector("input[type=file]");e&&e.files.length}),500)}))["catch"]((function(){})):K.nk.warning("请选择要导入的文件")},g=function(){0!==n.value.length?R.s.confirm("确定要开始导入扫描结果吗？根据数据量大小，这可能需要一些时间。","开始导入",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(){s.value=!0,o.value=!0,i.value=0,r.value="正在解析扫描结果...",h(),setTimeout((function(){var e=document.querySelector(".upload-area .el-upload").querySelector("input[type=file]");e&&e.files.length}),500)}))["catch"]((function(){})):K.nk.warning("请选择扫描结果文件")},h=function(){var e=0,l=setInterval((function(){e+=10*Math.random(),e>=90&&(e=90,clearInterval(l),r.value="即将完成..."),i.value=Math.floor(e)}),800);setTimeout((function(){i.value=100,s.value=!1,r.value="导入完成！",u.value=!0,c.successful=Math.floor(50*Math.random())+20,c.duplicates=Math.floor(10*Math.random()),c.failed=Math.floor(5*Math.random())}),8e3)},y=function(e){s.value=!1,i.value=100,r.value="导入完成！",u.value=!0,e&&e.data&&e.data.stats&&Object.assign(c,e.data.stats),l.dispatch("dashboard/fetchDashboardData"),K.nk.success("导入成功")},F=function(e){s.value=!1,K.nk.error("导入失败: "+(e.message||"未知错误")),o.value=!1},_=function(){o.value=!1,u.value=!1,100===i.value&&e.push("/vulnerabilities")},V=function(){R.s.confirm("确定要取消当前导入操作吗？已导入的数据将不会回滚。","取消导入",{confirmButtonText:"确定",cancelButtonText:"继续导入",type:"warning"}).then((function(){s.value=!1,o.value=!1,K.nk.info("导入已取消")}))["catch"]((function(){}))},S=function(){e.push("/vulnerabilities")};return{activeTab:a,fileList:t,scanFileList:n,importing:s,importOptions:p,scanImportOptions:m,progressDialogVisible:o,importProgress:i,progressMessage:r,importCompleted:u,importResults:c,scanners:d,handleFileChange:f,handleScanFileChange:k,beforeImport:v,startImport:L,startScanImport:g,handleImportSuccess:y,handleImportError:F,downloadTemplate:b,closeProgressDialog:_,cancelImport:V,cancel:S}}};var N=a(66262);const U=(0,N.A)(P,[["render",W],["__scopeId","data-v-f6208e02"]]),A=U}}]);
//# sourceMappingURL=502.091f128b.js.map