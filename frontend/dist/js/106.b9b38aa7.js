"use strict";(self["webpackChunkvuln_management_frontend"]=self["webpackChunkvuln_management_frontend"]||[]).push([[106],{2478:(e,t,n)=>{var r=n(79504),a=n(48981),i=Math.floor,o=r("".charAt),s=r("".replace),l=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,r,d,v){var p=n+e.length,f=r.length,b=u;return void 0!==d&&(d=a(d),b=c),s(v,b,(function(a,s){var c;switch(o(s,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,n);case"'":return l(t,p);case"<":c=d[l(s,1,-1)];break;default:var u=+s;if(0===u)return a;if(u>f){var v=i(u/10);return 0===v?a:v<=f?void 0===r[v-1]?o(s,1):r[v-1]+o(s,1):a}c=r[u-1]}return void 0===c?"":c}))}},9868:(e,t,n)=>{var r=n(46518),a=n(79504),i=n(91291),o=n(31240),s=n(72333),l=n(79039),c=RangeError,u=String,d=Math.floor,v=a(s),p=a("".slice),f=a(1..toFixed),b=function(e,t,n){return 0===t?n:t%2===1?b(e,t-1,n*e):b(e*e,t/2,n)},g=function(e){var t=0,n=e;while(n>=4096)t+=12,n/=4096;while(n>=2)t+=1,n/=2;return t},h=function(e,t,n){var r=-1,a=n;while(++r<6)a+=t*e[r],e[r]=a%1e7,a=d(a/1e7)},m=function(e,t){var n=6,r=0;while(--n>=0)r+=e[n],e[n]=d(r/t),r=r%t*1e7},k=function(e){var t=6,n="";while(--t>=0)if(""!==n||0===t||0!==e[t]){var r=u(e[t]);n=""===n?r:n+v("0",7-r.length)+r}return n},y=l((function(){return"0.000"!==f(8e-5,3)||"1"!==f(.9,0)||"1.25"!==f(1.255,2)||"1000000000000000128"!==f(0xde0b6b3a7640080,0)}))||!l((function(){f({})}));r({target:"Number",proto:!0,forced:y},{toFixed:function(e){var t,n,r,a,s=o(this),l=i(e),d=[0,0,0,0,0,0],f="",y="0";if(l<0||l>20)throw new c("Incorrect fraction digits");if(s!==s)return"NaN";if(s<=-1e21||s>=1e21)return u(s);if(s<0&&(f="-",s=-s),s>1e-21)if(t=g(s*b(2,69,1))-69,n=t<0?s*b(2,-t,1):s/b(2,t,1),n*=4503599627370496,t=52-t,t>0){h(d,0,n),r=l;while(r>=7)h(d,1e7,0),r-=7;h(d,b(10,r,1),0),r=t-1;while(r>=23)m(d,1<<23),r-=23;m(d,1<<r),h(d,1,1),m(d,2),y=k(d)}else h(d,0,n),h(d,1<<-t,0),y=k(d)+v("0",l);return l>0?(a=y.length,y=f+(a<=l?"0."+v("0",l-a)+y:p(y,0,a-l)+"."+p(y,a-l))):y=f+y,y}})},20713:(e,t,n)=>{var r=n(69565),a=n(79306),i=n(28551),o=n(1767),s=n(19462),l=n(96319),c=s((function(){var e=this.iterator,t=i(r(this.next,e)),n=this.done=!!t.done;if(!n)return l(e,this.mapper,[t.value,this.counter++],!0)}));e.exports=function(e){return i(this),a(e),new c(o(this),{mapper:e})}},21699:(e,t,n)=>{var r=n(46518),a=n(79504),i=n(60511),o=n(67750),s=n(655),l=n(41436),c=a("".indexOf);r({target:"String",proto:!0,forced:!l("includes")},{includes:function(e){return!!~c(s(o(this)),s(i(e)),arguments.length>1?arguments[1]:void 0)}})},25440:(e,t,n)=>{var r=n(18745),a=n(69565),i=n(79504),o=n(89228),s=n(79039),l=n(28551),c=n(94901),u=n(64117),d=n(91291),v=n(18014),p=n(655),f=n(67750),b=n(57829),g=n(55966),h=n(2478),m=n(56682),k=n(78227),y=k("replace"),w=Math.max,A=Math.min,_=i([].concat),x=i([].push),L=i("".indexOf),F=i("".slice),V=function(e){return void 0===e?e:String(e)},I=function(){return"$0"==="a".replace(/./,"$0")}(),S=function(){return!!/./[y]&&""===/./[y]("a","$0")}(),C=!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));o("replace",(function(e,t,n){var i=S?"$":"$0";return[function(e,n){var r=f(this),i=u(e)?void 0:g(e,y);return i?a(i,e,r,n):a(t,p(r),e,n)},function(e,a){var o=l(this),s=p(e);if("string"==typeof a&&-1===L(a,i)&&-1===L(a,"$<")){var u=n(t,o,s,a);if(u.done)return u.value}var f=c(a);f||(a=p(a));var g,k=o.global;k&&(g=o.unicode,o.lastIndex=0);var y,I=[];while(1){if(y=m(o,s),null===y)break;if(x(I,y),!k)break;var S=p(y[0]);""===S&&(o.lastIndex=b(s,v(o.lastIndex),g))}for(var C="",T=0,D=0;D<I.length;D++){y=I[D];for(var W,E=p(y[0]),R=w(A(d(y.index),s.length),0),K=[],$=1;$<y.length;$++)x(K,V(y[$]));var N=y.groups;if(f){var j=_([E],K,R,s);void 0!==N&&x(j,N),W=p(r(a,void 0,j))}else W=h(E,s,R,K,N,a);R>=T&&(C+=F(s,T,R)+W,T=R+E.length)}return C+F(s,T)}]}),!C||!I||S)},32375:(e,t,n)=>{n.d(t,{A:()=>i});n(28706);var r=n(94335),a="http://server:8080";const i={getAssets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return console.log("获取资产列表:",{baseURL:r.A.defaults.baseURL,endpoint:"".concat(a,"/api/assets"),params:e}),r.A.get("".concat(a,"/api/assets"),{params:e})},getAssetById:function(e){return r.A.get("".concat(a,"/api/assets/").concat(e))},createAsset:function(e){return r.A.post("".concat(a,"/api/assets"),e)},updateAsset:function(e,t){return r.A.put("".concat(a,"/api/assets/").concat(e),t)},deleteAsset:function(e){return r.A["delete"]("".concat(a,"/api/assets/").concat(e))},getAssetVulnerabilities:function(e){return r.A.get("".concat(a,"/api/assets/").concat(e,"/vulnerabilities"))},addVulnerabilityToAsset:function(e,t){return console.log("添加漏洞到资产: ".concat(e,", 漏洞ID: ").concat(t)),r.A.post("".concat(a,"/api/assets/").concat(e,"/vulnerabilities"),{vulnerabilityId:t})},removeVulnerabilityFromAsset:function(e,t){return r.A["delete"]("".concat(a,"/api/assets/").concat(e,"/vulnerabilities/").concat(t))},addAssetNote:function(e,t){return r.A.post("".concat(a,"/api/assets/").concat(e,"/notes"),{content:t})},importAssets:function(e){return r.A.post("".concat(a,"/api/assets/import"),e,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4,onUploadProgress:function(e){console.log("上传进度:",Math.round(100*e.loaded/e.total)+"%")}})},downloadImportTemplate:function(){return r.A.get("".concat(a,"/api/assets/import-template"),{responseType:"blob"})}}},41436:(e,t,n)=>{var r=n(78227),a=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[a]=!1,"/./"[e](t)}catch(r){}}return!1}},48598:(e,t,n)=>{var r=n(46518),a=n(79504),i=n(47055),o=n(25397),s=n(34598),l=a([].join),c=i!==Object,u=c||!s("join",",");r({target:"Array",proto:!0,forced:u},{join:function(e){return l(o(this),void 0===e?",":e)}})},52703:(e,t,n)=>{var r=n(44576),a=n(79039),i=n(79504),o=n(655),s=n(43802).trim,l=n(47452),c=r.parseInt,u=r.Symbol,d=u&&u.iterator,v=/^[+-]?0x/i,p=i(v.exec),f=8!==c(l+"08")||22!==c(l+"0x16")||d&&!a((function(){c(Object(d))}));e.exports=f?function(e,t){var n=s(o(e));return c(n,t>>>0||(p(v,n)?16:10))}:c},57829:(e,t,n)=>{var r=n(68183).charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},58940:(e,t,n)=>{var r=n(46518),a=n(52703);r({global:!0,forced:parseInt!==a},{parseInt:a})},60511:(e,t,n)=>{var r=n(60788),a=TypeError;e.exports=function(e){if(r(e))throw new a("The method doesn't accept regular expressions");return e}},60788:(e,t,n)=>{var r=n(20034),a=n(22195),i=n(78227),o=i("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"===a(e))}},61701:(e,t,n)=>{var r=n(46518),a=n(20713),i=n(96395);r({target:"Iterator",proto:!0,real:!0,forced:i},{map:a})},62062:(e,t,n)=>{var r=n(46518),a=n(59213).map,i=n(70597),o=i("map");r({target:"Array",proto:!0,forced:!o},{map:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},64106:(e,t,n)=>{n.r(t),n.d(t,{default:()=>se});n(52675),n(89463),n(48598),n(62010),n(79432);var r=n(20641),a=n(90033),i=n(53751),o={class:"asset-detail"},s={class:"back-link"},l={key:0,class:"detail-header"},c={class:"header-left"},u={class:"asset-name"},d={class:"asset-meta"},v={class:"meta-date"},p={class:"asset-description"},f={class:"header-actions"},b={key:1,class:"detail-content"},g={class:"info-grid"},h={class:"info-item"},m={class:"info-value"},k={class:"info-item"},y={class:"info-value"},w={class:"info-item"},A={class:"info-value"},_={class:"info-item"},x={class:"info-value"},L={class:"info-item"},F={class:"info-value"},V={class:"info-item"},I={class:"info-value"},S={class:"info-item"},C={class:"info-value"},T={class:"info-item"},D={class:"info-value"},W={class:"info-item"},E={class:"info-value"},R={class:"tab-header"},K={class:"tab-title"},$={class:"tab-header"},N={key:1,class:"notes-list"},j={class:"note-content"},X={class:"note-footer"},B={class:"note-author"},M={class:"dialog-footer"},O={class:"dialog-footer"};function q(e,t,n,q,U,P){var z=(0,r.g2)("el-button"),Q=(0,r.g2)("el-tag"),Y=(0,r.g2)("el-card"),H=(0,r.g2)("el-table-column"),J=(0,r.g2)("el-table"),G=(0,r.g2)("el-tab-pane"),Z=(0,r.g2)("el-badge"),ee=(0,r.g2)("el-empty"),te=(0,r.g2)("router-link"),ne=(0,r.g2)("el-timeline-item"),re=(0,r.g2)("el-timeline"),ae=(0,r.g2)("el-tabs"),ie=(0,r.g2)("el-input"),oe=(0,r.g2)("el-form-item"),se=(0,r.g2)("el-form"),le=(0,r.g2)("el-dialog"),ce=(0,r.gN)("loading");return(0,r.bo)(((0,r.uX)(),(0,r.CE)("div",o,[(0,r.Lk)("div",s,[(0,r.bF)(z,{onClick:t[0]||(t[0]=function(t){return e.$router.back()}),icon:"el-icon-arrow-left",type:"text"},{default:(0,r.k6)((function(){return t[9]||(t[9]=[(0,r.eW)("返回资产列表")])})),_:1})]),q.asset?((0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("div",c,[(0,r.Lk)("h1",u,[t[10]||(t[10]=(0,r.Lk)("span",{class:"asset-icon"},[(0,r.Lk)("i",{class:"el-icon-office-building"})],-1)),(0,r.eW)(" "+(0,a.v_)(q.asset.name),1)]),(0,r.Lk)("div",d,[(0,r.bF)(Q,{type:q.getAssetTypeTag(q.asset.type),class:"meta-tag"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(q.getAssetTypeLabel(q.asset.type)),1)]})),_:1},8,["type"]),(0,r.bF)(Q,{type:q.getEnvironmentTag(q.asset.environment),class:"meta-tag"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(q.getEnvironmentLabel(q.asset.environment)),1)]})),_:1},8,["type"]),(0,r.Lk)("span",v,"创建于 "+(0,a.v_)(q.formatDate(q.asset.createdAt)),1)]),(0,r.Lk)("p",p,(0,a.v_)(q.asset.description),1)]),(0,r.Lk)("div",f,[(0,r.bF)(z,{type:"primary",onClick:q.goToEdit,class:"action-btn"},{default:(0,r.k6)((function(){return t[11]||(t[11]=[(0,r.Lk)("i",{class:"el-icon-edit"},null,-1),(0,r.eW)(" 编辑资产 ")])})),_:1},8,["onClick"]),(0,r.bF)(z,{type:"danger",onClick:q.confirmDelete,class:"action-btn"},{default:(0,r.k6)((function(){return t[12]||(t[12]=[(0,r.Lk)("i",{class:"el-icon-delete"},null,-1),(0,r.eW)(" 删除资产 ")])})),_:1},8,["onClick"])])])):(0,r.Q3)("",!0),q.asset?((0,r.uX)(),(0,r.CE)("div",b,[(0,r.bF)(ae,{modelValue:q.activeTab,"onUpdate:modelValue":t[2]||(t[2]=function(e){return q.activeTab=e}),type:"border-card"},{default:(0,r.k6)((function(){return[(0,r.bF)(G,{label:"基本信息",name:"info"},{default:(0,r.k6)((function(){return[(0,r.bF)(Y,{class:"info-card"},{default:(0,r.k6)((function(){return[(0,r.Lk)("div",g,[(0,r.Lk)("div",h,[t[13]||(t[13]=(0,r.Lk)("h3",{class:"info-label"},"ID",-1)),(0,r.Lk)("p",m,(0,a.v_)(q.asset.id),1)]),(0,r.Lk)("div",k,[t[14]||(t[14]=(0,r.Lk)("h3",{class:"info-label"},"IP地址",-1)),(0,r.Lk)("p",y,(0,a.v_)(q.asset.ipAddress||"未设置"),1)]),(0,r.Lk)("div",w,[t[15]||(t[15]=(0,r.Lk)("h3",{class:"info-label"},"域名",-1)),(0,r.Lk)("p",A,(0,a.v_)(q.asset.domain||"未设置"),1)]),(0,r.Lk)("div",_,[t[16]||(t[16]=(0,r.Lk)("h3",{class:"info-label"},"操作系统",-1)),(0,r.Lk)("p",x,(0,a.v_)(q.asset.operatingSystem||"未知"),1)]),(0,r.Lk)("div",L,[t[17]||(t[17]=(0,r.Lk)("h3",{class:"info-label"},"责任人",-1)),(0,r.Lk)("p",F,(0,a.v_)(q.asset.owner||"未指定"),1)]),(0,r.Lk)("div",V,[t[18]||(t[18]=(0,r.Lk)("h3",{class:"info-label"},"部门",-1)),(0,r.Lk)("p",I,(0,a.v_)(q.asset.department||"未指定"),1)]),(0,r.Lk)("div",S,[t[19]||(t[19]=(0,r.Lk)("h3",{class:"info-label"},"MAC地址",-1)),(0,r.Lk)("p",C,(0,a.v_)(q.asset.macAddress||"未设置"),1)]),(0,r.Lk)("div",T,[t[20]||(t[20]=(0,r.Lk)("h3",{class:"info-label"},"端口",-1)),(0,r.Lk)("p",D,(0,a.v_)(q.asset.ports?q.asset.ports.join(", "):"未扫描"),1)]),(0,r.Lk)("div",W,[t[21]||(t[21]=(0,r.Lk)("h3",{class:"info-label"},"最后更新",-1)),(0,r.Lk)("p",E,(0,a.v_)(q.formatDate(q.asset.updatedAt)),1)])])]})),_:1}),q.asset.attributes&&Object.keys(q.asset.attributes).length>0?((0,r.uX)(),(0,r.Wv)(Y,{key:0,class:"custom-attributes-card"},{header:(0,r.k6)((function(){return t[22]||(t[22]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("span",null,"自定义属性")],-1)])})),default:(0,r.k6)((function(){return[(0,r.bF)(J,{data:q.attributesArray,style:{width:"100%"}},{default:(0,r.k6)((function(){return[(0,r.bF)(H,{prop:"key",label:"属性名",width:"200"}),(0,r.bF)(H,{prop:"value",label:"值"})]})),_:1},8,["data"])]})),_:1})):(0,r.Q3)("",!0)]})),_:1}),(0,r.bF)(G,{label:"关联漏洞",name:"vulnerabilities"},{default:(0,r.k6)((function(){return[(0,r.Lk)("div",R,[(0,r.Lk)("h3",K,[t[23]||(t[23]=(0,r.eW)("关联漏洞 ")),(0,r.bF)(Z,{value:q.vulnerabilities.length,type:"danger"},null,8,["value"])]),(0,r.bF)(z,{type:"primary",size:"small",onClick:t[1]||(t[1]=function(e){return q.dialogVisible=!0})},{default:(0,r.k6)((function(){return t[24]||(t[24]=[(0,r.eW)("关联新漏洞")])})),_:1})]),0===q.vulnerabilities.length?((0,r.uX)(),(0,r.Wv)(ee,{key:0,description:"暂无关联漏洞"})):((0,r.uX)(),(0,r.Wv)(J,{key:1,data:q.vulnerabilities,style:{width:"100%"},border:""},{default:(0,r.k6)((function(){return[(0,r.bF)(H,{label:"ID",prop:"id",width:"80"}),(0,r.bF)(H,{label:"标题",prop:"title","min-width":"150"},{default:(0,r.k6)((function(e){return[(0,r.bF)(te,{to:{name:"VulnDetail",params:{id:e.row.id}},class:"vuln-link"},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(e.row.title),1)]})),_:2},1032,["to"])]})),_:1}),(0,r.bF)(H,{label:"CVE编号",prop:"cveId",width:"120"}),(0,r.bF)(H,{label:"严重程度",prop:"severity",width:"100"},{default:(0,r.k6)((function(e){return[(0,r.bF)(Q,{type:q.getSeverityTag(e.row.severity)},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(q.getSeverityLabel(e.row.severity)),1)]})),_:2},1032,["type"])]})),_:1}),(0,r.bF)(H,{label:"状态",prop:"status",width:"100"},{default:(0,r.k6)((function(e){return[(0,r.bF)(Q,{type:q.getStatusTag(e.row.status)},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(q.getStatusLabel(e.row.status)),1)]})),_:2},1032,["type"])]})),_:1}),(0,r.bF)(H,{label:"操作",width:"120"},{default:(0,r.k6)((function(e){return[(0,r.bF)(z,{size:"small",type:"danger",plain:"",onClick:function(t){return q.confirmRemoveVulnerability(e.row)}},{default:(0,r.k6)((function(){return t[25]||(t[25]=[(0,r.eW)(" 移除 ")])})),_:2},1032,["onClick"])]})),_:1})]})),_:1},8,["data"]))]})),_:1}),(0,r.bF)(G,{label:"备注",name:"notes"},{default:(0,r.k6)((function(){return[(0,r.Lk)("div",$,[t[27]||(t[27]=(0,r.Lk)("h3",{class:"tab-title"},"资产备注",-1)),(0,r.bF)(z,{type:"primary",size:"small",onClick:q.showAddNoteDialog},{default:(0,r.k6)((function(){return t[26]||(t[26]=[(0,r.eW)("添加备注")])})),_:1},8,["onClick"])]),q.asset.notes&&0!==q.asset.notes.length?((0,r.uX)(),(0,r.CE)("div",N,[(0,r.bF)(re,null,{default:(0,r.k6)((function(){return[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(q.asset.notes,(function(e,t){return(0,r.uX)(),(0,r.Wv)(ne,{key:t,timestamp:q.formatDate(e.createdAt),placement:"top",color:"#409EFF"},{default:(0,r.k6)((function(){return[(0,r.bF)(Y,{class:"note-card"},{default:(0,r.k6)((function(){return[(0,r.Lk)("div",j,(0,a.v_)(e.content),1),(0,r.Lk)("div",X,[(0,r.Lk)("span",B,"由 "+(0,a.v_)(e.createdBy.name||e.createdBy.username||"系统")+" 添加",1)])]})),_:2},1024)]})),_:2},1032,["timestamp"])})),128))]})),_:1})])):((0,r.uX)(),(0,r.Wv)(ee,{key:0,description:"暂无备注"}))]})),_:1})]})),_:1},8,["modelValue"])])):(0,r.Q3)("",!0),(0,r.bF)(le,{title:"关联漏洞",modelValue:q.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=function(e){return q.dialogVisible=e}),width:"600px"},{footer:(0,r.k6)((function(){return[(0,r.Lk)("span",M,[(0,r.bF)(z,{onClick:t[4]||(t[4]=function(e){return q.dialogVisible=!1})},{default:(0,r.k6)((function(){return t[28]||(t[28]=[(0,r.eW)("取消")])})),_:1}),(0,r.bF)(z,{type:"primary",onClick:q.addSelectedVulnerabilities,disabled:0===q.selectedVulnerabilities.length},{default:(0,r.k6)((function(){return[(0,r.eW)(" 关联 ("+(0,a.v_)(q.selectedVulnerabilities.length)+") ",1)]})),_:1},8,["onClick","disabled"])])]})),default:(0,r.k6)((function(){return[(0,r.bF)(se,{model:q.searchForm,"label-width":"80px"},{default:(0,r.k6)((function(){return[(0,r.bF)(oe,{label:"漏洞搜索"},{default:(0,r.k6)((function(){return[(0,r.bF)(ie,{modelValue:q.searchForm.searchTerm,"onUpdate:modelValue":t[3]||(t[3]=function(e){return q.searchForm.searchTerm=e}),placeholder:"输入漏洞名称、CVE编号或描述进行搜索",clearable:"",onKeyup:(0,i.jR)(q.searchVulnerabilities,["enter"])},{append:(0,r.k6)((function(){return[(0,r.bF)(z,{icon:"el-icon-search",onClick:q.searchVulnerabilities},null,8,["onClick"])]})),_:1},8,["modelValue","onKeyup"])]})),_:1})]})),_:1},8,["model"]),(0,r.bo)(((0,r.uX)(),(0,r.Wv)(J,{data:q.searchResults,style:{width:"100%"},height:"300",onRowClick:q.handleVulnerabilitySelect},{default:(0,r.k6)((function(){return[(0,r.bF)(H,{type:"selection",width:"55",selectable:q.isSelectable},null,8,["selectable"]),(0,r.bF)(H,{label:"标题",prop:"title","min-width":"150"}),(0,r.bF)(H,{label:"CVE编号",prop:"cveId",width:"120"}),(0,r.bF)(H,{label:"严重程度",prop:"severity",width:"100"},{default:(0,r.k6)((function(e){return[(0,r.bF)(Q,{type:q.getSeverityTag(e.row.severity)},{default:(0,r.k6)((function(){return[(0,r.eW)((0,a.v_)(q.getSeverityLabel(e.row.severity)),1)]})),_:2},1032,["type"])]})),_:1})]})),_:1},8,["data","onRowClick"])),[[ce,q.searchLoading]])]})),_:1},8,["modelValue"]),(0,r.bF)(le,{title:"添加备注",modelValue:q.noteDialogVisible,"onUpdate:modelValue":t[8]||(t[8]=function(e){return q.noteDialogVisible=e}),width:"500px"},{footer:(0,r.k6)((function(){return[(0,r.Lk)("span",O,[(0,r.bF)(z,{onClick:t[7]||(t[7]=function(e){return q.noteDialogVisible=!1})},{default:(0,r.k6)((function(){return t[29]||(t[29]=[(0,r.eW)("取消")])})),_:1}),(0,r.bF)(z,{type:"primary",onClick:q.addAssetNote,disabled:!q.noteForm.content},{default:(0,r.k6)((function(){return t[30]||(t[30]=[(0,r.eW)("添加")])})),_:1},8,["onClick","disabled"])])]})),default:(0,r.k6)((function(){return[(0,r.bF)(se,{model:q.noteForm,"label-width":"80px"},{default:(0,r.k6)((function(){return[(0,r.bF)(oe,{label:"备注内容",required:""},{default:(0,r.k6)((function(){return[(0,r.bF)(ie,{modelValue:q.noteForm.content,"onUpdate:modelValue":t[6]||(t[6]=function(e){return q.noteForm.content=e}),type:"textarea",rows:4,placeholder:"请输入备注内容"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["modelValue"])])),[[ce,q.loading]])}var U=n(54119),P=n(78676),z=n(14048),Q=n(30388),Y=(n(16280),n(76918),n(2008),n(48980),n(62062),n(44114),n(15086),n(54554),n(60739),n(18111),n(22489),n(61701),n(13579),n(33110),n(5506),n(26099),n(47764),n(42762),n(62953),n(50953)),H=n(75220),J=n(20163),G=n(77918),Z=n(32375),ee=(n(28706),n(74423),n(58940),n(21699),n(94335)),te="http://server:8080";const ne={getVulnerabilities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ee.A.get("".concat(te,"/api/vulnerabilities"),{params:e})},getVulnerabilityById:function(e){return ee.A.get("".concat(te,"/api/vulnerabilities/").concat(e))},createVulnerability:function(e){return ee.A.post("".concat(te,"/api/vulnerabilities"),e)},updateVulnerability:function(e,t){return ee.A.put("".concat(te,"/api/vulnerabilities/").concat(e),t)},deleteVulnerability:function(e){return ee.A["delete"]("".concat(te,"/api/vulnerabilities/").concat(e))},importVulnerabilities:function(e){return ee.A.post("".concat(te,"/api/vulnerabilities/import"),e)},importFromVulnDatabase:function(e){return ee.A.post("".concat(te,"/api/vulnerabilities/import-from-vulndb"),{vulnerability:e})},searchVulnerabilities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("搜索漏洞库原始参数:",e);var t={};e.searchTerm?t.keyword=e.searchTerm:t.keyword=e.keyword||"",e.limit?t.pageSize=parseInt(e.limit):t.pageSize=e.pageSize||e.perPage||10,t.cveId=e.cveId||"",t.severity=e.severity||"",t.vendor=e.vendor||"",t.product=e.product||"",t.year=e.year||"",t.page=e.page||1,t.sortBy=e.sortBy||"publishedDate",t.sortOrder=e.sortOrder||"desc",console.log("处理后的请求参数:",t);var n="/api/vulndatabase";return console.log("使用API端点:",n),ee.A.get(n,{params:t,headers:{"Content-Type":"application/json",Accept:"application/json"}})},getMockVulnerabilities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";console.log("使用模拟数据替代后端API, 关键词:",e);var t=[{cveId:"CVE-2023-1234",title:"SQL注入漏洞 (模拟数据)",description:"这是一个模拟的SQL注入漏洞，用于测试",severity:"high",cvss:8.5,vendor:"测试厂商",product:"测试产品"},{cveId:"CVE-2023-5678",title:"跨站脚本漏洞 (模拟数据)",description:"这是一个模拟的XSS漏洞，用于测试",severity:"medium",cvss:6.5,vendor:"测试厂商",product:"测试产品"},{cveId:"CVE-2023-9012",title:"命令注入漏洞 (模拟数据)",description:"这是一个模拟的命令注入漏洞，用于测试",severity:"critical",cvss:9.5,vendor:"测试厂商",product:"测试产品"}],n=e?t.filter((function(t){return t.title.toLowerCase().includes(e.toLowerCase())||t.cveId.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase())})):t;return Promise.resolve({data:{items:n,total:n.length}})}};var re=n(78870);const ae={name:"AssetDetail",setup:function(){var e=(0,H.lq)(),t=(0,H.rd)(),n=(0,Y.KR)(!1),a=(0,Y.KR)(null),i=(0,Y.KR)("info"),o=(0,Y.KR)([]),s=(0,Y.KR)(!1),l=(0,Y.Kh)({searchTerm:""}),c=(0,Y.KR)(!1),u=(0,Y.KR)([]),d=(0,Y.KR)([]),v=(0,Y.KR)(!1),p=(0,Y.Kh)({content:""}),f=function(){var t=(0,Q.A)((0,z.A)().mark((function t(){var r,i;return(0,z.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.params.id,r){t.next=3;break}return t.abrupt("return");case 3:return n.value=!0,t.prev=4,t.next=7,Z.A.getAssetById(r);case 7:return i=t.sent,a.value=i.data,t.next=11,b();case 11:t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](4),console.error("获取资产详情失败:",t.t0),J.nk.error("获取资产详情失败，请重试");case 17:return t.prev=17,n.value=!1,t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[4,13,17,20]])})));return function(){return t.apply(this,arguments)}}(),b=function(){var t=(0,Q.A)((0,z.A)().mark((function t(){var n;return(0,z.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Z.A.getAssetVulnerabilities(e.params.id);case 3:n=t.sent,o.value=n.data.vulnerabilities||[],t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("获取关联漏洞失败:",t.t0),J.nk.error("获取关联漏洞失败，请重试");case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),g=function(){t.push({name:"AssetEdit",params:{id:a.value.id}})},h=function(){G.s.confirm('确定要删除资产 "'.concat(a.value.name,'" 吗？此操作不可恢复。'),"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){m()}))["catch"]((function(){}))},m=function(){var e=(0,Q.A)((0,z.A)().mark((function e(){return(0,z.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.A.deleteAsset(a.value.id);case 3:J.nk.success("资产已成功删除"),t.push({name:"AssetList"}),e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),console.error("删除资产失败:",e.t0),J.nk.error("删除资产失败，请重试");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),k=function(e){G.s.confirm('确定要移除漏洞 "'.concat(e.title,'" 与该资产的关联吗？'),"确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){y(e.id)}))["catch"]((function(){}))},y=function(){var t=(0,Q.A)((0,z.A)().mark((function t(n){return(0,z.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Z.A.removeVulnerabilityFromAsset(e.params.id,n);case 3:return J.nk.success("已移除漏洞关联"),t.next=6,b();case 6:t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error("移除漏洞关联失败:",t.t0),J.nk.error("移除漏洞关联失败，请重试");case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}(),w=function(){var e=(0,Q.A)((0,z.A)().mark((function e(){var t,n,r,a,i;return(0,z.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l.searchTerm&&""!==l.searchTerm.trim()){e.next=3;break}return J.nk.warning("请输入搜索内容"),e.abrupt("return");case 3:return c.value=!0,e.prev=4,t={searchTerm:l.searchTerm,limit:50},console.log("开始搜索漏洞，原始请求参数:",t),e.next=9,ne.searchVulnerabilities(t);case 9:n=e.sent,console.log("搜索漏洞响应:",n.data),u.value=n.data.items||n.data.vulnerabilities||[],u.value=u.value.filter((function(e){var t=e.id||e._id||e.cveId;return!o.value.some((function(n){return n.id===t||n.cveId&&n.cveId===e.cveId}))})),0===u.value.length&&J.nk.info("没有找到匹配的漏洞或所有匹配漏洞已关联"),e.next=24;break;case 16:e.prev=16,e.t0=e["catch"](4),console.error("搜索漏洞失败详情:",e.t0),console.error("请求配置:",e.t0.config),console.error("响应状态:",null===(r=e.t0.response)||void 0===r?void 0:r.status),console.error("响应数据:",null===(a=e.t0.response)||void 0===a?void 0:a.data),e.t0.request&&console.error("请求信息:",e.t0.request),J.nk.error("搜索漏洞失败: ".concat((null===(i=e.t0.response)||void 0===i||null===(i=i.data)||void 0===i?void 0:i.message)||e.t0.message||"请重试"));case 24:return e.prev=24,c.value=!1,e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[4,16,24,27]])})));return function(){return e.apply(this,arguments)}}(),A=function(e){var t=e.id||e._id||e.cveId,n=d.value.findIndex((function(n){return n.id===t||n.cveId&&n.cveId===e.cveId}));-1===n?d.value.push(e):d.value.splice(n,1)},_=function(e){var t=e.id||e._id||e.cveId;return!o.value.some((function(n){return n.id===t||n.cveId&&n.cveId===e.cveId}))},x=function(){var t=(0,Q.A)((0,z.A)().mark((function t(){var n,r;return(0,z.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==d.value.length){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,n=d.value.map(function(){var t=(0,Q.A)((0,z.A)().mark((function t(n){var r,a,i,o,s,l;return(0,z.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,r=n.id||n._id,r||!n.cveId){t.next=31;break}return console.log("导入漏洞库中的漏洞:",n),a={title:n.title,description:n.description||"",cve:n.cveId,cvss:n.cvss||0,severity:n.severity||"medium",remediation:n.remediation||n.solution||"",references:n.references||[],tags:n.tags||[]},console.log("准备导入漏洞数据:",a),t.next=8,ne.importFromVulnDatabase(a);case 8:if(i=t.sent,console.log("漏洞导入响应:",i.data),o=i.data.id||i.data.vulnerabilityId||i.data._id,!o){t.next=27;break}return console.log("新漏洞ID:",o,"准备关联到资产:",e.params.id),t.prev=13,t.next=16,Z.A.addVulnerabilityToAsset(e.params.id,o);case 16:return s=t.sent,console.log("漏洞关联响应:",s),t.abrupt("return",s);case 21:throw t.prev=21,t.t0=t["catch"](13),console.error("关联新导入漏洞时出错:",t.t0.response||t.t0),t.t0;case 25:t.next=29;break;case 27:throw console.error("导入响应中找不到漏洞ID:",i.data),new Error("导入漏洞失败：未返回有效的漏洞ID");case 29:t.next=44;break;case 31:return console.log("关联已有漏洞:",r,"到资产:",e.params.id),t.prev=32,t.next=35,Z.A.addVulnerabilityToAsset(e.params.id,r);case 35:return l=t.sent,console.log("漏洞关联响应:",l),t.abrupt("return",l);case 40:throw t.prev=40,t.t1=t["catch"](32),console.error("关联已有漏洞时出错:",t.t1.response||t.t1),t.t1;case 44:t.next=50;break;case 46:throw t.prev=46,t.t2=t["catch"](0),console.error("处理单个漏洞时出错:",t.t2.response||t.t2),t.t2;case 50:case"end":return t.stop()}}),t,null,[[0,46],[13,21],[32,40]])})));return function(e){return t.apply(this,arguments)}}()),t.next=6,Promise.all(n);case 6:return J.nk.success("漏洞关联成功"),s.value=!1,d.value=[],u.value=[],l.searchTerm="",t.next=13,b();case 13:t.next=20;break;case 15:t.prev=15,t.t0=t["catch"](2),console.error("关联漏洞失败详情:",t.t0),t.t0.response&&(console.error("响应状态:",t.t0.response.status),console.error("响应数据:",t.t0.response.data),console.error("请求配置:",t.t0.config),t.t0.request&&console.error("请求信息:",t.t0.request)),J.nk.error("关联漏洞失败: ".concat((null===(r=t.t0.response)||void 0===r||null===(r=r.data)||void 0===r?void 0:r.message)||t.t0.message||"服务器内部错误，请检查后端日志"));case 20:case"end":return t.stop()}}),t,null,[[2,15]])})));return function(){return t.apply(this,arguments)}}(),L=function(){p.content="",v.value=!0},F=function(){var t=(0,Q.A)((0,z.A)().mark((function t(){return(0,z.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(p.content&&""!==p.content.trim()){t.next=3;break}return J.nk.warning("请输入备注内容"),t.abrupt("return");case 3:return t.prev=3,t.next=6,Z.A.addAssetNote(e.params.id,p.content);case 6:return J.nk.success("备注添加成功"),v.value=!1,t.next=10,f();case 10:t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](3),console.error("添加备注失败:",t.t0),J.nk.error("添加备注失败，请重试");case 16:case"end":return t.stop()}}),t,null,[[3,12]])})));return function(){return t.apply(this,arguments)}}(),V=(0,r.EW)((function(){return a.value&&a.value.attributes?Object.entries(a.value.attributes).map((function(e){var t=(0,P.A)(e,2),n=t[0],r=t[1];return{key:n,value:"object"===(0,U.A)(r)?JSON.stringify(r):r}})):[]})),I=function(e){var t={server:"服务器",network_device:"网络设备",application:"应用程序",database:"数据库",cloud_resource:"云资源",iot_device:"物联网设备",other:"其他"};return t[e]||e},S=function(e){var t={server:"primary",network_device:"success",application:"warning",database:"danger",cloud_resource:"info",iot_device:"",other:"info"};return t[e]||"info"},C=function(e){var t={production:"生产",testing:"测试",development:"开发",staging:"预生产"};return t[e]||e},T=function(e){var t={production:"danger",testing:"warning",development:"success",staging:"info"};return t[e]||"info"},D=function(e){var t={critical:"严重",high:"高危",medium:"中危",low:"低危",info:"信息"};return t[e]||e},W=function(e){var t={critical:"danger",high:"warning",medium:"",low:"success",info:"info"};return t[e]||"info"},E=function(e){var t={open:"开放",in_progress:"处理中",resolved:"已解决",closed:"已关闭",false_positive:"误报"};return t[e]||e},R=function(e){var t={open:"danger",in_progress:"warning",resolved:"success",closed:"info",false_positive:""};return t[e]||"info"};return(0,r.sV)((function(){f()})),{loading:n,asset:a,activeTab:i,vulnerabilities:o,dialogVisible:s,searchForm:l,searchLoading:c,searchResults:u,selectedVulnerabilities:d,noteDialogVisible:v,noteForm:p,attributesArray:V,formatDate:re.Yq,fetchAssetDetails:f,goToEdit:g,confirmDelete:h,confirmRemoveVulnerability:k,searchVulnerabilities:w,handleVulnerabilitySelect:A,isSelectable:_,addSelectedVulnerabilities:x,showAddNoteDialog:L,addAssetNote:F,getAssetTypeLabel:I,getAssetTypeTag:S,getEnvironmentLabel:C,getEnvironmentTag:T,getSeverityLabel:D,getSeverityTag:W,getStatusLabel:E,getStatusTag:R}}};var ie=n(66262);const oe=(0,ie.A)(ae,[["render",q],["__scopeId","data-v-52667e9c"]]),se=oe},68156:(e,t,n)=>{var r=n(46518),a=n(60533).start,i=n(83063);r({target:"String",proto:!0,forced:i},{padStart:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},74423:(e,t,n)=>{var r=n(46518),a=n(19617).includes,i=n(79039),o=n(6469),s=i((function(){return!Array(1).includes()}));r({target:"Array",proto:!0,forced:s},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},78870:(e,t,n)=>{n.d(t,{Yq:()=>r});n(76918),n(28706),n(23288),n(9868),n(26099),n(27495),n(38781),n(68156),n(25440);function r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";var n=new Date(e);if(isNaN(n.getTime()))return"";var r=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0");if(!t)return"".concat(r,"-").concat(a,"-").concat(i);var o=String(n.getHours()).padStart(2,"0"),s=String(n.getMinutes()).padStart(2,"0"),l=String(n.getSeconds()).padStart(2,"0");return"".concat(r,"-").concat(a,"-").concat(i," ").concat(o,":").concat(s,":").concat(l)}},83063:(e,t,n)=>{var r=n(82839);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)}}]);
//# sourceMappingURL=106.b9b38aa7.js.map