"use strict";(self["webpackChunkvuln_management_frontend"]=self["webpackChunkvuln_management_frontend"]||[]).push([[22],{21699:(e,t,n)=>{var l=n(46518),a=n(79504),r=n(60511),u=n(67750),i=n(655),o=n(41436),s=a("".indexOf);l({target:"String",proto:!0,forced:!o("includes")},{includes:function(e){return!!~s(i(u(this)),i(r(e)),arguments.length>1?arguments[1]:void 0)}})},25276:(e,t,n)=>{var l=n(46518),a=n(27476),r=n(19617).indexOf,u=n(34598),i=a([].indexOf),o=!!i&&1/i([1],1,-0)<0,s=o||!u("indexOf");l({target:"Array",proto:!0,forced:s},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return o?i(this,e,t)||0:r(this,e,t)}})},41436:(e,t,n)=>{var l=n(78227),a=l("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[a]=!1,"/./"[e](t)}catch(l){}}return!1}},60511:(e,t,n)=>{var l=n(60788),a=TypeError;e.exports=function(e){if(l(e))throw new a("The method doesn't accept regular expressions");return e}},60788:(e,t,n)=>{var l=n(20034),a=n(22195),r=n(78227),u=r("match");e.exports=function(e){var t;return l(e)&&(void 0!==(t=e[u])?!!t:"RegExp"===a(e))}},74423:(e,t,n)=>{var l=n(46518),a=n(19617).includes,r=n(79039),u=n(6469),i=r((function(){return!Array(1).includes()}));l({target:"Array",proto:!0,forced:i},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),u("includes")},86022:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});n(52675),n(89463),n(62010);var l=n(20641),a=n(90033),r=n(53751),u={class:"vulnerability-create-page"},i={class:"page-header"},o={class:"header-content"},s={class:"header-back"},c={class:"form-card"},d={class:"section-card"},p={class:"section-card"},f={key:0,class:"empty-preview"},m=["innerHTML"],b={key:0,class:"empty-preview"},v=["innerHTML"],k={key:0,class:"empty-preview"},g=["innerHTML"],F={key:0,class:"empty-preview"},y=["innerHTML"],_={class:"section-card"},h={class:"form-actions"},V={class:"dialog-footer"};function L(e,t,n,L,w,C){var x=(0,l.g2)("el-button"),T=(0,l.g2)("el-input"),R=(0,l.g2)("el-form-item"),U=(0,l.g2)("el-col"),A=(0,l.g2)("el-row"),W=(0,l.g2)("el-option"),E=(0,l.g2)("el-select"),K=(0,l.g2)("el-input-number"),X=(0,l.g2)("el-tab-pane"),I=(0,l.g2)("el-tabs"),M=(0,l.g2)("el-tag"),D=(0,l.g2)("el-form"),H=(0,l.g2)("el-dialog"),S=(0,l.gN)("loading");return(0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("div",i,[(0,l.Lk)("div",o,[(0,l.Lk)("div",s,[(0,l.bF)(x,{onClick:L.goBack,icon:"el-icon-arrow-left",type:"text",class:"back-button"},{default:(0,l.k6)((function(){return t[20]||(t[20]=[(0,l.eW)(" 返回列表 ")])})),_:1},8,["onClick"])]),t[21]||(t[21]=(0,l.Fv)('<h1 class="page-title" data-v-e13ebf2c><span class="title-icon" data-v-e13ebf2c><i class="el-icon-plus" data-v-e13ebf2c></i></span> 创建新漏洞 <span class="title-highlight" data-v-e13ebf2c>记录</span></h1><p class="page-subtitle" data-v-e13ebf2c>添加新发现的安全漏洞，记录详细信息以便团队跟进处理</p>',2))])]),(0,l.Lk)("div",c,[(0,l.bo)(((0,l.uX)(),(0,l.Wv)(D,{ref:"formRef",model:L.vulnerabilityForm,rules:L.rules,"label-position":"top"},{default:(0,l.k6)((function(){return[(0,l.Lk)("div",d,[t[27]||(t[27]=(0,l.Lk)("div",{class:"section-header"},[(0,l.Lk)("h2",{class:"section-title"},[(0,l.Lk)("i",{class:"el-icon-info section-icon"}),(0,l.eW)(" 基本信息 ")]),(0,l.Lk)("span",{class:"section-subtitle"},"漏洞的基本描述和分类信息")],-1)),(0,l.bF)(A,{gutter:24},{default:(0,l.k6)((function(){return[(0,l.bF)(U,{xs:24,sm:24,md:24},{default:(0,l.k6)((function(){return[(0,l.bF)(R,{label:"漏洞标题",prop:"title"},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.vulnerabilityForm.title,"onUpdate:modelValue":t[0]||(t[0]=function(e){return L.vulnerabilityForm.title=e}),placeholder:"输入漏洞标题，简洁且能清晰表明漏洞类型"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,l.bF)(A,{gutter:24},{default:(0,l.k6)((function(){return[(0,l.bF)(U,{xs:24,sm:12,md:8},{default:(0,l.k6)((function(){return[(0,l.bF)(R,{label:"CVE编号",prop:"cve"},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.vulnerabilityForm.cve,"onUpdate:modelValue":t[1]||(t[1]=function(e){return L.vulnerabilityForm.cve=e}),placeholder:"例如: CVE-2023-12345（如有）",clearable:""},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,l.bF)(U,{xs:24,sm:12,md:8},{default:(0,l.k6)((function(){return[(0,l.bF)(R,{label:"严重程度",prop:"severity"},{default:(0,l.k6)((function(){return[(0,l.bF)(E,{modelValue:L.vulnerabilityForm.severity,"onUpdate:modelValue":t[2]||(t[2]=function(e){return L.vulnerabilityForm.severity=e}),placeholder:"选择漏洞严重程度",style:{width:"100%"}},{default:(0,l.k6)((function(){return[(0,l.bF)(W,{label:"严重",value:"critical"},{default:(0,l.k6)((function(){return t[22]||(t[22]=[(0,l.Lk)("div",{class:"severity-option"},[(0,l.Lk)("span",{class:"severity-dot critical"}),(0,l.Lk)("span",null,"严重")],-1)])})),_:1}),(0,l.bF)(W,{label:"高危",value:"high"},{default:(0,l.k6)((function(){return t[23]||(t[23]=[(0,l.Lk)("div",{class:"severity-option"},[(0,l.Lk)("span",{class:"severity-dot high"}),(0,l.Lk)("span",null,"高危")],-1)])})),_:1}),(0,l.bF)(W,{label:"中危",value:"medium"},{default:(0,l.k6)((function(){return t[24]||(t[24]=[(0,l.Lk)("div",{class:"severity-option"},[(0,l.Lk)("span",{class:"severity-dot medium"}),(0,l.Lk)("span",null,"中危")],-1)])})),_:1}),(0,l.bF)(W,{label:"低危",value:"low"},{default:(0,l.k6)((function(){return t[25]||(t[25]=[(0,l.Lk)("div",{class:"severity-option"},[(0,l.Lk)("span",{class:"severity-dot low"}),(0,l.Lk)("span",null,"低危")],-1)])})),_:1}),(0,l.bF)(W,{label:"信息",value:"info"},{default:(0,l.k6)((function(){return t[26]||(t[26]=[(0,l.Lk)("div",{class:"severity-option"},[(0,l.Lk)("span",{class:"severity-dot info"}),(0,l.Lk)("span",null,"信息")],-1)])})),_:1})]})),_:1},8,["modelValue"])]})),_:1})]})),_:1}),(0,l.bF)(U,{xs:24,sm:12,md:8},{default:(0,l.k6)((function(){return[(0,l.bF)(R,{label:"状态",prop:"status"},{default:(0,l.k6)((function(){return[(0,l.bF)(E,{modelValue:L.vulnerabilityForm.status,"onUpdate:modelValue":t[3]||(t[3]=function(e){return L.vulnerabilityForm.status=e}),placeholder:"选择漏洞状态",style:{width:"100%"}},{default:(0,l.k6)((function(){return[(0,l.bF)(W,{label:"开放",value:"open"}),(0,l.bF)(W,{label:"处理中",value:"in_progress"}),(0,l.bF)(W,{label:"已解决",value:"resolved"}),(0,l.bF)(W,{label:"已关闭",value:"closed"}),(0,l.bF)(W,{label:"误报",value:"false_positive"})]})),_:1},8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,l.bF)(A,{gutter:24},{default:(0,l.k6)((function(){return[(0,l.bF)(U,{xs:24,sm:12,md:8},{default:(0,l.k6)((function(){return[(0,l.bF)(R,{label:"发现日期",prop:"discoveredAt"},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.vulnerabilityForm.discoveredAt,"onUpdate:modelValue":t[4]||(t[4]=function(e){return L.vulnerabilityForm.discoveredAt=e}),placeholder:"YYYY-MM-DD 格式，例如：2023-01-15",style:{width:"100%"},clearable:""},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,l.bF)(U,{xs:24,sm:12,md:8},{default:(0,l.k6)((function(){return[(0,l.bF)(R,{label:"CVSS评分",prop:"cvss"},{default:(0,l.k6)((function(){return[(0,l.bF)(K,{modelValue:L.vulnerabilityForm.cvss,"onUpdate:modelValue":t[5]||(t[5]=function(e){return L.vulnerabilityForm.cvss=e}),min:0,max:10,precision:1,step:.1,style:{width:"100%"}},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,l.bF)(U,{xs:24,sm:12,md:8},{default:(0,l.k6)((function(){return[(0,l.bF)(R,{label:"CVSS向量",prop:"cvss_vector"},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.vulnerabilityForm.cvss_vector,"onUpdate:modelValue":t[6]||(t[6]=function(e){return L.vulnerabilityForm.cvss_vector=e}),placeholder:"例如: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",clearable:""},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1})]),(0,l.Lk)("div",p,[t[28]||(t[28]=(0,l.Lk)("div",{class:"section-header"},[(0,l.Lk)("h2",{class:"section-title"},[(0,l.Lk)("i",{class:"el-icon-document section-icon"}),(0,l.eW)(" 详细描述 ")]),(0,l.Lk)("span",{class:"section-subtitle"},"漏洞的详细描述和分析")],-1)),(0,l.bF)(R,{label:"漏洞描述",prop:"description"},{default:(0,l.k6)((function(){return[(0,l.bF)(I,{modelValue:L.descriptionTab,"onUpdate:modelValue":t[8]||(t[8]=function(e){return L.descriptionTab=e})},{default:(0,l.k6)((function(){return[(0,l.bF)(X,{label:"编辑",name:"edit"},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.vulnerabilityForm.description,"onUpdate:modelValue":t[7]||(t[7]=function(e){return L.vulnerabilityForm.description=e}),type:"textarea",rows:8,placeholder:"详细描述漏洞的情况、原理等信息（支持Markdown格式）"},null,8,["modelValue"])]})),_:1}),(0,l.bF)(X,{label:"预览",name:"preview"},{default:(0,l.k6)((function(){return[L.vulnerabilityForm.description?((0,l.uX)(),(0,l.CE)("div",{key:1,class:"markdown-preview",innerHTML:L.renderedDescription},null,8,m)):((0,l.uX)(),(0,l.CE)("div",f," 暂无内容预览 "))]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,l.bF)(R,{label:"影响分析",prop:"impact"},{default:(0,l.k6)((function(){return[(0,l.bF)(I,{modelValue:L.impactTab,"onUpdate:modelValue":t[10]||(t[10]=function(e){return L.impactTab=e})},{default:(0,l.k6)((function(){return[(0,l.bF)(X,{label:"编辑",name:"edit"},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.vulnerabilityForm.impact,"onUpdate:modelValue":t[9]||(t[9]=function(e){return L.vulnerabilityForm.impact=e}),type:"textarea",rows:6,placeholder:"描述漏洞可能造成的安全影响和危害（支持Markdown格式）"},null,8,["modelValue"])]})),_:1}),(0,l.bF)(X,{label:"预览",name:"preview"},{default:(0,l.k6)((function(){return[L.vulnerabilityForm.impact?((0,l.uX)(),(0,l.CE)("div",{key:1,class:"markdown-preview",innerHTML:L.renderedImpact},null,8,v)):((0,l.uX)(),(0,l.CE)("div",b," 暂无内容预览 "))]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,l.bF)(R,{label:"复现步骤",prop:"steps_to_reproduce"},{default:(0,l.k6)((function(){return[(0,l.bF)(I,{modelValue:L.stepsTab,"onUpdate:modelValue":t[12]||(t[12]=function(e){return L.stepsTab=e})},{default:(0,l.k6)((function(){return[(0,l.bF)(X,{label:"编辑",name:"edit"},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.vulnerabilityForm.steps_to_reproduce,"onUpdate:modelValue":t[11]||(t[11]=function(e){return L.vulnerabilityForm.steps_to_reproduce=e}),type:"textarea",rows:6,placeholder:"详细列出漏洞的复现步骤，便于其他人理解和验证（支持Markdown格式）"},null,8,["modelValue"])]})),_:1}),(0,l.bF)(X,{label:"预览",name:"preview"},{default:(0,l.k6)((function(){return[L.vulnerabilityForm.steps_to_reproduce?((0,l.uX)(),(0,l.CE)("div",{key:1,class:"markdown-preview",innerHTML:L.renderedSteps},null,8,g)):((0,l.uX)(),(0,l.CE)("div",k," 暂无内容预览 "))]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,l.bF)(R,{label:"修复建议",prop:"recommendation"},{default:(0,l.k6)((function(){return[(0,l.bF)(I,{modelValue:L.recommendationTab,"onUpdate:modelValue":t[14]||(t[14]=function(e){return L.recommendationTab=e})},{default:(0,l.k6)((function(){return[(0,l.bF)(X,{label:"编辑",name:"edit"},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.vulnerabilityForm.recommendation,"onUpdate:modelValue":t[13]||(t[13]=function(e){return L.vulnerabilityForm.recommendation=e}),type:"textarea",rows:6,placeholder:"提供修复或缓解该漏洞的方法和建议（支持Markdown格式）"},null,8,["modelValue"])]})),_:1}),(0,l.bF)(X,{label:"预览",name:"preview"},{default:(0,l.k6)((function(){return[L.vulnerabilityForm.recommendation?((0,l.uX)(),(0,l.CE)("div",{key:1,class:"markdown-preview",innerHTML:L.renderedRecommendation},null,8,y)):((0,l.uX)(),(0,l.CE)("div",F," 暂无内容预览 "))]})),_:1})]})),_:1},8,["modelValue"])]})),_:1})]),(0,l.Lk)("div",_,[t[31]||(t[31]=(0,l.Lk)("div",{class:"section-header"},[(0,l.Lk)("h2",{class:"section-title"},[(0,l.Lk)("i",{class:"el-icon-info section-icon"}),(0,l.eW)(" 额外信息 ")]),(0,l.Lk)("span",{class:"section-subtitle"},"受影响资产和参考链接")],-1)),(0,l.bF)(R,{label:"受影响资产",prop:"affected_assets"},{default:(0,l.k6)((function(){return[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(L.vulnerabilityForm.affected_assets,(function(e,t){return(0,l.uX)(),(0,l.Wv)(M,{key:t,closable:"","disable-transitions":!1,onClose:function(t){return L.handleRemoveAsset(e)},class:"tag-item"},{default:(0,l.k6)((function(){return[(0,l.eW)((0,a.v_)(e.name),1)]})),_:2},1032,["onClose"])})),128)),(0,l.bF)(x,{type:"text",onClick:L.showAssetDialog,class:"add-tag-button"},{default:(0,l.k6)((function(){return t[29]||(t[29]=[(0,l.Lk)("i",{class:"el-icon-plus"},null,-1),(0,l.eW)(" 添加资产 ")])})),_:1},8,["onClick"])]})),_:1}),(0,l.bF)(R,{label:"参考链接",prop:"references"},{default:(0,l.k6)((function(){return[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(L.vulnerabilityForm.references,(function(e,t){return(0,l.uX)(),(0,l.CE)("div",{key:t,class:"reference-item"},[(0,l.bF)(T,{modelValue:e.title,"onUpdate:modelValue":function(t){return e.title=t},placeholder:"参考标题",class:"reference-title-input"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.bF)(T,{modelValue:e.url,"onUpdate:modelValue":function(t){return e.url=t},placeholder:"参考链接URL",class:"reference-url-input"},null,8,["modelValue","onUpdate:modelValue"]),(0,l.bF)(x,{type:"danger",icon:"el-icon-delete",circle:"",size:"mini",onClick:function(e){return L.removeReference(t)}},null,8,["onClick"])])})),128)),(0,l.bF)(x,{type:"text",onClick:L.addReference,class:"add-reference-button"},{default:(0,l.k6)((function(){return t[30]||(t[30]=[(0,l.Lk)("i",{class:"el-icon-plus"},null,-1),(0,l.eW)(" 添加参考链接 ")])})),_:1},8,["onClick"])]})),_:1})]),(0,l.bF)(R,{label:"标签",prop:"tags"},{default:(0,l.k6)((function(){return[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(L.vulnerabilityForm.tags,(function(e){return(0,l.uX)(),(0,l.Wv)(M,{key:e,closable:"","disable-transitions":!1,onClose:function(t){return L.handleRemoveTag(e)},class:"tag-item"},{default:(0,l.k6)((function(){return[(0,l.eW)((0,a.v_)(e),1)]})),_:2},1032,["onClose"])})),128)),L.inputTagVisible?((0,l.uX)(),(0,l.Wv)(T,{key:0,ref:"tagInputRef",modelValue:L.inputTagValue,"onUpdate:modelValue":t[15]||(t[15]=function(e){return L.inputTagValue=e}),class:"tag-input",size:"small",onKeyup:(0,r.jR)(L.handleInputTagConfirm,["enter"]),onBlur:L.handleInputTagConfirm},null,8,["modelValue","onKeyup","onBlur"])):((0,l.uX)(),(0,l.Wv)(x,{key:1,type:"text",onClick:L.showTagInput,class:"add-tag-button"},{default:(0,l.k6)((function(){return t[32]||(t[32]=[(0,l.Lk)("i",{class:"el-icon-plus"},null,-1),(0,l.eW)(" 添加标签 ")])})),_:1},8,["onClick"]))]})),_:1}),(0,l.Lk)("div",h,[(0,l.bF)(x,{onClick:L.goBack,class:"cancel-btn"},{default:(0,l.k6)((function(){return t[33]||(t[33]=[(0,l.eW)("取消")])})),_:1},8,["onClick"]),(0,l.bF)(x,{type:"primary",onClick:L.submitForm,loading:L.submitting,class:"submit-btn"},{default:(0,l.k6)((function(){return t[34]||(t[34]=[(0,l.Lk)("i",{class:"el-icon-check"},null,-1),(0,l.eW)(" 保存漏洞 ")])})),_:1},8,["onClick","loading"])])]})),_:1},8,["model","rules"])),[[S,L.loading]])]),(0,l.bF)(H,{title:"添加受影响资产",modelValue:L.assetDialogVisible,"onUpdate:modelValue":t[19]||(t[19]=function(e){return L.assetDialogVisible=e}),width:"500px"},{footer:(0,l.k6)((function(){return[(0,l.Lk)("span",V,[(0,l.bF)(x,{onClick:t[18]||(t[18]=function(e){return L.assetDialogVisible=!1})},{default:(0,l.k6)((function(){return t[35]||(t[35]=[(0,l.eW)("取消")])})),_:1}),(0,l.bF)(x,{type:"primary",onClick:L.handleAddAsset},{default:(0,l.k6)((function(){return t[36]||(t[36]=[(0,l.eW)("添加")])})),_:1},8,["onClick"])])]})),default:(0,l.k6)((function(){return[(0,l.bF)(D,{model:L.assetForm,"label-position":"top"},{default:(0,l.k6)((function(){return[(0,l.bF)(R,{label:"资产名称",required:""},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.assetForm.name,"onUpdate:modelValue":t[16]||(t[16]=function(e){return L.assetForm.name=e}),placeholder:"输入资产名称"},null,8,["modelValue"])]})),_:1}),(0,l.bF)(R,{label:"资产详情"},{default:(0,l.k6)((function(){return[(0,l.bF)(T,{modelValue:L.assetForm.details,"onUpdate:modelValue":t[17]||(t[17]=function(e){return L.assetForm.details=e}),type:"textarea",rows:3,placeholder:"对资产的详细描述，如版本、位置等"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["modelValue"])])}var w=n(14048),C=n(29201),x=n(30388),T=(n(48980),n(74423),n(25276),n(44114),n(54554),n(21699),n(42762),n(50953)),R=n(66278),U=n(75220),A=n(77918),W=n(20163);const E={name:"VulnerabilityCreate",setup:function(){var e=(0,R.Pj)(),t=(0,U.rd)(),n=(0,T.KR)(null),a=(0,T.KR)(!1),r=(0,T.KR)(!1),u=(0,T.KR)("edit"),i=(0,T.KR)("edit"),o=(0,T.KR)("edit"),s=(0,T.KR)("edit"),c=(0,T.KR)(null),d=(0,T.KR)(!1),p=(0,T.KR)(""),f=(0,T.KR)(!1),m=(0,T.Kh)({name:"",details:""}),b=(0,T.Kh)({title:"",description:"",impact:"",steps_to_reproduce:"",recommendation:"",severity:"medium",status:"open",cve:"",cvss:0,cvss_vector:"",discoveredAt:"",affected_assets:[],references:[],tags:[]}),v={title:[{required:!0,message:"请输入漏洞标题",trigger:"blur"},{min:3,max:200,message:"长度在 3 到 200 个字符",trigger:"blur"}],description:[{required:!0,message:"请输入漏洞描述",trigger:"blur"}],severity:[{required:!0,message:"请选择严重程度",trigger:"change"}],status:[{required:!0,message:"请选择漏洞状态",trigger:"change"}],discoveredAt:[{required:!0,message:"请输入发现日期",trigger:"blur"},{pattern:/^\d{4}-\d{2}-\d{2}$/,message:"日期格式必须为 YYYY-MM-DD",trigger:"blur"}]},k=(0,l.EW)((function(){return b.description?"<p>".concat(b.description,"</p>"):""})),g=(0,l.EW)((function(){return b.impact?"<p>".concat(b.impact,"</p>"):""})),F=(0,l.EW)((function(){return b.steps_to_reproduce?"<p>".concat(b.steps_to_reproduce,"</p>"):""})),y=(0,l.EW)((function(){return b.recommendation?"<p>".concat(b.recommendation,"</p>"):""})),_=function(){h()?A.s.confirm("表单内容已修改，确定要离开吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.push("/vulnerabilities")}))["catch"]((function(){})):t.push("/vulnerabilities")},h=function(){return b.title||b.description||b.impact||b.steps_to_reproduce||b.recommendation||0!==b.cvss||b.cve||b.cvss_vector||b.affected_assets.length>0||b.references.length>0||b.tags.length>0},V=function(){var l=(0,x.A)((0,w.A)().mark((function l(){var a;return(0,w.A)().wrap((function(l){while(1)switch(l.prev=l.next){case 0:if(n.value){l.next=2;break}return l.abrupt("return");case 2:return l.prev=2,l.next=5,n.value.validate();case 5:return r.value=!0,a=(0,C.A)({},b),l.prev=7,l.next=10,e.dispatch("vulnerability/createVulnerability",a);case 10:e.dispatch("dashboard/fetchDashboardData"),(0,W.nk)({type:"success",message:"漏洞创建成功"}),t.push("/vulnerabilities"),l.next=18;break;case 15:l.prev=15,l.t0=l["catch"](7),(0,W.nk)({type:"error",message:"创建漏洞失败: "+(l.t0.message||"未知错误")});case 18:return l.prev=18,r.value=!1,l.finish(18);case 21:l.next=26;break;case 23:l.prev=23,l.t1=l["catch"](2),(0,W.nk)({type:"warning",message:"请完善表单信息"});case 26:case"end":return l.stop()}}),l,null,[[2,23],[7,15,18,21]])})));return function(){return l.apply(this,arguments)}}(),L=function(){d.value=!0,(0,l.dY)((function(){var e;null===(e=c.value)||void 0===e||e.focus()}))},E=function(){var e=p.value.trim();e&&!b.tags.includes(e)&&b.tags.push(e),d.value=!1,p.value=""},K=function(e){b.tags.splice(b.tags.indexOf(e),1)},X=function(){m.name="",m.details="",f.value=!0},I=function(){m.name.trim()?(b.affected_assets.push({name:m.name.trim(),details:m.details.trim()}),f.value=!1):(0,W.nk)({type:"warning",message:"请输入资产名称"})},M=function(e){var t=b.affected_assets.findIndex((function(t){return t.name===e.name}));-1!==t&&b.affected_assets.splice(t,1)},D=function(){b.references.push({title:"",url:""})},H=function(e){b.references.splice(e,1)};return{formRef:n,loading:a,submitting:r,vulnerabilityForm:b,rules:v,descriptionTab:u,impactTab:i,stepsTab:o,recommendationTab:s,inputTagVisible:d,inputTagValue:p,tagInputRef:c,assetDialogVisible:f,assetForm:m,renderedDescription:k,renderedImpact:g,renderedSteps:F,renderedRecommendation:y,goBack:_,submitForm:V,showTagInput:L,handleInputTagConfirm:E,handleRemoveTag:K,showAssetDialog:X,handleAddAsset:I,handleRemoveAsset:M,addReference:D,removeReference:H}}};var K=n(66262);const X=(0,K.A)(E,[["render",L],["__scopeId","data-v-e13ebf2c"]]),I=X}}]);
//# sourceMappingURL=22.67cbe528.js.map