{"ast":null,"code":"import _regeneratorRuntime from \"/Users/yue/Desktop/vuln-Management/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/yue/Desktop/vuln-Management/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { computed, onMounted, ref } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRoute, useRouter } from 'vue-router';\nimport { ElMessageBox, ElMessage } from 'element-plus';\nexport default {\n  name: 'VulnerabilityDetails',\n  setup: function setup() {\n    var store = useStore();\n    var route = useRoute();\n    var router = useRouter();\n    var loading = ref(true);\n    var vulnerability = computed(function () {\n      return store.getters['vulnerability/currentVulnerability'] || {};\n    });\n    var canEdit = computed(function () {\n      return store.getters['auth/isAuthenticated'];\n    });\n\n    // CVSS相关计算\n    var cvssScoreClass = computed(function () {\n      var score = vulnerability.value.cvss;\n      if (!score) return '';\n      if (score >= 9.0) return 'critical';\n      if (score >= 7.0) return 'high';\n      if (score >= 4.0) return 'medium';\n      return 'low';\n    });\n    var cvssScoreText = computed(function () {\n      var score = vulnerability.value.cvss;\n      if (!score) return '未评分';\n      if (score >= 9.0) return '严重';\n      if (score >= 7.0) return '高危';\n      if (score >= 4.0) return '中危';\n      if (score > 0) return '低危';\n      return '未评分';\n    });\n\n    // 简化的内容渲染，不使用marked和dompurify\n    var renderedDescription = computed(function () {\n      return vulnerability.value.description ? \"<p>\".concat(vulnerability.value.description, \"</p>\") : '<p>暂无描述</p>';\n    });\n    var renderedImpact = computed(function () {\n      return vulnerability.value.impact ? \"<p>\".concat(vulnerability.value.impact, \"</p>\") : '';\n    });\n    var renderedStepsToReproduce = computed(function () {\n      return vulnerability.value.steps_to_reproduce ? \"<p>\".concat(vulnerability.value.steps_to_reproduce, \"</p>\") : '';\n    });\n    var renderedRecommendation = computed(function () {\n      return vulnerability.value.recommendation ? \"<p>\".concat(vulnerability.value.recommendation, \"</p>\") : '';\n    });\n\n    // 获取漏洞详情\n    var fetchVulnerabilityDetails = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              loading.value = true;\n              _context.prev = 1;\n              _context.next = 4;\n              return store.dispatch('vulnerability/fetchVulnerabilityById', route.params.id);\n            case 4:\n              _context.next = 9;\n              break;\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](1);\n              ElMessage.error('获取漏洞详情失败: ' + (_context.t0.message || '未知错误'));\n            case 9:\n              _context.prev = 9;\n              loading.value = false;\n              return _context.finish(9);\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[1, 6, 9, 12]]);\n      }));\n      return function fetchVulnerabilityDetails() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    // 返回列表\n    var goBack = function goBack() {\n      router.push('/vulnerabilities');\n    };\n\n    // 编辑漏洞\n    var handleEdit = function handleEdit() {\n      router.push(\"/vulnerabilities/\".concat(vulnerability.value.id, \"/edit\"));\n    };\n\n    // 处理下拉菜单命令\n    var handleCommand = function handleCommand(command) {\n      if (command === 'delete') {\n        confirmDelete();\n      } else {\n        updateStatus(command);\n      }\n    };\n\n    // 确认删除\n    var confirmDelete = function confirmDelete() {\n      ElMessageBox.confirm(\"\\u786E\\u5B9A\\u8981\\u5220\\u9664\\u6F0F\\u6D1E \\\"\".concat(vulnerability.value.title, \"\\\" \\u5417\\uFF1F\"), '警告', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        deleteVulnerability();\n      })[\"catch\"](function () {\n        ElMessage({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    };\n\n    // 删除漏洞\n    var deleteVulnerability = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return store.dispatch('vulnerability/deleteVulnerability', vulnerability.value.id);\n            case 3:\n              // 刷新仪表盘数据\n              store.dispatch('dashboard/fetchDashboardData');\n              ElMessage({\n                type: 'success',\n                message: '漏洞已成功删除'\n              });\n\n              // 返回列表页\n              router.push('/vulnerabilities');\n              _context2.next = 11;\n              break;\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n              ElMessage({\n                type: 'error',\n                message: '删除失败: ' + (_context2.t0.message || '未知错误')\n              });\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 8]]);\n      }));\n      return function deleteVulnerability() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    // 更新漏洞状态\n    var updateStatus = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(status) {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return store.dispatch('vulnerability/updateVulnerability', {\n                id: vulnerability.value.id,\n                data: {\n                  status: status\n                }\n              });\n            case 3:\n              ElMessage({\n                type: 'success',\n                message: '漏洞状态已更新'\n              });\n              fetchVulnerabilityDetails();\n              _context3.next = 10;\n              break;\n            case 7:\n              _context3.prev = 7;\n              _context3.t0 = _context3[\"catch\"](0);\n              ElMessage({\n                type: 'error',\n                message: '更新状态失败: ' + (_context3.t0.message || '未知错误')\n              });\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, null, [[0, 7]]);\n      }));\n      return function updateStatus(_x) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    // 历史记录项类型\n    var historyItemType = function historyItemType(action) {\n      switch (action) {\n        case 'create':\n          return 'success';\n        case 'update':\n          return 'warning';\n        case 'delete':\n          return 'danger';\n        case 'status_change':\n          return 'primary';\n        default:\n          return 'info';\n      }\n    };\n\n    // 历史记录操作文本\n    var historyActionText = function historyActionText(history) {\n      switch (history.action) {\n        case 'create':\n          return '创建漏洞';\n        case 'update':\n          return '更新漏洞信息';\n        case 'delete':\n          return '删除漏洞';\n        case 'status_change':\n          return \"\\u72B6\\u6001\\u53D8\\u66F4\\u4E3A \".concat(history.details || '未知状态');\n        default:\n          return history.action || '未知操作';\n      }\n    };\n    onMounted(function () {\n      fetchVulnerabilityDetails();\n    });\n    return {\n      loading: loading,\n      vulnerability: vulnerability,\n      canEdit: canEdit,\n      cvssScoreClass: cvssScoreClass,\n      cvssScoreText: cvssScoreText,\n      renderedDescription: renderedDescription,\n      renderedImpact: renderedImpact,\n      renderedStepsToReproduce: renderedStepsToReproduce,\n      renderedRecommendation: renderedRecommendation,\n      goBack: goBack,\n      handleEdit: handleEdit,\n      handleCommand: handleCommand,\n      confirmDelete: confirmDelete,\n      historyItemType: historyItemType,\n      historyActionText: historyActionText\n    };\n  }\n};","map":{"version":3,"names":["computed","onMounted","ref","useStore","useRoute","useRouter","ElMessageBox","ElMessage","name","setup","store","route","router","loading","vulnerability","getters","canEdit","cvssScoreClass","score","value","cvss","cvssScoreText","renderedDescription","description","concat","renderedImpact","impact","renderedStepsToReproduce","steps_to_reproduce","renderedRecommendation","recommendation","fetchVulnerabilityDetails","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","dispatch","params","id","t0","error","message","finish","stop","apply","arguments","goBack","push","handleEdit","handleCommand","command","confirmDelete","updateStatus","confirm","title","confirmButtonText","cancelButtonText","type","then","deleteVulnerability","_ref2","_callee2","_callee2$","_context2","_ref3","_callee3","status","_callee3$","_context3","data","_x","historyItemType","action","historyActionText","history","details"],"sources":["/Users/yue/Desktop/vuln-Management/frontend/src/views/vulnerabilities/VulnerabilityDetails.vue"],"sourcesContent":["<template>\n  <div class=\"vulnerability-details-page\">\n    <div class=\"page-header\">\n      <div class=\"header-back\">\n        <el-button @click=\"goBack\" icon=\"el-icon-arrow-left\" type=\"text\">\n          返回列表\n        </el-button>\n      </div>\n      <div class=\"header-actions\">\n        <el-button @click=\"handleEdit\" type=\"primary\" plain :disabled=\"!canEdit\">\n          编辑\n        </el-button>\n        <el-dropdown @command=\"handleCommand\" trigger=\"click\">\n          <el-button>\n            操作\n            <i class=\"el-icon-arrow-down el-icon--right\"></i>\n          </el-button>\n          <template #dropdown>\n            <el-dropdown-menu>\n              <el-dropdown-item command=\"open\" :disabled=\"vulnerability.status === 'open'\">\n                标记为开放\n              </el-dropdown-item>\n              <el-dropdown-item command=\"in_progress\" :disabled=\"vulnerability.status === 'in_progress'\">\n                标记为处理中\n              </el-dropdown-item>\n              <el-dropdown-item command=\"resolved\" :disabled=\"vulnerability.status === 'resolved'\">\n                标记为已解决\n              </el-dropdown-item>\n              <el-dropdown-item command=\"false_positive\" :disabled=\"vulnerability.status === 'false_positive'\">\n                标记为误报\n              </el-dropdown-item>\n              <el-dropdown-item command=\"closed\" :disabled=\"vulnerability.status === 'closed'\">\n                标记为已关闭\n              </el-dropdown-item>\n              <el-dropdown-item divided command=\"delete\" type=\"danger\">\n                <span style=\"color: #F56C6C;\">删除漏洞</span>\n              </el-dropdown-item>\n            </el-dropdown-menu>\n          </template>\n        </el-dropdown>\n      </div>\n    </div>\n\n    <div v-loading=\"loading\">\n      <!-- 漏洞不存在的错误信息 -->\n      <el-empty \n        v-if=\"!loading && !vulnerability.id\" \n        description=\"未找到漏洞信息\" \n      >\n        <el-button type=\"primary\" @click=\"goBack\">返回列表</el-button>\n      </el-empty>\n\n      <!-- 漏洞详情内容 -->\n      <template v-if=\"vulnerability.id\">\n        <div class=\"vuln-header\">\n          <div class=\"vuln-title-section\">\n            <h1 class=\"vuln-title\">{{ vulnerability.title }}</h1>\n            <div class=\"vuln-meta\">\n              <el-tag \n                class=\"vuln-severity\" \n                :type=\"$filters.severityClass(vulnerability.severity)\"\n              >\n                {{ $filters.severityText(vulnerability.severity) }}\n              </el-tag>\n              <el-tag \n                class=\"vuln-status\" \n                :type=\"$filters.statusClass(vulnerability.status)\"\n              >\n                {{ $filters.statusText(vulnerability.status) }}\n              </el-tag>\n              <span class=\"vuln-id\">ID: {{ vulnerability.id }}</span>\n              <span v-if=\"vulnerability.cve\" class=\"vuln-cve\">\n                CVE: {{ vulnerability.cve }}\n              </span>\n            </div>\n          </div>\n          \n          <div class=\"vuln-dates\">\n            <div class=\"date-item\">\n              <div class=\"date-label\">发现时间</div>\n              <div class=\"date-value\">{{ $filters.formatDate(vulnerability.discoveredAt) }}</div>\n            </div>\n            <div class=\"date-item\">\n              <div class=\"date-label\">上次更新</div>\n              <div class=\"date-value\">{{ $filters.formatDate(vulnerability.updatedAt) }}</div>\n            </div>\n          </div>\n        </div>\n\n        <!-- 漏洞详情卡片布局 -->\n        <div class=\"details-grid\">\n          <!-- 主要信息卡片 -->\n          <el-card class=\"details-card main-info-card\">\n            <template #header>\n              <div class=\"card-header\">\n                <h3>漏洞详情</h3>\n              </div>\n            </template>\n            \n            <div class=\"card-section\">\n              <h4 class=\"section-title\">描述</h4>\n              <div class=\"section-content markdown-body\" v-html=\"renderedDescription\"></div>\n            </div>\n\n            <div class=\"card-section\" v-if=\"vulnerability.impact\">\n              <h4 class=\"section-title\">影响</h4>\n              <div class=\"section-content markdown-body\" v-html=\"renderedImpact\"></div>\n            </div>\n\n            <div class=\"card-section\" v-if=\"vulnerability.steps_to_reproduce\">\n              <h4 class=\"section-title\">复现步骤</h4>\n              <div class=\"section-content markdown-body\" v-html=\"renderedStepsToReproduce\"></div>\n            </div>\n\n            <div class=\"card-section\" v-if=\"vulnerability.recommendation\">\n              <h4 class=\"section-title\">修复建议</h4>\n              <div class=\"section-content markdown-body\" v-html=\"renderedRecommendation\"></div>\n            </div>\n          </el-card>\n\n          <!-- 右侧信息卡片 -->\n          <div class=\"side-cards\">\n            <!-- 风险评分卡片 -->\n            <el-card class=\"details-card risk-score-card\">\n              <template #header>\n                <div class=\"card-header\">\n                  <h3>风险评分</h3>\n                </div>\n              </template>\n              \n              <div class=\"cvss-score\">\n                <div class=\"score-circle\" :class=\"cvssScoreClass\">\n                  <span class=\"score-value\">{{ vulnerability.cvss?.toFixed(1) || 'N/A' }}</span>\n                </div>\n                <div class=\"score-text\">\n                  <div class=\"score-level\">{{ cvssScoreText }}</div>\n                  <div class=\"score-label\">CVSS 评分</div>\n                </div>\n              </div>\n              \n              <div class=\"cvss-vector\" v-if=\"vulnerability.cvss_vector\">\n                <div class=\"vector-label\">CVSS 向量:</div>\n                <div class=\"vector-value\">{{ vulnerability.cvss_vector }}</div>\n              </div>\n            </el-card>\n\n            <!-- 受影响资产卡片 -->\n            <el-card class=\"details-card assets-card\" v-if=\"vulnerability.affected_assets && vulnerability.affected_assets.length\">\n              <template #header>\n                <div class=\"card-header\">\n                  <h3>受影响资产</h3>\n                </div>\n              </template>\n              \n              <ul class=\"assets-list\">\n                <li v-for=\"(asset, index) in vulnerability.affected_assets\" :key=\"index\" class=\"asset-item\">\n                  <div class=\"asset-name\">{{ asset.name || '未命名资产' }}</div>\n                  <div class=\"asset-details\" v-if=\"asset.details\">{{ asset.details }}</div>\n                </li>\n              </ul>\n            </el-card>\n            \n            <!-- 漏洞参考信息卡片 -->\n            <el-card class=\"details-card references-card\" v-if=\"vulnerability.references && vulnerability.references.length\">\n              <template #header>\n                <div class=\"card-header\">\n                  <h3>参考信息</h3>\n                </div>\n              </template>\n              \n              <ul class=\"references-list\">\n                <li v-for=\"(reference, index) in vulnerability.references\" :key=\"index\" class=\"reference-item\">\n                  <a :href=\"reference.url\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    {{ reference.title || reference.url }}\n                  </a>\n                </li>\n              </ul>\n            </el-card>\n            \n            <!-- 相关标签卡片 -->\n            <el-card class=\"details-card tags-card\" v-if=\"vulnerability.tags && vulnerability.tags.length\">\n              <template #header>\n                <div class=\"card-header\">\n                  <h3>标签</h3>\n                </div>\n              </template>\n              \n              <div class=\"tags-container\">\n                <el-tag \n                  v-for=\"tag in vulnerability.tags\" \n                  :key=\"tag\" \n                  class=\"tag-item\"\n                  size=\"medium\"\n                >\n                  {{ tag }}\n                </el-tag>\n              </div>\n            </el-card>\n          </div>\n        </div>\n        \n        <!-- 漏洞历史记录 -->\n        <el-card class=\"details-card history-card\" v-if=\"vulnerability.history && vulnerability.history.length\">\n          <template #header>\n            <div class=\"card-header\">\n              <h3>历史记录</h3>\n            </div>\n          </template>\n          \n          <el-timeline>\n            <el-timeline-item\n              v-for=\"(history, index) in vulnerability.history\"\n              :key=\"index\"\n              :timestamp=\"$filters.formatDateTime(history.timestamp)\"\n              :type=\"historyItemType(history.action)\"\n            >\n              <div class=\"history-item\">\n                <span class=\"history-action\">{{ historyActionText(history) }}</span>\n                <span class=\"history-user\" v-if=\"history.user\">\n                  由 <strong>{{ history.user.name || history.user.username }}</strong> 操作\n                </span>\n              </div>\n              <div class=\"history-details\" v-if=\"history.details\">\n                {{ history.details }}\n              </div>\n            </el-timeline-item>\n          </el-timeline>\n        </el-card>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { computed, onMounted, ref } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRoute, useRouter } from 'vue-router'\nimport { ElMessageBox, ElMessage } from 'element-plus'\n\nexport default {\n  name: 'VulnerabilityDetails',\n  \n  setup() {\n    const store = useStore()\n    const route = useRoute()\n    const router = useRouter()\n    \n    const loading = ref(true)\n    const vulnerability = computed(() => store.getters['vulnerability/currentVulnerability'] || {})\n    const canEdit = computed(() => store.getters['auth/isAuthenticated'])\n    \n    // CVSS相关计算\n    const cvssScoreClass = computed(() => {\n      const score = vulnerability.value.cvss\n      if (!score) return ''\n      \n      if (score >= 9.0) return 'critical'\n      if (score >= 7.0) return 'high'\n      if (score >= 4.0) return 'medium'\n      return 'low'\n    })\n    \n    const cvssScoreText = computed(() => {\n      const score = vulnerability.value.cvss\n      if (!score) return '未评分'\n      \n      if (score >= 9.0) return '严重'\n      if (score >= 7.0) return '高危'\n      if (score >= 4.0) return '中危'\n      if (score > 0) return '低危'\n      return '未评分'\n    })\n    \n    // 简化的内容渲染，不使用marked和dompurify\n    const renderedDescription = computed(() => {\n      return vulnerability.value.description \n        ? `<p>${vulnerability.value.description}</p>`\n        : '<p>暂无描述</p>'\n    })\n    \n    const renderedImpact = computed(() => {\n      return vulnerability.value.impact \n        ? `<p>${vulnerability.value.impact}</p>`\n        : ''\n    })\n    \n    const renderedStepsToReproduce = computed(() => {\n      return vulnerability.value.steps_to_reproduce \n        ? `<p>${vulnerability.value.steps_to_reproduce}</p>`\n        : ''\n    })\n    \n    const renderedRecommendation = computed(() => {\n      return vulnerability.value.recommendation \n        ? `<p>${vulnerability.value.recommendation}</p>`\n        : ''\n    })\n    \n    // 获取漏洞详情\n    const fetchVulnerabilityDetails = async () => {\n      loading.value = true\n      try {\n        await store.dispatch('vulnerability/fetchVulnerabilityById', route.params.id)\n      } catch (error) {\n        ElMessage.error('获取漏洞详情失败: ' + (error.message || '未知错误'))\n      } finally {\n        loading.value = false\n      }\n    }\n    \n    // 返回列表\n    const goBack = () => {\n      router.push('/vulnerabilities')\n    }\n    \n    // 编辑漏洞\n    const handleEdit = () => {\n      router.push(`/vulnerabilities/${vulnerability.value.id}/edit`)\n    }\n    \n    // 处理下拉菜单命令\n    const handleCommand = (command) => {\n      if (command === 'delete') {\n        confirmDelete()\n      } else {\n        updateStatus(command)\n      }\n    }\n    \n    // 确认删除\n    const confirmDelete = () => {\n      ElMessageBox.confirm(\n        `确定要删除漏洞 \"${vulnerability.value.title}\" 吗？`,\n        '警告',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }\n      ).then(() => {\n        deleteVulnerability()\n      }).catch(() => {\n        ElMessage({\n          type: 'info',\n          message: '已取消删除'\n        })\n      })\n    }\n    \n    // 删除漏洞\n    const deleteVulnerability = async () => {\n      try {\n        await store.dispatch('vulnerability/deleteVulnerability', vulnerability.value.id)\n        \n        // 刷新仪表盘数据\n        store.dispatch('dashboard/fetchDashboardData')\n        \n        ElMessage({\n          type: 'success',\n          message: '漏洞已成功删除'\n        })\n        \n        // 返回列表页\n        router.push('/vulnerabilities')\n      } catch (error) {\n        ElMessage({\n          type: 'error',\n          message: '删除失败: ' + (error.message || '未知错误')\n        })\n      }\n    }\n    \n    // 更新漏洞状态\n    const updateStatus = async (status) => {\n      try {\n        await store.dispatch('vulnerability/updateVulnerability', {\n          id: vulnerability.value.id,\n          data: { status }\n        })\n        ElMessage({\n          type: 'success',\n          message: '漏洞状态已更新'\n        })\n        fetchVulnerabilityDetails()\n      } catch (error) {\n        ElMessage({\n          type: 'error',\n          message: '更新状态失败: ' + (error.message || '未知错误')\n        })\n      }\n    }\n    \n    // 历史记录项类型\n    const historyItemType = (action) => {\n      switch (action) {\n        case 'create':\n          return 'success'\n        case 'update':\n          return 'warning'\n        case 'delete':\n          return 'danger'\n        case 'status_change':\n          return 'primary'\n        default:\n          return 'info'\n      }\n    }\n    \n    // 历史记录操作文本\n    const historyActionText = (history) => {\n      switch (history.action) {\n        case 'create':\n          return '创建漏洞'\n        case 'update':\n          return '更新漏洞信息'\n        case 'delete':\n          return '删除漏洞'\n        case 'status_change':\n          return `状态变更为 ${history.details || '未知状态'}`\n        default:\n          return history.action || '未知操作'\n      }\n    }\n    \n    onMounted(() => {\n      fetchVulnerabilityDetails()\n    })\n    \n    return {\n      loading,\n      vulnerability,\n      canEdit,\n      cvssScoreClass,\n      cvssScoreText,\n      renderedDescription,\n      renderedImpact,\n      renderedStepsToReproduce,\n      renderedRecommendation,\n      goBack,\n      handleEdit,\n      handleCommand,\n      confirmDelete,\n      historyItemType,\n      historyActionText\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.vulnerability-details-page {\n  margin-bottom: 40px;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n}\n\n.header-actions {\n  display: flex;\n  gap: 12px;\n}\n\n.vuln-header {\n  margin-bottom: 24px;\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  gap: 20px;\n}\n\n.vuln-title-section {\n  flex: 1;\n  min-width: 300px;\n}\n\n.vuln-title {\n  font-size: 24px;\n  font-weight: 600;\n  margin: 0 0 12px 0;\n  color: #2c3e50;\n}\n\n.vuln-meta {\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 12px;\n}\n\n.vuln-id, .vuln-cve {\n  color: #606266;\n  font-size: 14px;\n}\n\n.vuln-dates {\n  display: flex;\n  gap: 24px;\n}\n\n.date-item {\n  text-align: right;\n}\n\n.date-label {\n  color: #909399;\n  font-size: 13px;\n  margin-bottom: 4px;\n}\n\n.date-value {\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.details-grid {\n  display: grid;\n  grid-template-columns: 3fr 1fr;\n  gap: 24px;\n  margin-bottom: 24px;\n}\n\n.details-card {\n  margin-bottom: 24px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.05);\n}\n\n.card-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  \n  h3 {\n    margin: 0;\n    font-weight: 600;\n    font-size: 18px;\n    color: #303133;\n  }\n}\n\n.card-section {\n  margin-bottom: 24px;\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n}\n\n.section-title {\n  font-size: 16px;\n  font-weight: 600;\n  color: #303133;\n  margin: 0 0 12px 0;\n  padding-bottom: 8px;\n  border-bottom: 1px solid #EBEEF5;\n}\n\n.section-content {\n  color: #606266;\n  line-height: 1.6;\n}\n\n.main-info-card {\n  grid-column: 1;\n}\n\n.side-cards {\n  grid-column: 2;\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n}\n\n.risk-score-card {\n  margin-bottom: 0;\n}\n\n.cvss-score {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  margin-bottom: 16px;\n}\n\n.score-circle {\n  width: 80px;\n  height: 80px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 24px;\n  font-weight: 700;\n  color: #fff;\n  \n  &.critical {\n    background-color: #F56C6C;\n  }\n  \n  &.high {\n    background-color: #E6A23C;\n  }\n  \n  &.medium {\n    background-color: #E6A23C;\n  }\n  \n  &.low {\n    background-color: #67C23A;\n  }\n}\n\n.score-text {\n  display: flex;\n  flex-direction: column;\n}\n\n.score-level {\n  font-size: 18px;\n  font-weight: 600;\n}\n\n.score-label {\n  font-size: 14px;\n  color: #909399;\n}\n\n.cvss-vector {\n  padding: 12px;\n  background-color: #F5F7FA;\n  border-radius: 4px;\n  font-family: monospace;\n  font-size: 14px;\n  line-height: 1.5;\n  word-break: break-all;\n}\n\n.assets-list, .references-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n\n.asset-item, .reference-item {\n  padding: 12px 0;\n  border-bottom: 1px solid #EBEEF5;\n  \n  &:last-child {\n    border-bottom: none;\n  }\n}\n\n.asset-name {\n  font-weight: 500;\n  margin-bottom: 4px;\n}\n\n.asset-details {\n  font-size: 14px;\n  color: #606266;\n}\n\n.tags-container {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n\n.history-card {\n  grid-column: 1 / -1;\n}\n\n.history-item {\n  margin-bottom: 8px;\n}\n\n.history-action {\n  font-weight: 500;\n}\n\n.history-user {\n  font-size: 14px;\n  color: #606266;\n  margin-left: 8px;\n}\n\n.history-details {\n  font-size: 14px;\n  color: #606266;\n  background-color: #F5F7FA;\n  padding: 8px 12px;\n  border-radius: 4px;\n  margin-top: 8px;\n}\n\n// 为Markdown内容添加样式\n:deep(.markdown-body) {\n  h1, h2, h3, h4, h5, h6 {\n    margin-top: 24px;\n    margin-bottom: 16px;\n    font-weight: 600;\n    line-height: 1.25;\n  }\n  \n  h1 {\n    font-size: 2em;\n  }\n  \n  h2 {\n    font-size: 1.5em;\n  }\n  \n  h3 {\n    font-size: 1.25em;\n  }\n  \n  p, blockquote, ul, ol, dl, table, pre {\n    margin-top: 0;\n    margin-bottom: 16px;\n  }\n  \n  ul, ol {\n    padding-left: 2em;\n  }\n  \n  li + li {\n    margin-top: 0.25em;\n  }\n  \n  code {\n    font-family: SFMono-Regular, Consolas, \"Liberation Mono\", Menlo, monospace;\n    padding: 0.2em 0.4em;\n    margin: 0;\n    font-size: 85%;\n    background-color: rgba(27, 31, 35, 0.05);\n    border-radius: 3px;\n  }\n  \n  pre {\n    font-family: SFMono-Regular, Consolas, \"Liberation Mono\", Menlo, monospace;\n    word-wrap: normal;\n    padding: 16px;\n    overflow: auto;\n    font-size: 85%;\n    line-height: 1.45;\n    background-color: #f6f8fa;\n    border-radius: 3px;\n    \n    code {\n      background-color: transparent;\n      padding: 0;\n      margin: 0;\n      font-size: 100%;\n      word-break: normal;\n      white-space: pre;\n      border: 0;\n    }\n  }\n}\n\n@media (max-width: 1024px) {\n  .details-grid {\n    grid-template-columns: 1fr;\n  }\n  \n  .main-info-card,\n  .side-cards,\n  .history-card {\n    grid-column: 1;\n  }\n}\n\n@media (max-width: 768px) {\n  .vuln-header {\n    flex-direction: column;\n  }\n  \n  .vuln-dates {\n    width: 100%;\n    justify-content: flex-start;\n  }\n  \n  .date-item {\n    text-align: left;\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}