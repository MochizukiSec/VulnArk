{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.some.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.ends-with.js\";\nimport \"core-js/modules/web.timers.js\";\nimport { ref, reactive, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nexport default {\n  name: 'VulnerabilityImport',\n  setup: function setup() {\n    var router = useRouter();\n    var activeTab = ref('file');\n    var fileList = ref([]);\n    var scanFileList = ref([]);\n    var importing = ref(false);\n\n    // 进度对话框相关\n    var progressDialogVisible = ref(false);\n    var importProgress = ref(0);\n    var progressMessage = ref('准备导入...');\n    var importCompleted = ref(false);\n    var importResults = reactive({\n      successful: 0,\n      duplicates: 0,\n      failed: 0\n    });\n\n    // 扫描工具列表\n    var scanners = [{\n      name: 'Nessus',\n      format: '.nessus',\n      \"class\": 'nessus'\n    }, {\n      name: 'OpenVAS/Greenbone',\n      format: '.xml',\n      \"class\": 'openvas'\n    }, {\n      name: 'OWASP ZAP',\n      format: '.xml, .json',\n      \"class\": 'zap'\n    }, {\n      name: 'Qualys',\n      format: '.xml',\n      \"class\": 'qualys'\n    }, {\n      name: 'Acunetix',\n      format: '.xml',\n      \"class\": 'acunetix'\n    }, {\n      name: 'Burp Suite',\n      format: '.xml',\n      \"class\": 'burp'\n    }];\n\n    // 文件导入选项\n    var importOptions = reactive({\n      duplicateStrategy: 'skip',\n      defaultSeverity: 'medium',\n      defaultStatus: 'open',\n      sendNotifications: true\n    });\n\n    // 扫描结果导入选项\n    var scanImportOptions = reactive({\n      scannerType: 'auto',\n      minimumSeverity: '',\n      duplicateStrategy: 'skip',\n      sendNotifications: true\n    });\n\n    // 处理文件变化\n    var handleFileChange = function handleFileChange(file) {\n      fileList.value = [file];\n    };\n    var handleScanFileChange = function handleScanFileChange(file) {\n      scanFileList.value = [file];\n    };\n\n    // 导入前检查\n    var beforeImport = function beforeImport(file) {\n      // 检查文件大小\n      var maxSize = activeTab.value === 'file' ? 10 : 20; // MB\n      var isValidSize = file.size / 1024 / 1024 < maxSize;\n      if (!isValidSize) {\n        ElMessage.error(\"\\u6587\\u4EF6\\u5927\\u5C0F\\u4E0D\\u80FD\\u8D85\\u8FC7\".concat(maxSize, \"MB!\"));\n        return false;\n      }\n\n      // 检查文件类型\n      var validExtensions = [];\n      if (activeTab.value === 'file') {\n        validExtensions = ['.csv', '.xlsx', '.xls', '.json', '.xml'];\n      } else {\n        validExtensions = ['.nessus', '.xml', '.json'];\n      }\n      var fileName = file.name.toLowerCase();\n      var isValidType = validExtensions.some(function (ext) {\n        return fileName.endsWith(ext);\n      });\n      if (!isValidType) {\n        ElMessage.error('不支持的文件类型!');\n        return false;\n      }\n      return true;\n    };\n\n    // 处理导入成功\n    var handleImportSuccess = function handleImportSuccess(response) {\n      importing.value = false;\n      importProgress.value = 100;\n      progressMessage.value = '导入完成!';\n\n      // 更新导入统计信息\n      Object.assign(importResults, response.data.stats);\n\n      // 保存导入的漏洞ID列表，用于跳转查看\n      if (response.data.ids) {\n        // 这里应该保存ids到某个地方，比如一个数组\n      }\n      ElMessage.success('漏洞导入成功');\n    };\n\n    // 处理导入错误\n    var handleImportError = function handleImportError(error) {\n      importing.value = false;\n      progressDialogVisible.value = false;\n      var errorMessage = '导入失败';\n      if (error && error.message) {\n        errorMessage += ': ' + error.message;\n      }\n      ElMessage.error(errorMessage);\n    };\n\n    // 开始标准文件导入\n    var startImport = function startImport() {\n      if (fileList.value.length === 0) {\n        ElMessage.warning('请选择要导入的文件');\n        return;\n      }\n      ElMessageBox.confirm('确定要开始导入吗？根据数据量大小，这可能需要一些时间。', '开始导入', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'info'\n      }).then(function () {\n        importing.value = true;\n        progressDialogVisible.value = true;\n        importProgress.value = 0;\n        progressMessage.value = '正在解析文件并导入数据...';\n\n        // 注意：这里只是模拟导入进度\n        // 实际应用中应该使用WebSocket或轮询来获取实时进度\n        simulateImportProgress();\n\n        // 这里应该提交表单，触发文件上传\n        // 为了演示，我们使用setTimeout模拟上传过程\n        setTimeout(function () {\n          var uploadInstance = document.querySelector('.upload-area .el-upload').querySelector('input[type=file]');\n          if (uploadInstance && uploadInstance.files.length > 0) {\n            // 触发自动上传\n            // 在实际实现中，这里应该调用el-upload的submit方法\n          }\n        }, 500);\n      })[\"catch\"](function () {\n        // 用户取消导入\n      });\n    };\n\n    // 开始扫描结果导入\n    var startScanImport = function startScanImport() {\n      if (scanFileList.value.length === 0) {\n        ElMessage.warning('请选择扫描结果文件');\n        return;\n      }\n      ElMessageBox.confirm('确定要开始导入扫描结果吗？根据数据量大小，这可能需要一些时间。', '开始导入', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'info'\n      }).then(function () {\n        importing.value = true;\n        progressDialogVisible.value = true;\n        importProgress.value = 0;\n        progressMessage.value = '正在解析扫描结果...';\n\n        // 注意：这里只是模拟导入进度\n        simulateImportProgress();\n\n        // 这里应该提交表单，触发文件上传\n        setTimeout(function () {\n          var uploadInstance = document.querySelector('.upload-area .el-upload').querySelector('input[type=file]');\n          if (uploadInstance && uploadInstance.files.length > 0) {\n            // 触发自动上传\n          }\n        }, 500);\n      })[\"catch\"](function () {\n        // 用户取消导入\n      });\n    };\n\n    // 模拟导入进度\n    var simulateImportProgress = function simulateImportProgress() {\n      var currentProgress = 0;\n      var interval = setInterval(function () {\n        currentProgress += Math.random() * 10;\n        if (currentProgress >= 90) {\n          currentProgress = 90;\n          clearInterval(interval);\n          progressMessage.value = '即将完成...';\n        }\n        importProgress.value = Math.floor(currentProgress);\n      }, 800);\n    };\n\n    // 下载模板文件\n    var downloadTemplate = function downloadTemplate() {\n      // 实际应用中，这里应该指向一个模板文件的URL\n      ElMessage.info('模板下载功能即将上线，敬请期待');\n    };\n\n    // 关闭进度对话框\n    var closeProgressDialog = function closeProgressDialog() {\n      progressDialogVisible.value = false;\n    };\n\n    // 取消导入\n    var cancel = function cancel() {\n      router.push('/vulnerabilities');\n    };\n    return {\n      activeTab: activeTab,\n      fileList: fileList,\n      scanFileList: scanFileList,\n      importing: importing,\n      importOptions: importOptions,\n      scanImportOptions: scanImportOptions,\n      progressDialogVisible: progressDialogVisible,\n      importProgress: importProgress,\n      progressMessage: progressMessage,\n      importCompleted: importCompleted,\n      importResults: importResults,\n      scanners: scanners,\n      handleFileChange: handleFileChange,\n      handleScanFileChange: handleScanFileChange,\n      beforeImport: beforeImport,\n      handleImportSuccess: handleImportSuccess,\n      handleImportError: handleImportError,\n      startImport: startImport,\n      startScanImport: startScanImport,\n      downloadTemplate: downloadTemplate,\n      closeProgressDialog: closeProgressDialog,\n      cancel: cancel\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","onMounted","useRouter","ElMessage","ElMessageBox","name","setup","router","activeTab","fileList","scanFileList","importing","progressDialogVisible","importProgress","progressMessage","importCompleted","importResults","successful","duplicates","failed","scanners","format","importOptions","duplicateStrategy","defaultSeverity","defaultStatus","sendNotifications","scanImportOptions","scannerType","minimumSeverity","handleFileChange","file","value","handleScanFileChange","beforeImport","maxSize","isValidSize","size","error","concat","validExtensions","fileName","toLowerCase","isValidType","some","ext","endsWith","handleImportSuccess","response","Object","assign","data","stats","ids","success","handleImportError","errorMessage","message","startImport","length","warning","confirm","confirmButtonText","cancelButtonText","type","then","simulateImportProgress","setTimeout","uploadInstance","document","querySelector","files","startScanImport","currentProgress","interval","setInterval","Math","random","clearInterval","floor","downloadTemplate","info","closeProgressDialog","cancel","push"],"sources":["/Users/yue/Desktop/vuln-Management/frontend/src/views/vulnerabilities/VulnerabilityImport.vue"],"sourcesContent":["<template>\n  <div class=\"vulnerability-import\">\n    <!-- 页面标题 -->\n    <div class=\"page-header\">\n      <div class=\"header-content\">\n        <h1 class=\"page-title\">\n          <span class=\"title-icon\"><i class=\"el-icon-upload2\"></i></span>\n          漏洞导入\n          <span class=\"title-highlight\">工具</span>\n        </h1>\n        <p class=\"page-subtitle\">批量导入安全漏洞数据，支持多种格式和扫描工具结果</p>\n      </div>\n      <div class=\"header-actions\">\n        <el-button @click=\"cancel\" class=\"action-btn\">\n          <i class=\"el-icon-back\"></i> 返回列表\n        </el-button>\n      </div>\n    </div>\n\n    <div class=\"import-card\">\n      <el-tabs v-model=\"activeTab\" type=\"border-card\" class=\"import-tabs\">\n        <!-- 文件导入 -->\n        <el-tab-pane label=\"文件导入\" name=\"file\">\n          <div class=\"tab-content\">\n            <div class=\"import-description\">\n              <div class=\"description-header\">\n                <i class=\"el-icon-document format-icon\"></i>\n                <h3>支持的文件格式</h3>\n              </div>\n              <div class=\"format-grid\">\n                <div class=\"format-item\">\n                  <div class=\"format-icon-wrapper csv\">\n                    <i class=\"el-icon-document\"></i>\n                  </div>\n                  <span>CSV文件 (.csv)</span>\n                </div>\n                <div class=\"format-item\">\n                  <div class=\"format-icon-wrapper excel\">\n                    <i class=\"el-icon-document\"></i>\n                  </div>\n                  <span>Excel文件 (.xlsx, .xls)</span>\n                </div>\n                <div class=\"format-item\">\n                  <div class=\"format-icon-wrapper json\">\n                    <i class=\"el-icon-document\"></i>\n                  </div>\n                  <span>JSON文件 (.json)</span>\n                </div>\n                <div class=\"format-item\">\n                  <div class=\"format-icon-wrapper xml\">\n                    <i class=\"el-icon-document\"></i>\n                  </div>\n                  <span>XML文件 (.xml)</span>\n                </div>\n              </div>\n              <p class=\"format-notice\">请确保文件包含必要的字段，如漏洞标题、严重程度、描述等。\n                <a href=\"#\" @click.prevent=\"downloadTemplate\" class=\"download-link\">\n                  <i class=\"el-icon-download\"></i> 下载模板文件\n                </a>\n              </p>\n              <el-alert\n                type=\"warning\"\n                show-icon\n                :closable=\"false\"\n                class=\"import-alert\"\n              >\n                <p>导入大量数据可能需要一些时间，请耐心等待并不要刷新页面。</p>\n              </el-alert>\n            </div>\n\n            <el-upload\n              class=\"upload-area\"\n              drag\n              action=\"/api/vulnerabilities/import\"\n              :auto-upload=\"false\"\n              :on-change=\"handleFileChange\"\n              :on-success=\"handleImportSuccess\"\n              :on-error=\"handleImportError\"\n              :before-upload=\"beforeImport\"\n              :file-list=\"fileList\"\n              :limit=\"1\"\n            >\n              <i class=\"el-icon-upload\"></i>\n              <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\n              <template #tip>\n                <div class=\"el-upload__tip\">支持CSV、Excel、JSON和XML文件，文件大小不超过10MB</div>\n              </template>\n            </el-upload>\n\n            <div class=\"import-options\">\n              <div class=\"options-header\">\n                <i class=\"el-icon-setting\"></i>\n                <h3>导入选项</h3>\n              </div>\n              <el-form :model=\"importOptions\" label-width=\"180px\">\n                <el-form-item label=\"导入重复项时\">\n                  <el-radio-group v-model=\"importOptions.duplicateStrategy\">\n                    <el-radio label=\"skip\">跳过重复项</el-radio>\n                    <el-radio label=\"update\">更新重复项</el-radio>\n                    <el-radio label=\"create_new\">创建为新记录</el-radio>\n                  </el-radio-group>\n                </el-form-item>\n                \n                <el-form-item label=\"默认严重程度\">\n                  <el-select v-model=\"importOptions.defaultSeverity\" placeholder=\"选择默认严重程度\">\n                    <el-option label=\"未指定\" value=\"\" />\n                    <el-option label=\"严重\" value=\"critical\">\n                      <template #default>\n                        <div class=\"severity-option\">\n                          <span class=\"severity-dot critical\"></span>\n                          <span>严重</span>\n                        </div>\n                      </template>\n                    </el-option>\n                    <el-option label=\"高危\" value=\"high\">\n                      <template #default>\n                        <div class=\"severity-option\">\n                          <span class=\"severity-dot high\"></span>\n                          <span>高危</span>\n                        </div>\n                      </template>\n                    </el-option>\n                    <el-option label=\"中危\" value=\"medium\">\n                      <template #default>\n                        <div class=\"severity-option\">\n                          <span class=\"severity-dot medium\"></span>\n                          <span>中危</span>\n                        </div>\n                      </template>\n                    </el-option>\n                    <el-option label=\"低危\" value=\"low\">\n                      <template #default>\n                        <div class=\"severity-option\">\n                          <span class=\"severity-dot low\"></span>\n                          <span>低危</span>\n                        </div>\n                      </template>\n                    </el-option>\n                    <el-option label=\"信息\" value=\"info\">\n                      <template #default>\n                        <div class=\"severity-option\">\n                          <span class=\"severity-dot info\"></span>\n                          <span>信息</span>\n                        </div>\n                      </template>\n                    </el-option>\n                  </el-select>\n                  <div class=\"option-description\">当导入数据未指定严重程度时使用</div>\n                </el-form-item>\n                \n                <el-form-item label=\"默认状态\">\n                  <el-select v-model=\"importOptions.defaultStatus\" placeholder=\"选择默认状态\">\n                    <el-option label=\"开放\" value=\"open\" />\n                    <el-option label=\"处理中\" value=\"in_progress\" />\n                    <el-option label=\"已解决\" value=\"resolved\" />\n                    <el-option label=\"已关闭\" value=\"closed\" />\n                    <el-option label=\"误报\" value=\"false_positive\" />\n                  </el-select>\n                  <div class=\"option-description\">当导入数据未指定状态时使用</div>\n                </el-form-item>\n                \n                <el-form-item label=\"发送通知\">\n                  <el-switch v-model=\"importOptions.sendNotifications\" />\n                  <div class=\"option-description\">完成导入后是否发送通知</div>\n                </el-form-item>\n              </el-form>\n            </div>\n          </div>\n\n          <div class=\"import-actions\">\n            <el-button @click=\"cancel\" class=\"cancel-btn\">取消</el-button>\n            <el-button type=\"primary\" @click=\"startImport\" :loading=\"importing\" :disabled=\"fileList.length === 0\" class=\"import-btn\">\n              <i class=\"el-icon-upload\"></i> 开始导入\n            </el-button>\n          </div>\n        </el-tab-pane>\n\n        <!-- 扫描结果导入 -->\n        <el-tab-pane label=\"扫描结果导入\" name=\"scan\">\n          <div class=\"tab-content\">\n            <div class=\"import-description\">\n              <div class=\"description-header\">\n                <i class=\"el-icon-monitor format-icon\"></i>\n                <h3>支持的扫描工具</h3>\n              </div>\n              <div class=\"scanner-grid\">\n                <div class=\"scanner-item\" v-for=\"(scanner, index) in scanners\" :key=\"index\">\n                  <div class=\"scanner-icon-wrapper\" :class=\"scanner.class\">\n                    <i class=\"el-icon-cpu\"></i>\n                  </div>\n                  <span>{{ scanner.name }}</span>\n                  <span class=\"scanner-format\">{{ scanner.format }}</span>\n                </div>\n              </div>\n              <p class=\"format-notice\">系统会自动解析扫描工具的报告格式，并将漏洞信息导入到平台中。</p>\n              <el-alert\n                type=\"info\"\n                show-icon\n                :closable=\"false\"\n                class=\"import-alert\"\n              >\n                <p>导入后请检查数据准确性，不同扫描工具的数据格式可能略有差异。</p>\n              </el-alert>\n            </div>\n\n            <el-upload\n              class=\"upload-area\"\n              drag\n              action=\"/api/vulnerabilities/import/scan\"\n              :auto-upload=\"false\"\n              :on-change=\"handleScanFileChange\"\n              :on-success=\"handleImportSuccess\"\n              :on-error=\"handleImportError\"\n              :before-upload=\"beforeImport\"\n              :file-list=\"scanFileList\"\n              :limit=\"1\"\n            >\n              <i class=\"el-icon-upload\"></i>\n              <div class=\"el-upload__text\">将扫描报告文件拖到此处，或<em>点击上传</em></div>\n              <template #tip>\n                <div class=\"el-upload__tip\">支持各种扫描工具生成的报告文件，文件大小不超过50MB</div>\n              </template>\n            </el-upload>\n\n            <div class=\"import-options\">\n              <div class=\"options-header\">\n                <i class=\"el-icon-setting\"></i>\n                <h3>导入选项</h3>\n              </div>\n              <el-form :model=\"scanImportOptions\" label-width=\"180px\">\n                <el-form-item label=\"扫描工具类型\">\n                  <el-select v-model=\"scanImportOptions.scannerType\" placeholder=\"选择扫描工具类型\">\n                    <el-option label=\"自动检测\" value=\"auto\" />\n                    <el-option label=\"Nessus\" value=\"nessus\" />\n                    <el-option label=\"OpenVAS/Greenbone\" value=\"openvas\" />\n                    <el-option label=\"OWASP ZAP\" value=\"zap\" />\n                    <el-option label=\"Qualys\" value=\"qualys\" />\n                    <el-option label=\"Acunetix\" value=\"acunetix\" />\n                    <el-option label=\"Burp Suite\" value=\"burp\" />\n                  </el-select>\n                  <div class=\"option-description\">通常情况下可以使用自动检测</div>\n                </el-form-item>\n                \n                <el-form-item label=\"最低严重程度\">\n                  <el-select v-model=\"scanImportOptions.minimumSeverity\" placeholder=\"选择最低严重程度\">\n                    <el-option label=\"全部导入\" value=\"\" />\n                    <el-option label=\"严重\" value=\"critical\">\n                      <template #default>\n                        <div class=\"severity-option\">\n                          <span class=\"severity-dot critical\"></span>\n                          <span>严重</span>\n                        </div>\n                      </template>\n                    </el-option>\n                    <el-option label=\"高危\" value=\"high\">\n                      <template #default>\n                        <div class=\"severity-option\">\n                          <span class=\"severity-dot high\"></span>\n                          <span>高危</span>\n                        </div>\n                      </template>\n                    </el-option>\n                    <el-option label=\"中危\" value=\"medium\">\n                      <template #default>\n                        <div class=\"severity-option\">\n                          <span class=\"severity-dot medium\"></span>\n                          <span>中危</span>\n                        </div>\n                      </template>\n                    </el-option>\n                    <el-option label=\"低危\" value=\"low\">\n                      <template #default>\n                        <div class=\"severity-option\">\n                          <span class=\"severity-dot low\"></span>\n                          <span>低危</span>\n                        </div>\n                      </template>\n                    </el-option>\n                  </el-select>\n                  <div class=\"option-description\">仅导入选定严重程度及以上的漏洞</div>\n                </el-form-item>\n                \n                <el-form-item label=\"导入重复项时\">\n                  <el-radio-group v-model=\"scanImportOptions.duplicateStrategy\">\n                    <el-radio label=\"skip\">跳过重复项</el-radio>\n                    <el-radio label=\"update\">更新重复项</el-radio>\n                    <el-radio label=\"create_new\">创建为新记录</el-radio>\n                  </el-radio-group>\n                </el-form-item>\n                \n                <el-form-item label=\"发送通知\">\n                  <el-switch v-model=\"scanImportOptions.sendNotifications\" />\n                  <div class=\"option-description\">完成导入后是否发送通知</div>\n                </el-form-item>\n              </el-form>\n            </div>\n          </div>\n\n          <div class=\"import-actions\">\n            <el-button @click=\"cancel\" class=\"cancel-btn\">取消</el-button>\n            <el-button type=\"primary\" @click=\"startScanImport\" :loading=\"importing\" :disabled=\"scanFileList.length === 0\" class=\"import-btn\">\n              <i class=\"el-icon-upload\"></i> 开始导入\n            </el-button>\n          </div>\n        </el-tab-pane>\n      </el-tabs>\n    </div>\n\n    <!-- 导入进度对话框 -->\n    <el-dialog\n      title=\"导入进度\"\n      v-model=\"progressDialogVisible\"\n      :close-on-click-modal=\"false\"\n      :close-on-press-escape=\"false\"\n      :show-close=\"false\"\n      width=\"500px\"\n      class=\"progress-dialog\"\n    >\n      <div class=\"progress-dialog-content\">\n        <el-progress \n          :percentage=\"importProgress\" \n          :status=\"importProgress === 100 ? 'success' : ''\"\n          :stroke-width=\"10\"\n          class=\"import-progress\"\n        ></el-progress>\n        <div class=\"progress-info\">\n          <p>{{ progressMessage }}</p>\n          <div v-if=\"importCompleted\" class=\"import-summary\">\n            <div class=\"summary-item\">\n              <div class=\"summary-label\">成功导入：</div>\n              <div class=\"summary-value success\">{{ importResults.successful }}</div>\n            </div>\n            <div class=\"summary-item\">\n              <div class=\"summary-label\">重复跳过：</div>\n              <div class=\"summary-value skipped\">{{ importResults.duplicates }}</div>\n            </div>\n            <div class=\"summary-item\">\n              <div class=\"summary-label\">导入失败：</div>\n              <div class=\"summary-value error\">{{ importResults.failed }}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button \n            v-if=\"importCompleted\" \n            type=\"primary\" \n            @click=\"closeProgressDialog\"\n          >\n            关闭\n          </el-button>\n          <el-button \n            v-if=\"importProgress < 100 && !importing\" \n            type=\"danger\" \n            @click=\"cancelImport\"\n          >\n            取消导入\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { ElMessage, ElMessageBox } from 'element-plus'\n\nexport default {\n  name: 'VulnerabilityImport',\n  \n  setup() {\n    const router = useRouter()\n    const activeTab = ref('file')\n    const fileList = ref([])\n    const scanFileList = ref([])\n    const importing = ref(false)\n    \n    // 进度对话框相关\n    const progressDialogVisible = ref(false)\n    const importProgress = ref(0)\n    const progressMessage = ref('准备导入...')\n    const importCompleted = ref(false)\n    const importResults = reactive({\n      successful: 0,\n      duplicates: 0,\n      failed: 0\n    })\n\n    // 扫描工具列表\n    const scanners = [\n      { name: 'Nessus', format: '.nessus', class: 'nessus' },\n      { name: 'OpenVAS/Greenbone', format: '.xml', class: 'openvas' },\n      { name: 'OWASP ZAP', format: '.xml, .json', class: 'zap' },\n      { name: 'Qualys', format: '.xml', class: 'qualys' },\n      { name: 'Acunetix', format: '.xml', class: 'acunetix' },\n      { name: 'Burp Suite', format: '.xml', class: 'burp' }\n    ]\n    \n    // 文件导入选项\n    const importOptions = reactive({\n      duplicateStrategy: 'skip',\n      defaultSeverity: 'medium',\n      defaultStatus: 'open',\n      sendNotifications: true\n    })\n    \n    // 扫描结果导入选项\n    const scanImportOptions = reactive({\n      scannerType: 'auto',\n      minimumSeverity: '',\n      duplicateStrategy: 'skip',\n      sendNotifications: true\n    })\n    \n    // 处理文件变化\n    const handleFileChange = (file) => {\n      fileList.value = [file]\n    }\n    \n    const handleScanFileChange = (file) => {\n      scanFileList.value = [file]\n    }\n    \n    // 导入前检查\n    const beforeImport = (file) => {\n      // 检查文件大小\n      const maxSize = activeTab.value === 'file' ? 10 : 20 // MB\n      const isValidSize = file.size / 1024 / 1024 < maxSize\n      \n      if (!isValidSize) {\n        ElMessage.error(`文件大小不能超过${maxSize}MB!`)\n        return false\n      }\n      \n      // 检查文件类型\n      let validExtensions = []\n      \n      if (activeTab.value === 'file') {\n        validExtensions = ['.csv', '.xlsx', '.xls', '.json', '.xml']\n      } else {\n        validExtensions = ['.nessus', '.xml', '.json']\n      }\n      \n      const fileName = file.name.toLowerCase()\n      const isValidType = validExtensions.some(ext => fileName.endsWith(ext))\n      \n      if (!isValidType) {\n        ElMessage.error('不支持的文件类型!')\n        return false\n      }\n      \n      return true\n    }\n    \n    // 处理导入成功\n    const handleImportSuccess = (response) => {\n      importing.value = false\n      importProgress.value = 100\n      progressMessage.value = '导入完成!'\n      \n      // 更新导入统计信息\n      Object.assign(importResults, response.data.stats)\n      \n      // 保存导入的漏洞ID列表，用于跳转查看\n      if (response.data.ids) {\n        // 这里应该保存ids到某个地方，比如一个数组\n      }\n      \n      ElMessage.success('漏洞导入成功')\n    }\n    \n    // 处理导入错误\n    const handleImportError = (error) => {\n      importing.value = false\n      progressDialogVisible.value = false\n      \n      let errorMessage = '导入失败'\n      if (error && error.message) {\n        errorMessage += ': ' + error.message\n      }\n      \n      ElMessage.error(errorMessage)\n    }\n    \n    // 开始标准文件导入\n    const startImport = () => {\n      if (fileList.value.length === 0) {\n        ElMessage.warning('请选择要导入的文件')\n        return\n      }\n      \n      ElMessageBox.confirm(\n        '确定要开始导入吗？根据数据量大小，这可能需要一些时间。',\n        '开始导入',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'info'\n        }\n      ).then(() => {\n        importing.value = true\n        progressDialogVisible.value = true\n        importProgress.value = 0\n        progressMessage.value = '正在解析文件并导入数据...'\n        \n        // 注意：这里只是模拟导入进度\n        // 实际应用中应该使用WebSocket或轮询来获取实时进度\n        simulateImportProgress()\n        \n        // 这里应该提交表单，触发文件上传\n        // 为了演示，我们使用setTimeout模拟上传过程\n        setTimeout(() => {\n          const uploadInstance = document.querySelector('.upload-area .el-upload').querySelector('input[type=file]')\n          if (uploadInstance && uploadInstance.files.length > 0) {\n            // 触发自动上传\n            // 在实际实现中，这里应该调用el-upload的submit方法\n          }\n        }, 500)\n      }).catch(() => {\n        // 用户取消导入\n      })\n    }\n    \n    // 开始扫描结果导入\n    const startScanImport = () => {\n      if (scanFileList.value.length === 0) {\n        ElMessage.warning('请选择扫描结果文件')\n        return\n      }\n      \n      ElMessageBox.confirm(\n        '确定要开始导入扫描结果吗？根据数据量大小，这可能需要一些时间。',\n        '开始导入',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'info'\n        }\n      ).then(() => {\n        importing.value = true\n        progressDialogVisible.value = true\n        importProgress.value = 0\n        progressMessage.value = '正在解析扫描结果...'\n        \n        // 注意：这里只是模拟导入进度\n        simulateImportProgress()\n        \n        // 这里应该提交表单，触发文件上传\n        setTimeout(() => {\n          const uploadInstance = document.querySelector('.upload-area .el-upload').querySelector('input[type=file]')\n          if (uploadInstance && uploadInstance.files.length > 0) {\n            // 触发自动上传\n          }\n        }, 500)\n      }).catch(() => {\n        // 用户取消导入\n      })\n    }\n    \n    // 模拟导入进度\n    const simulateImportProgress = () => {\n      let currentProgress = 0\n      const interval = setInterval(() => {\n        currentProgress += Math.random() * 10\n        if (currentProgress >= 90) {\n          currentProgress = 90\n          clearInterval(interval)\n          progressMessage.value = '即将完成...'\n        }\n        importProgress.value = Math.floor(currentProgress)\n      }, 800)\n    }\n    \n    // 下载模板文件\n    const downloadTemplate = () => {\n      // 实际应用中，这里应该指向一个模板文件的URL\n      ElMessage.info('模板下载功能即将上线，敬请期待')\n    }\n    \n    // 关闭进度对话框\n    const closeProgressDialog = () => {\n      progressDialogVisible.value = false\n    }\n    \n    // 取消导入\n    const cancel = () => {\n      router.push('/vulnerabilities')\n    }\n    \n    return {\n      activeTab,\n      fileList,\n      scanFileList,\n      importing,\n      importOptions,\n      scanImportOptions,\n      progressDialogVisible,\n      importProgress,\n      progressMessage,\n      importCompleted,\n      importResults,\n      scanners,\n      handleFileChange,\n      handleScanFileChange,\n      beforeImport,\n      handleImportSuccess,\n      handleImportError,\n      startImport,\n      startScanImport,\n      downloadTemplate,\n      closeProgressDialog,\n      cancel\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.vulnerability-import {\n  padding: 24px;\n  animation: fadeIn 0.6s ease;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; transform: translateY(10px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n  \n  .header-content {\n    flex: 1;\n  }\n  \n  .page-title {\n    font-size: 28px;\n    font-weight: 600;\n    margin: 0 0 8px 0;\n    display: flex;\n    align-items: center;\n    color: #303133;\n    \n    .title-icon {\n      margin-right: 12px;\n      font-size: 28px;\n      color: #409EFF;\n    }\n    \n    .title-highlight {\n      background: linear-gradient(120deg, #409EFF, #53A8FF);\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      margin-left: 8px;\n      font-weight: 700;\n    }\n  }\n  \n  .page-subtitle {\n    color: #606266;\n    font-size: 16px;\n    margin: 0;\n  }\n  \n  .header-actions {\n    display: flex;\n    gap: 12px;\n    \n    .action-btn {\n      border-radius: 8px;\n      padding: 10px 20px;\n      font-weight: 500;\n      transition: all 0.3s;\n      \n      i {\n        margin-right: 6px;\n      }\n      \n      &:hover {\n        transform: translateY(-2px);\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n      }\n    }\n  }\n}\n\n.import-card {\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.03);\n  transition: all 0.3s ease;\n  position: relative;\n  overflow: hidden;\n  \n  &:hover {\n    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);\n  }\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 4px;\n    background: linear-gradient(90deg, #409EFF, #53A8FF);\n  }\n  \n  .import-tabs {\n    border: none;\n    \n    :deep(.el-tabs__content) {\n      padding: 24px;\n    }\n    \n    :deep(.el-tabs__header) {\n      margin-bottom: 0;\n      background: #f5f7fa;\n      border-bottom: 1px solid #e4e7ed;\n    }\n    \n    :deep(.el-tabs__nav) {\n      border: none;\n    }\n    \n    :deep(.el-tabs__item) {\n      height: 50px;\n      line-height: 50px;\n      font-size: 16px;\n      font-weight: 500;\n      color: #606266;\n      transition: all 0.3s;\n      \n      &.is-active {\n        color: #409EFF;\n        font-weight: 600;\n      }\n      \n      &:hover {\n        color: #409EFF;\n      }\n    }\n  }\n}\n\n.tab-content {\n  margin-bottom: 20px;\n}\n\n.import-description {\n  margin-bottom: 30px;\n  \n  .description-header {\n    display: flex;\n    align-items: center;\n    margin-bottom: 20px;\n    \n    i {\n      font-size: 24px;\n      color: #409EFF;\n      margin-right: 12px;\n    }\n    \n    h3 {\n      font-size: 18px;\n      font-weight: 600;\n      margin: 0;\n      color: #303133;\n    }\n  }\n  \n  p {\n    margin: 16px 0;\n    color: #606266;\n    line-height: 1.6;\n  }\n  \n  ul {\n    margin: 16px 0;\n    padding-left: 20px;\n    \n    li {\n      margin-bottom: 8px;\n      color: #606266;\n    }\n  }\n  \n  .format-notice {\n    color: #606266;\n    line-height: 1.6;\n    display: flex;\n    align-items: center;\n    flex-wrap: wrap;\n    gap: 8px;\n  }\n  \n  .download-link {\n    color: #409EFF;\n    text-decoration: none;\n    font-weight: 500;\n    transition: all 0.3s;\n    display: inline-flex;\n    align-items: center;\n    \n    i {\n      margin-right: 4px;\n    }\n    \n    &:hover {\n      color: #66b1ff;\n      text-decoration: underline;\n    }\n  }\n  \n  .import-alert {\n    margin-top: 20px;\n    border-radius: 8px;\n    \n    :deep(.el-alert__content) {\n      p {\n        margin: 0;\n      }\n    }\n  }\n}\n\n.format-grid, .scanner-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 16px;\n  margin: 20px 0;\n  \n  .format-item, .scanner-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 12px;\n    padding: 16px;\n    border-radius: 8px;\n    background: #f5f7fa;\n    transition: all 0.3s;\n    \n    &:hover {\n      transform: translateY(-3px);\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n    }\n    \n    .format-icon-wrapper, .scanner-icon-wrapper {\n      width: 48px;\n      height: 48px;\n      border-radius: 8px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      background: rgba(64, 158, 255, 0.1);\n      color: #409EFF;\n      font-size: 24px;\n      \n      &.csv {\n        background: rgba(76, 175, 80, 0.1);\n        color: #4CAF50;\n      }\n      \n      &.excel {\n        background: rgba(33, 150, 243, 0.1);\n        color: #2196F3;\n      }\n      \n      &.json {\n        background: rgba(255, 152, 0, 0.1);\n        color: #FF9800;\n      }\n      \n      &.xml {\n        background: rgba(156, 39, 176, 0.1);\n        color: #9C27B0;\n      }\n      \n      &.nessus {\n        background: rgba(244, 67, 54, 0.1);\n        color: #F44336;\n      }\n      \n      &.openvas {\n        background: rgba(76, 175, 80, 0.1);\n        color: #4CAF50;\n      }\n      \n      &.zap {\n        background: rgba(33, 150, 243, 0.1);\n        color: #2196F3;\n      }\n      \n      &.qualys {\n        background: rgba(255, 152, 0, 0.1);\n        color: #FF9800;\n      }\n      \n      &.acunetix {\n        background: rgba(156, 39, 176, 0.1);\n        color: #9C27B0;\n      }\n      \n      &.burp {\n        background: rgba(233, 30, 99, 0.1);\n        color: #E91E63;\n      }\n    }\n    \n    span {\n      color: #303133;\n      font-weight: 500;\n      text-align: center;\n    }\n    \n    .scanner-format {\n      color: #909399;\n      font-size: 12px;\n      font-weight: normal;\n    }\n  }\n}\n\n.upload-area {\n  margin-bottom: 30px;\n  \n  :deep(.el-upload-dragger) {\n    width: 100%;\n    height: 180px;\n    border: 2px dashed #d9d9d9;\n    border-radius: 8px;\n    background: #f5f7fa;\n    transition: all 0.3s;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    \n    &:hover {\n      border-color: #409EFF;\n      background: rgba(64, 158, 255, 0.05);\n    }\n    \n    i {\n      font-size: 48px;\n      color: #c0c4cc;\n      margin-bottom: 16px;\n      transition: all 0.3s;\n    }\n    \n    &:hover i {\n      color: #409EFF;\n    }\n    \n    .el-upload__text {\n      font-size: 16px;\n      color: #606266;\n      \n      em {\n        color: #409EFF;\n        font-style: normal;\n        font-weight: 500;\n      }\n    }\n  }\n  \n  :deep(.el-upload__tip) {\n    color: #909399;\n    font-size: 13px;\n    margin-top: 12px;\n    text-align: center;\n  }\n}\n\n.import-options {\n  background: #f9fbfd;\n  border-radius: 8px;\n  padding: 20px;\n  \n  .options-header {\n    display: flex;\n    align-items: center;\n    margin-bottom: 20px;\n    \n    i {\n      font-size: 20px;\n      color: #409EFF;\n      margin-right: 8px;\n    }\n    \n    h3 {\n      font-size: 18px;\n      font-weight: 600;\n      margin: 0;\n      color: #303133;\n    }\n  }\n  \n  :deep(.el-form-item__label) {\n    padding-bottom: 8px;\n    font-weight: 500;\n    color: #606266;\n  }\n  \n  :deep(.el-input__inner), :deep(.el-textarea__inner) {\n    border-radius: 8px;\n    transition: all 0.3s;\n    \n    &:focus {\n      box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);\n    }\n  }\n  \n  .option-description {\n    color: #909399;\n    font-size: 12px;\n    margin-top: 4px;\n  }\n}\n\n.severity-option {\n  display: flex;\n  align-items: center;\n  \n  .severity-dot {\n    width: 10px;\n    height: 10px;\n    border-radius: 50%;\n    margin-right: 8px;\n    \n    &.critical {\n      background-color: #F44336;\n    }\n    \n    &.high {\n      background-color: #FF9800;\n    }\n    \n    &.medium {\n      background-color: #FFEB3B;\n    }\n    \n    &.low {\n      background-color: #4CAF50;\n    }\n    \n    &.info {\n      background-color: #2196F3;\n    }\n  }\n}\n\n.import-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding-top: 20px;\n  border-top: 1px solid rgba(0, 0, 0, 0.05);\n  margin-top: 20px;\n  \n  .cancel-btn {\n    border-radius: 8px;\n    padding: 10px 20px;\n  }\n  \n  .import-btn {\n    border-radius: 8px;\n    padding: 10px 24px;\n    font-weight: 500;\n    transition: all 0.3s;\n    min-width: 120px;\n    \n    i {\n      margin-right: 6px;\n    }\n    \n    &:hover {\n      transform: translateY(-2px);\n      box-shadow: 0 4px 12px rgba(64, 158, 255, 0.2);\n    }\n  }\n}\n\n.progress-dialog {\n  :deep(.el-dialog__header) {\n    padding: 20px;\n    margin: 0;\n    background: #f5f7fa;\n    border-bottom: 1px solid #e4e7ed;\n    \n    .el-dialog__title {\n      font-size: 18px;\n      font-weight: 600;\n      color: #303133;\n    }\n  }\n  \n  :deep(.el-dialog__body) {\n    padding: 24px;\n  }\n  \n  :deep(.el-dialog__footer) {\n    padding: 16px 24px;\n    border-top: 1px solid #e4e7ed;\n  }\n}\n\n.progress-dialog-content {\n  .import-progress {\n    margin-bottom: 24px;\n    \n    :deep(.el-progress-bar__outer) {\n      border-radius: 8px;\n      background: #ebeef5;\n    }\n    \n    :deep(.el-progress-bar__inner) {\n      border-radius: 8px;\n      background: linear-gradient(90deg, #409EFF, #53A8FF);\n    }\n  }\n  \n  .progress-info {\n    text-align: center;\n    \n    p {\n      margin: 0 0 16px 0;\n      color: #606266;\n      font-size: 16px;\n    }\n  }\n  \n  .import-summary {\n    display: flex;\n    justify-content: center;\n    gap: 24px;\n    margin-top: 24px;\n    \n    .summary-item {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      \n      .summary-label {\n        color: #909399;\n        font-size: 14px;\n        margin-bottom: 8px;\n      }\n      \n      .summary-value {\n        font-size: 24px;\n        font-weight: 600;\n        \n        &.success {\n          color: #67C23A;\n        }\n        \n        &.skipped {\n          color: #E6A23C;\n        }\n        \n        &.error {\n          color: #F56C6C;\n        }\n      }\n    }\n  }\n}\n\n// 响应式调整\n@media (max-width: 768px) {\n  .vulnerability-import {\n    padding: 16px;\n  }\n  \n  .page-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 16px;\n    \n    .header-actions {\n      align-self: flex-start;\n    }\n    \n    .page-title {\n      font-size: 24px;\n      \n      .title-icon {\n        font-size: 24px;\n      }\n    }\n    \n    .page-subtitle {\n      font-size: 14px;\n    }\n  }\n  \n  .import-card {\n    .import-tabs {\n      :deep(.el-tabs__content) {\n        padding: 16px;\n      }\n      \n      :deep(.el-tabs__item) {\n        height: 40px;\n        line-height: 40px;\n        font-size: 14px;\n      }\n    }\n  }\n  \n  .format-grid, .scanner-grid {\n    grid-template-columns: 1fr 1fr;\n  }\n  \n  .import-options {\n    padding: 16px;\n    \n    :deep(.el-form-item__label) {\n      width: 100% !important;\n      text-align: left;\n      margin-bottom: 8px;\n    }\n  }\n  \n  .import-actions {\n    flex-direction: column;\n    \n    .el-button {\n      width: 100%;\n    }\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}