{"ast":null,"code":"import { ref, reactive, computed, nextTick, onMounted } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { marked } from 'marked';\nimport DOMPurify from 'dompurify';\nexport default {\n  name: 'VulnerabilityCreate',\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const formRef = ref(null);\n    const loading = ref(false);\n    const submitting = ref(false);\n\n    // Markdown 编辑的标签页状态\n    const descriptionTab = ref('edit');\n    const impactTab = ref('edit');\n    const stepsTab = ref('edit');\n    const recommendationTab = ref('edit');\n\n    // 标签输入相关\n    const tagInputRef = ref(null);\n    const inputTagVisible = ref(false);\n    const inputTagValue = ref('');\n\n    // 资产对话框\n    const assetDialogVisible = ref(false);\n    const assetForm = reactive({\n      name: '',\n      details: ''\n    });\n\n    // 漏洞表单数据\n    const vulnerabilityForm = reactive({\n      title: '',\n      description: '',\n      impact: '',\n      steps_to_reproduce: '',\n      recommendation: '',\n      severity: 'medium',\n      status: 'open',\n      cve: '',\n      cvss: 0,\n      cvss_vector: '',\n      discoveredAt: new Date().toISOString().slice(0, 10),\n      affected_assets: [],\n      references: [],\n      tags: []\n    });\n\n    // 表单验证规则\n    const rules = {\n      title: [{\n        required: true,\n        message: '请输入漏洞标题',\n        trigger: 'blur'\n      }, {\n        min: 3,\n        max: 200,\n        message: '长度在 3 到 200 个字符',\n        trigger: 'blur'\n      }],\n      description: [{\n        required: true,\n        message: '请输入漏洞描述',\n        trigger: 'blur'\n      }],\n      severity: [{\n        required: true,\n        message: '请选择严重程度',\n        trigger: 'change'\n      }],\n      status: [{\n        required: true,\n        message: '请选择漏洞状态',\n        trigger: 'change'\n      }],\n      discoveredAt: [{\n        required: true,\n        message: '请选择发现日期',\n        trigger: 'change'\n      }]\n    };\n\n    // Markdown 渲染\n    const renderedDescription = computed(() => {\n      if (!vulnerabilityForm.description) return '';\n      return DOMPurify.sanitize(marked.parse(vulnerabilityForm.description));\n    });\n    const renderedImpact = computed(() => {\n      if (!vulnerabilityForm.impact) return '';\n      return DOMPurify.sanitize(marked.parse(vulnerabilityForm.impact));\n    });\n    const renderedSteps = computed(() => {\n      if (!vulnerabilityForm.steps_to_reproduce) return '';\n      return DOMPurify.sanitize(marked.parse(vulnerabilityForm.steps_to_reproduce));\n    });\n    const renderedRecommendation = computed(() => {\n      if (!vulnerabilityForm.recommendation) return '';\n      return DOMPurify.sanitize(marked.parse(vulnerabilityForm.recommendation));\n    });\n\n    // 返回列表\n    const goBack = () => {\n      if (formHasChanges()) {\n        ElMessageBox.confirm('表单内容已修改，确定要离开吗？', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          router.push('/vulnerabilities');\n        }).catch(() => {\n          // 用户取消\n        });\n      } else {\n        router.push('/vulnerabilities');\n      }\n    };\n\n    // 判断表单是否有修改\n    const formHasChanges = () => {\n      return vulnerabilityForm.title || vulnerabilityForm.description || vulnerabilityForm.impact || vulnerabilityForm.steps_to_reproduce || vulnerabilityForm.recommendation || vulnerabilityForm.cvss !== 0 || vulnerabilityForm.cve || vulnerabilityForm.cvss_vector || vulnerabilityForm.affected_assets.length > 0 || vulnerabilityForm.references.length > 0 || vulnerabilityForm.tags.length > 0;\n    };\n\n    // 提交表单\n    const submitForm = async () => {\n      if (!formRef.value) return;\n      try {\n        await formRef.value.validate();\n        submitting.value = true;\n\n        // 准备提交的数据\n        const vulnerabilityData = {\n          ...vulnerabilityForm\n        };\n        try {\n          // 创建漏洞\n          await store.dispatch('vulnerability/createVulnerability', vulnerabilityData);\n          ElMessage({\n            type: 'success',\n            message: '漏洞创建成功'\n          });\n          router.push('/vulnerabilities');\n        } catch (error) {\n          ElMessage({\n            type: 'error',\n            message: '创建漏洞失败: ' + (error.message || '未知错误')\n          });\n        } finally {\n          submitting.value = false;\n        }\n      } catch (error) {\n        ElMessage({\n          type: 'warning',\n          message: '请完善表单信息'\n        });\n      }\n    };\n\n    // 标签相关方法\n    const showTagInput = () => {\n      inputTagVisible.value = true;\n      nextTick(() => {\n        tagInputRef.value?.focus();\n      });\n    };\n    const handleInputTagConfirm = () => {\n      const inputValue = inputTagValue.value.trim();\n      if (inputValue && !vulnerabilityForm.tags.includes(inputValue)) {\n        vulnerabilityForm.tags.push(inputValue);\n      }\n      inputTagVisible.value = false;\n      inputTagValue.value = '';\n    };\n    const handleRemoveTag = tag => {\n      vulnerabilityForm.tags.splice(vulnerabilityForm.tags.indexOf(tag), 1);\n    };\n\n    // 资产相关方法\n    const showAssetDialog = () => {\n      assetForm.name = '';\n      assetForm.details = '';\n      assetDialogVisible.value = true;\n    };\n    const handleAddAsset = () => {\n      if (!assetForm.name.trim()) {\n        ElMessage({\n          type: 'warning',\n          message: '请输入资产名称'\n        });\n        return;\n      }\n      vulnerabilityForm.affected_assets.push({\n        name: assetForm.name.trim(),\n        details: assetForm.details.trim()\n      });\n      assetDialogVisible.value = false;\n    };\n    const handleRemoveAsset = asset => {\n      const index = vulnerabilityForm.affected_assets.findIndex(a => a.name === asset.name);\n      if (index !== -1) {\n        vulnerabilityForm.affected_assets.splice(index, 1);\n      }\n    };\n\n    // 参考链接相关方法\n    const addReference = () => {\n      vulnerabilityForm.references.push({\n        title: '',\n        url: ''\n      });\n    };\n    const removeReference = index => {\n      vulnerabilityForm.references.splice(index, 1);\n    };\n    return {\n      formRef,\n      loading,\n      submitting,\n      vulnerabilityForm,\n      rules,\n      descriptionTab,\n      impactTab,\n      stepsTab,\n      recommendationTab,\n      inputTagVisible,\n      inputTagValue,\n      tagInputRef,\n      assetDialogVisible,\n      assetForm,\n      renderedDescription,\n      renderedImpact,\n      renderedSteps,\n      renderedRecommendation,\n      goBack,\n      submitForm,\n      showTagInput,\n      handleInputTagConfirm,\n      handleRemoveTag,\n      showAssetDialog,\n      handleAddAsset,\n      handleRemoveAsset,\n      addReference,\n      removeReference\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","computed","nextTick","onMounted","useStore","useRouter","ElMessage","ElMessageBox","marked","DOMPurify","name","setup","store","router","formRef","loading","submitting","descriptionTab","impactTab","stepsTab","recommendationTab","tagInputRef","inputTagVisible","inputTagValue","assetDialogVisible","assetForm","details","vulnerabilityForm","title","description","impact","steps_to_reproduce","recommendation","severity","status","cve","cvss","cvss_vector","discoveredAt","Date","toISOString","slice","affected_assets","references","tags","rules","required","message","trigger","min","max","renderedDescription","sanitize","parse","renderedImpact","renderedSteps","renderedRecommendation","goBack","formHasChanges","confirm","confirmButtonText","cancelButtonText","type","then","push","catch","length","submitForm","value","validate","vulnerabilityData","dispatch","error","showTagInput","focus","handleInputTagConfirm","inputValue","trim","includes","handleRemoveTag","tag","splice","indexOf","showAssetDialog","handleAddAsset","handleRemoveAsset","asset","index","findIndex","a","addReference","url","removeReference"],"sources":["/Users/yue/Desktop/vuln-Management/frontend/src/views/vulnerabilities/VulnerabilityCreate.vue"],"sourcesContent":["<template>\n  <div class=\"vulnerability-create-page\">\n    <div class=\"page-header\">\n      <div class=\"header-back\">\n        <el-button @click=\"goBack\" icon=\"el-icon-arrow-left\" type=\"text\">\n          返回列表\n        </el-button>\n      </div>\n      <h1 class=\"page-title\">创建新漏洞</h1>\n    </div>\n\n    <el-card shadow=\"hover\" class=\"form-card\">\n      <el-form \n        ref=\"formRef\"\n        :model=\"vulnerabilityForm\" \n        :rules=\"rules\" \n        label-position=\"top\"\n        v-loading=\"loading\"\n      >\n        <!-- 基本信息卡片 -->\n        <div class=\"section-header\">\n          <h2 class=\"section-title\">基本信息</h2>\n        </div>\n\n        <el-row :gutter=\"20\">\n          <el-col :xs=\"24\" :sm=\"24\" :md=\"24\">\n            <el-form-item label=\"漏洞标题\" prop=\"title\">\n              <el-input \n                v-model=\"vulnerabilityForm.title\" \n                placeholder=\"输入漏洞标题，简洁且能清晰表明漏洞类型\"\n              />\n            </el-form-item>\n          </el-col>\n        </el-row>\n\n        <el-row :gutter=\"20\">\n          <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n            <el-form-item label=\"CVE编号\" prop=\"cve\">\n              <el-input \n                v-model=\"vulnerabilityForm.cve\" \n                placeholder=\"例如: CVE-2023-12345（如有）\"\n                clearable\n              />\n            </el-form-item>\n          </el-col>\n          <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n            <el-form-item label=\"严重程度\" prop=\"severity\">\n              <el-select \n                v-model=\"vulnerabilityForm.severity\" \n                placeholder=\"选择漏洞严重程度\" \n                style=\"width: 100%\"\n              >\n                <el-option label=\"严重\" value=\"critical\" />\n                <el-option label=\"高危\" value=\"high\" />\n                <el-option label=\"中危\" value=\"medium\" />\n                <el-option label=\"低危\" value=\"low\" />\n                <el-option label=\"信息\" value=\"info\" />\n              </el-select>\n            </el-form-item>\n          </el-col>\n          <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n            <el-form-item label=\"状态\" prop=\"status\">\n              <el-select \n                v-model=\"vulnerabilityForm.status\" \n                placeholder=\"选择漏洞状态\" \n                style=\"width: 100%\"\n              >\n                <el-option label=\"开放\" value=\"open\" />\n                <el-option label=\"处理中\" value=\"in_progress\" />\n                <el-option label=\"已解决\" value=\"resolved\" />\n                <el-option label=\"已关闭\" value=\"closed\" />\n                <el-option label=\"误报\" value=\"false_positive\" />\n              </el-select>\n            </el-form-item>\n          </el-col>\n        </el-row>\n\n        <el-row :gutter=\"20\">\n          <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n            <el-form-item label=\"发现日期\" prop=\"discoveredAt\">\n              <el-date-picker \n                v-model=\"vulnerabilityForm.discoveredAt\" \n                type=\"date\" \n                placeholder=\"选择漏洞发现日期\"\n                value-format=\"yyyy-MM-dd\"\n                style=\"width: 100%\"\n              />\n            </el-form-item>\n          </el-col>\n          <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n            <el-form-item label=\"CVSS评分\" prop=\"cvss\">\n              <el-input-number \n                v-model=\"vulnerabilityForm.cvss\" \n                :min=\"0\" \n                :max=\"10\" \n                :precision=\"1\" \n                :step=\"0.1\"\n                style=\"width: 100%\"\n              />\n            </el-form-item>\n          </el-col>\n          <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n            <el-form-item label=\"CVSS向量\" prop=\"cvss_vector\">\n              <el-input \n                v-model=\"vulnerabilityForm.cvss_vector\" \n                placeholder=\"例如: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\"\n                clearable\n              />\n            </el-form-item>\n          </el-col>\n        </el-row>\n\n        <!-- 详细描述卡片 -->\n        <div class=\"section-header\">\n          <h2 class=\"section-title\">详细描述</h2>\n        </div>\n\n        <el-form-item label=\"漏洞描述\" prop=\"description\">\n          <el-tabs v-model=\"descriptionTab\">\n            <el-tab-pane label=\"编辑\" name=\"edit\">\n              <el-input \n                v-model=\"vulnerabilityForm.description\" \n                type=\"textarea\" \n                :rows=\"8\"\n                placeholder=\"详细描述漏洞的情况、原理等信息（支持Markdown格式）\"\n              />\n            </el-tab-pane>\n            <el-tab-pane label=\"预览\" name=\"preview\">\n              <div v-if=\"!vulnerabilityForm.description\" class=\"empty-preview\">\n                暂无内容预览\n              </div>\n              <div v-else class=\"markdown-preview\" v-html=\"renderedDescription\"></div>\n            </el-tab-pane>\n          </el-tabs>\n        </el-form-item>\n\n        <el-form-item label=\"影响分析\" prop=\"impact\">\n          <el-tabs v-model=\"impactTab\">\n            <el-tab-pane label=\"编辑\" name=\"edit\">\n              <el-input \n                v-model=\"vulnerabilityForm.impact\" \n                type=\"textarea\" \n                :rows=\"6\"\n                placeholder=\"描述漏洞可能造成的安全影响和危害（支持Markdown格式）\"\n              />\n            </el-tab-pane>\n            <el-tab-pane label=\"预览\" name=\"preview\">\n              <div v-if=\"!vulnerabilityForm.impact\" class=\"empty-preview\">\n                暂无内容预览\n              </div>\n              <div v-else class=\"markdown-preview\" v-html=\"renderedImpact\"></div>\n            </el-tab-pane>\n          </el-tabs>\n        </el-form-item>\n\n        <el-form-item label=\"复现步骤\" prop=\"steps_to_reproduce\">\n          <el-tabs v-model=\"stepsTab\">\n            <el-tab-pane label=\"编辑\" name=\"edit\">\n              <el-input \n                v-model=\"vulnerabilityForm.steps_to_reproduce\" \n                type=\"textarea\" \n                :rows=\"6\"\n                placeholder=\"详细列出漏洞的复现步骤，便于其他人理解和验证（支持Markdown格式）\"\n              />\n            </el-tab-pane>\n            <el-tab-pane label=\"预览\" name=\"preview\">\n              <div v-if=\"!vulnerabilityForm.steps_to_reproduce\" class=\"empty-preview\">\n                暂无内容预览\n              </div>\n              <div v-else class=\"markdown-preview\" v-html=\"renderedSteps\"></div>\n            </el-tab-pane>\n          </el-tabs>\n        </el-form-item>\n\n        <el-form-item label=\"修复建议\" prop=\"recommendation\">\n          <el-tabs v-model=\"recommendationTab\">\n            <el-tab-pane label=\"编辑\" name=\"edit\">\n              <el-input \n                v-model=\"vulnerabilityForm.recommendation\" \n                type=\"textarea\" \n                :rows=\"6\"\n                placeholder=\"提供修复或缓解该漏洞的方法和建议（支持Markdown格式）\"\n              />\n            </el-tab-pane>\n            <el-tab-pane label=\"预览\" name=\"preview\">\n              <div v-if=\"!vulnerabilityForm.recommendation\" class=\"empty-preview\">\n                暂无内容预览\n              </div>\n              <div v-else class=\"markdown-preview\" v-html=\"renderedRecommendation\"></div>\n            </el-tab-pane>\n          </el-tabs>\n        </el-form-item>\n\n        <!-- 额外信息卡片 -->\n        <div class=\"section-header\">\n          <h2 class=\"section-title\">额外信息</h2>\n        </div>\n\n        <el-form-item label=\"受影响资产\" prop=\"affected_assets\">\n          <el-tag\n            v-for=\"(asset, index) in vulnerabilityForm.affected_assets\"\n            :key=\"index\"\n            closable\n            :disable-transitions=\"false\"\n            @close=\"handleRemoveAsset(asset)\"\n            class=\"tag-item\"\n          >\n            {{ asset.name }}\n          </el-tag>\n          <el-button type=\"text\" @click=\"showAssetDialog\" class=\"add-tag-button\">\n            <i class=\"el-icon-plus\"></i> 添加资产\n          </el-button>\n        </el-form-item>\n\n        <el-form-item label=\"参考链接\" prop=\"references\">\n          <div v-for=\"(reference, index) in vulnerabilityForm.references\" :key=\"index\" class=\"reference-item\">\n            <el-input \n              v-model=\"reference.title\" \n              placeholder=\"参考标题\" \n              class=\"reference-title-input\"\n            />\n            <el-input \n              v-model=\"reference.url\" \n              placeholder=\"参考链接URL\" \n              class=\"reference-url-input\"\n            />\n            <el-button \n              type=\"danger\" \n              icon=\"el-icon-delete\" \n              circle \n              size=\"mini\"\n              @click=\"removeReference(index)\"\n            />\n          </div>\n          <el-button type=\"text\" @click=\"addReference\" class=\"add-reference-button\">\n            <i class=\"el-icon-plus\"></i> 添加参考链接\n          </el-button>\n        </el-form-item>\n\n        <el-form-item label=\"标签\" prop=\"tags\">\n          <el-tag\n            v-for=\"tag in vulnerabilityForm.tags\"\n            :key=\"tag\"\n            closable\n            :disable-transitions=\"false\"\n            @close=\"handleRemoveTag(tag)\"\n            class=\"tag-item\"\n          >\n            {{ tag }}\n          </el-tag>\n          <el-input\n            v-if=\"inputTagVisible\"\n            ref=\"tagInputRef\"\n            v-model=\"inputTagValue\"\n            class=\"tag-input\"\n            size=\"small\"\n            @keyup.enter=\"handleInputTagConfirm\"\n            @blur=\"handleInputTagConfirm\"\n          />\n          <el-button v-else type=\"text\" @click=\"showTagInput\" class=\"add-tag-button\">\n            <i class=\"el-icon-plus\"></i> 添加标签\n          </el-button>\n        </el-form-item>\n\n        <el-divider />\n\n        <div class=\"form-actions\">\n          <el-button @click=\"goBack\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"submitting\">创建漏洞</el-button>\n        </div>\n      </el-form>\n    </el-card>\n\n    <!-- 添加资产对话框 -->\n    <el-dialog\n      title=\"添加受影响资产\"\n      v-model=\"assetDialogVisible\"\n      width=\"500px\"\n    >\n      <el-form :model=\"assetForm\" label-position=\"top\">\n        <el-form-item label=\"资产名称\" required>\n          <el-input v-model=\"assetForm.name\" placeholder=\"输入资产名称\" />\n        </el-form-item>\n        <el-form-item label=\"资产详情\">\n          <el-input \n            v-model=\"assetForm.details\" \n            type=\"textarea\" \n            :rows=\"3\"\n            placeholder=\"对资产的详细描述，如版本、位置等\"\n          />\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"assetDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"handleAddAsset\">添加</el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, computed, nextTick, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { marked } from 'marked'\nimport DOMPurify from 'dompurify'\n\nexport default {\n  name: 'VulnerabilityCreate',\n  \n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const formRef = ref(null)\n    \n    const loading = ref(false)\n    const submitting = ref(false)\n    \n    // Markdown 编辑的标签页状态\n    const descriptionTab = ref('edit')\n    const impactTab = ref('edit')\n    const stepsTab = ref('edit')\n    const recommendationTab = ref('edit')\n    \n    // 标签输入相关\n    const tagInputRef = ref(null)\n    const inputTagVisible = ref(false)\n    const inputTagValue = ref('')\n    \n    // 资产对话框\n    const assetDialogVisible = ref(false)\n    const assetForm = reactive({\n      name: '',\n      details: ''\n    })\n    \n    // 漏洞表单数据\n    const vulnerabilityForm = reactive({\n      title: '',\n      description: '',\n      impact: '',\n      steps_to_reproduce: '',\n      recommendation: '',\n      severity: 'medium',\n      status: 'open',\n      cve: '',\n      cvss: 0,\n      cvss_vector: '',\n      discoveredAt: new Date().toISOString().slice(0, 10),\n      affected_assets: [],\n      references: [],\n      tags: []\n    })\n    \n    // 表单验证规则\n    const rules = {\n      title: [\n        { required: true, message: '请输入漏洞标题', trigger: 'blur' },\n        { min: 3, max: 200, message: '长度在 3 到 200 个字符', trigger: 'blur' }\n      ],\n      description: [\n        { required: true, message: '请输入漏洞描述', trigger: 'blur' }\n      ],\n      severity: [\n        { required: true, message: '请选择严重程度', trigger: 'change' }\n      ],\n      status: [\n        { required: true, message: '请选择漏洞状态', trigger: 'change' }\n      ],\n      discoveredAt: [\n        { required: true, message: '请选择发现日期', trigger: 'change' }\n      ]\n    }\n    \n    // Markdown 渲染\n    const renderedDescription = computed(() => {\n      if (!vulnerabilityForm.description) return ''\n      return DOMPurify.sanitize(marked.parse(vulnerabilityForm.description))\n    })\n    \n    const renderedImpact = computed(() => {\n      if (!vulnerabilityForm.impact) return ''\n      return DOMPurify.sanitize(marked.parse(vulnerabilityForm.impact))\n    })\n    \n    const renderedSteps = computed(() => {\n      if (!vulnerabilityForm.steps_to_reproduce) return ''\n      return DOMPurify.sanitize(marked.parse(vulnerabilityForm.steps_to_reproduce))\n    })\n    \n    const renderedRecommendation = computed(() => {\n      if (!vulnerabilityForm.recommendation) return ''\n      return DOMPurify.sanitize(marked.parse(vulnerabilityForm.recommendation))\n    })\n    \n    // 返回列表\n    const goBack = () => {\n      if (formHasChanges()) {\n        ElMessageBox.confirm(\n          '表单内容已修改，确定要离开吗？',\n          '提示',\n          {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }\n        ).then(() => {\n          router.push('/vulnerabilities')\n        }).catch(() => {\n          // 用户取消\n        })\n      } else {\n        router.push('/vulnerabilities')\n      }\n    }\n    \n    // 判断表单是否有修改\n    const formHasChanges = () => {\n      return vulnerabilityForm.title ||\n        vulnerabilityForm.description ||\n        vulnerabilityForm.impact ||\n        vulnerabilityForm.steps_to_reproduce ||\n        vulnerabilityForm.recommendation ||\n        vulnerabilityForm.cvss !== 0 ||\n        vulnerabilityForm.cve ||\n        vulnerabilityForm.cvss_vector ||\n        vulnerabilityForm.affected_assets.length > 0 ||\n        vulnerabilityForm.references.length > 0 ||\n        vulnerabilityForm.tags.length > 0\n    }\n    \n    // 提交表单\n    const submitForm = async () => {\n      if (!formRef.value) return\n      \n      try {\n        await formRef.value.validate()\n        \n        submitting.value = true\n        \n        // 准备提交的数据\n        const vulnerabilityData = { ...vulnerabilityForm }\n        \n        try {\n          // 创建漏洞\n          await store.dispatch('vulnerability/createVulnerability', vulnerabilityData)\n          \n          ElMessage({\n            type: 'success',\n            message: '漏洞创建成功'\n          })\n          \n          router.push('/vulnerabilities')\n        } catch (error) {\n          ElMessage({\n            type: 'error',\n            message: '创建漏洞失败: ' + (error.message || '未知错误')\n          })\n        } finally {\n          submitting.value = false\n        }\n      } catch (error) {\n        ElMessage({\n          type: 'warning',\n          message: '请完善表单信息'\n        })\n      }\n    }\n    \n    // 标签相关方法\n    const showTagInput = () => {\n      inputTagVisible.value = true\n      nextTick(() => {\n        tagInputRef.value?.focus()\n      })\n    }\n    \n    const handleInputTagConfirm = () => {\n      const inputValue = inputTagValue.value.trim()\n      if (inputValue && !vulnerabilityForm.tags.includes(inputValue)) {\n        vulnerabilityForm.tags.push(inputValue)\n      }\n      inputTagVisible.value = false\n      inputTagValue.value = ''\n    }\n    \n    const handleRemoveTag = (tag) => {\n      vulnerabilityForm.tags.splice(vulnerabilityForm.tags.indexOf(tag), 1)\n    }\n    \n    // 资产相关方法\n    const showAssetDialog = () => {\n      assetForm.name = ''\n      assetForm.details = ''\n      assetDialogVisible.value = true\n    }\n    \n    const handleAddAsset = () => {\n      if (!assetForm.name.trim()) {\n        ElMessage({\n          type: 'warning',\n          message: '请输入资产名称'\n        })\n        return\n      }\n      \n      vulnerabilityForm.affected_assets.push({\n        name: assetForm.name.trim(),\n        details: assetForm.details.trim()\n      })\n      \n      assetDialogVisible.value = false\n    }\n    \n    const handleRemoveAsset = (asset) => {\n      const index = vulnerabilityForm.affected_assets.findIndex(a => a.name === asset.name)\n      if (index !== -1) {\n        vulnerabilityForm.affected_assets.splice(index, 1)\n      }\n    }\n    \n    // 参考链接相关方法\n    const addReference = () => {\n      vulnerabilityForm.references.push({ title: '', url: '' })\n    }\n    \n    const removeReference = (index) => {\n      vulnerabilityForm.references.splice(index, 1)\n    }\n    \n    return {\n      formRef,\n      loading,\n      submitting,\n      vulnerabilityForm,\n      rules,\n      descriptionTab,\n      impactTab,\n      stepsTab,\n      recommendationTab,\n      inputTagVisible,\n      inputTagValue,\n      tagInputRef,\n      assetDialogVisible,\n      assetForm,\n      renderedDescription,\n      renderedImpact,\n      renderedSteps,\n      renderedRecommendation,\n      goBack,\n      submitForm,\n      showTagInput,\n      handleInputTagConfirm,\n      handleRemoveTag,\n      showAssetDialog,\n      handleAddAsset,\n      handleRemoveAsset,\n      addReference,\n      removeReference\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.vulnerability-create-page {\n  margin-bottom: 40px;\n}\n\n.page-header {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 24px;\n}\n\n.header-back {\n  margin-bottom: 12px;\n}\n\n.page-title {\n  font-size: 24px;\n  font-weight: 600;\n  margin: 0;\n  color: #303133;\n}\n\n.form-card {\n  margin-bottom: 24px;\n}\n\n.section-header {\n  margin: 24px 0 16px;\n  \n  &:first-child {\n    margin-top: 0;\n  }\n}\n\n.section-title {\n  font-size: 18px;\n  font-weight: 600;\n  margin: 0;\n  padding-bottom: 8px;\n  border-bottom: 1px solid #EBEEF5;\n  color: #303133;\n}\n\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 24px;\n}\n\n.tag-item {\n  margin-right: 8px;\n  margin-bottom: 8px;\n}\n\n.tag-input {\n  width: 200px;\n  margin-bottom: 8px;\n  vertical-align: bottom;\n}\n\n.add-tag-button {\n  margin-top: 8px;\n}\n\n.reference-item {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  gap: 12px;\n}\n\n.reference-title-input {\n  width: 30%;\n}\n\n.reference-url-input {\n  flex: 1;\n}\n\n.add-reference-button {\n  margin-bottom: 12px;\n}\n\n.empty-preview {\n  color: #909399;\n  padding: 16px;\n  background-color: #F5F7FA;\n  border-radius: 4px;\n  font-style: italic;\n}\n\n// Markdown预览样式\n.markdown-preview {\n  padding: 16px;\n  background-color: #F5F7FA;\n  border-radius: 4px;\n  line-height: 1.6;\n  \n  h1, h2, h3, h4, h5, h6 {\n    margin-top: 24px;\n    margin-bottom: 16px;\n    font-weight: 600;\n    line-height: 1.25;\n  }\n  \n  h1 {\n    font-size: 2em;\n  }\n  \n  h2 {\n    font-size: 1.5em;\n  }\n  \n  h3 {\n    font-size: 1.25em;\n  }\n  \n  p, blockquote, ul, ol, dl, table, pre {\n    margin-top: 0;\n    margin-bottom: 16px;\n  }\n  \n  ul, ol {\n    padding-left: 2em;\n  }\n  \n  li + li {\n    margin-top: 0.25em;\n  }\n  \n  code {\n    font-family: SFMono-Regular, Consolas, \"Liberation Mono\", Menlo, monospace;\n    padding: 0.2em 0.4em;\n    margin: 0;\n    font-size: 85%;\n    background-color: rgba(27, 31, 35, 0.05);\n    border-radius: 3px;\n  }\n  \n  pre {\n    font-family: SFMono-Regular, Consolas, \"Liberation Mono\", Menlo, monospace;\n    word-wrap: normal;\n    padding: 16px;\n    overflow: auto;\n    font-size: 85%;\n    line-height: 1.45;\n    background-color: #f6f8fa;\n    border-radius: 3px;\n    \n    code {\n      background-color: transparent;\n      padding: 0;\n      margin: 0;\n      font-size: 100%;\n      word-break: normal;\n      white-space: pre;\n      border: 0;\n    }\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}