{"ast":null,"code":"import \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, resolveDirective as _resolveDirective, openBlock as _openBlock, createBlock as _createBlock, withDirectives as _withDirectives, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"vulnerability-list\"\n};\nvar _hoisted_2 = {\n  \"class\": \"page-header\"\n};\nvar _hoisted_3 = {\n  \"class\": \"header-actions\"\n};\nvar _hoisted_4 = {\n  \"class\": \"pagination-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_button = _resolveComponent(\"el-button\");\n  var _component_el_option = _resolveComponent(\"el-option\");\n  var _component_el_select = _resolveComponent(\"el-select\");\n  var _component_el_form_item = _resolveComponent(\"el-form-item\");\n  var _component_el_input = _resolveComponent(\"el-input\");\n  var _component_el_form = _resolveComponent(\"el-form\");\n  var _component_el_card = _resolveComponent(\"el-card\");\n  var _component_router_link = _resolveComponent(\"router-link\");\n  var _component_el_table_column = _resolveComponent(\"el-table-column\");\n  var _component_el_tag = _resolveComponent(\"el-tag\");\n  var _component_el_table = _resolveComponent(\"el-table\");\n  var _component_el_pagination = _resolveComponent(\"el-pagination\");\n  var _directive_loading = _resolveDirective(\"loading\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[7] || (_cache[7] = _createElementVNode(\"div\", null, [_createElementVNode(\"h1\", {\n    \"class\": \"page-title\"\n  }, \"漏洞列表\"), _createElementVNode(\"p\", {\n    \"class\": \"page-subtitle\"\n  }, \"查看和管理所有漏洞信息\")], -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_button, {\n    type: \"primary\",\n    onClick: $setup.goToCreate\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[5] || (_cache[5] = [_createTextVNode(\" 添加漏洞 \")]);\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n    onClick: $setup.goToImport\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[6] || (_cache[6] = [_createTextVNode(\" 导入漏洞 \")]);\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])])]), _createCommentVNode(\" 过滤和搜索区域 \"), _createVNode(_component_el_card, {\n    shadow: \"hover\",\n    \"class\": \"filter-card\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_el_form, {\n        inline: true,\n        model: $setup.searchParams,\n        \"class\": \"search-form\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_el_form_item, {\n            label: \"严重程度\"\n          }, {\n            \"default\": _withCtx(function () {\n              return [_createVNode(_component_el_select, {\n                modelValue: $setup.searchParams.severity,\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n                  return $setup.searchParams.severity = $event;\n                }),\n                placeholder: \"选择严重程度\",\n                clearable: \"\"\n              }, {\n                \"default\": _withCtx(function () {\n                  return [_createVNode(_component_el_option, {\n                    label: \"严重\",\n                    value: \"critical\"\n                  }), _createVNode(_component_el_option, {\n                    label: \"高危\",\n                    value: \"high\"\n                  }), _createVNode(_component_el_option, {\n                    label: \"中危\",\n                    value: \"medium\"\n                  }), _createVNode(_component_el_option, {\n                    label: \"低危\",\n                    value: \"low\"\n                  }), _createVNode(_component_el_option, {\n                    label: \"信息\",\n                    value: \"info\"\n                  })];\n                }),\n                _: 1 /* STABLE */\n              }, 8 /* PROPS */, [\"modelValue\"])];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_form_item, {\n            label: \"状态\"\n          }, {\n            \"default\": _withCtx(function () {\n              return [_createVNode(_component_el_select, {\n                modelValue: $setup.searchParams.status,\n                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n                  return $setup.searchParams.status = $event;\n                }),\n                placeholder: \"选择状态\",\n                clearable: \"\"\n              }, {\n                \"default\": _withCtx(function () {\n                  return [_createVNode(_component_el_option, {\n                    label: \"开放\",\n                    value: \"open\"\n                  }), _createVNode(_component_el_option, {\n                    label: \"处理中\",\n                    value: \"in_progress\"\n                  }), _createVNode(_component_el_option, {\n                    label: \"已解决\",\n                    value: \"resolved\"\n                  }), _createVNode(_component_el_option, {\n                    label: \"已关闭\",\n                    value: \"closed\"\n                  }), _createVNode(_component_el_option, {\n                    label: \"误报\",\n                    value: \"false_positive\"\n                  })];\n                }),\n                _: 1 /* STABLE */\n              }, 8 /* PROPS */, [\"modelValue\"])];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_form_item, {\n            label: \"搜索\"\n          }, {\n            \"default\": _withCtx(function () {\n              return [_createVNode(_component_el_input, {\n                modelValue: $setup.searchParams.searchTerm,\n                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n                  return $setup.searchParams.searchTerm = $event;\n                }),\n                placeholder: \"搜索标题、描述或CVE编号\",\n                clearable: \"\"\n              }, null, 8 /* PROPS */, [\"modelValue\"])];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_form_item, null, {\n            \"default\": _withCtx(function () {\n              return [_createVNode(_component_el_button, {\n                type: \"primary\",\n                onClick: $setup.search\n              }, {\n                \"default\": _withCtx(function () {\n                  return _cache[8] || (_cache[8] = [_createTextVNode(\"搜索\")]);\n                }),\n                _: 1 /* STABLE */\n              }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n                onClick: $setup.resetSearch\n              }, {\n                \"default\": _withCtx(function () {\n                  return _cache[9] || (_cache[9] = [_createTextVNode(\"重置\")]);\n                }),\n                _: 1 /* STABLE */\n              }, 8 /* PROPS */, [\"onClick\"])];\n            }),\n            _: 1 /* STABLE */\n          })];\n        }),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"model\"])];\n    }),\n    _: 1 /* STABLE */\n  }), _createCommentVNode(\" 漏洞列表 \"), _createVNode(_component_el_card, {\n    shadow: \"hover\",\n    \"class\": \"vuln-table-card\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_withDirectives((_openBlock(), _createBlock(_component_el_table, {\n        data: $setup.vulnerabilities,\n        border: \"\",\n        style: {\n          \"width\": \"100%\"\n        },\n        onSortChange: $setup.handleSortChange\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_el_table_column, {\n            prop: \"title\",\n            label: \"标题\",\n            \"min-width\": \"200\",\n            sortable: \"custom\"\n          }, {\n            \"default\": _withCtx(function (scope) {\n              return [_createVNode(_component_router_link, {\n                to: \"/vulnerabilities/\".concat(scope.row.id),\n                \"class\": \"vuln-link\"\n              }, {\n                \"default\": _withCtx(function () {\n                  return [_createTextVNode(_toDisplayString(scope.row.title), 1 /* TEXT */)];\n                }),\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"])];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_table_column, {\n            prop: \"severity\",\n            label: \"严重程度\",\n            width: \"120\",\n            sortable: \"custom\"\n          }, {\n            \"default\": _withCtx(function (scope) {\n              return [_createVNode(_component_el_tag, {\n                type: _ctx.$filters.severityClass(scope.row.severity)\n              }, {\n                \"default\": _withCtx(function () {\n                  return [_createTextVNode(_toDisplayString(_ctx.$filters.severityText(scope.row.severity)), 1 /* TEXT */)];\n                }),\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"type\"])];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_table_column, {\n            prop: \"status\",\n            label: \"状态\",\n            width: \"120\",\n            sortable: \"custom\"\n          }, {\n            \"default\": _withCtx(function (scope) {\n              return [_createVNode(_component_el_tag, {\n                type: _ctx.$filters.statusClass(scope.row.status)\n              }, {\n                \"default\": _withCtx(function () {\n                  return [_createTextVNode(_toDisplayString(_ctx.$filters.statusText(scope.row.status)), 1 /* TEXT */)];\n                }),\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"type\"])];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_table_column, {\n            prop: \"cve\",\n            label: \"CVE编号\",\n            width: \"150\"\n          }), _createVNode(_component_el_table_column, {\n            prop: \"cvss\",\n            label: \"CVSS评分\",\n            width: \"120\",\n            sortable: \"custom\"\n          }, {\n            \"default\": _withCtx(function (scope) {\n              var _scope$row$cvss;\n              return [_createElementVNode(\"span\", {\n                \"class\": _normalizeClass([\"cvss-score\", $setup.getCvssClass(scope.row.cvss)])\n              }, _toDisplayString(((_scope$row$cvss = scope.row.cvss) === null || _scope$row$cvss === void 0 ? void 0 : _scope$row$cvss.toFixed(1)) || '-'), 3 /* TEXT, CLASS */)];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_table_column, {\n            prop: \"discoveredAt\",\n            label: \"发现时间\",\n            width: \"180\",\n            sortable: \"custom\"\n          }, {\n            \"default\": _withCtx(function (scope) {\n              return [_createTextVNode(_toDisplayString(_ctx.$filters.formatDate(scope.row.discoveredAt)), 1 /* TEXT */)];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_table_column, {\n            label: \"操作\",\n            width: \"150\",\n            fixed: \"right\"\n          }, {\n            \"default\": _withCtx(function (scope) {\n              return [_createVNode(_component_el_button, {\n                size: \"small\",\n                type: \"primary\",\n                link: \"\",\n                onClick: function onClick($event) {\n                  return $setup.viewDetails(scope.row.id);\n                }\n              }, {\n                \"default\": _withCtx(function () {\n                  return _cache[10] || (_cache[10] = [_createTextVNode(\" 查看 \")]);\n                }),\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_el_button, {\n                size: \"small\",\n                type: \"danger\",\n                link: \"\",\n                onClick: function onClick($event) {\n                  return $setup.confirmDelete(scope.row);\n                }\n              }, {\n                \"default\": _withCtx(function () {\n                  return _cache[11] || (_cache[11] = [_createTextVNode(\" 删除 \")]);\n                }),\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])];\n            }),\n            _: 1 /* STABLE */\n          })];\n        }),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"data\", \"onSortChange\"])), [[_directive_loading, $setup.loading]]), _createCommentVNode(\" 分页 \"), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_pagination, {\n        currentPage: $setup.searchParams.page,\n        \"onUpdate:currentPage\": _cache[3] || (_cache[3] = function ($event) {\n          return $setup.searchParams.page = $event;\n        }),\n        \"page-size\": $setup.searchParams.perPage,\n        \"onUpdate:pageSize\": _cache[4] || (_cache[4] = function ($event) {\n          return $setup.searchParams.perPage = $event;\n        }),\n        \"page-sizes\": [10, 20, 50, 100],\n        layout: \"total, sizes, prev, pager, next, jumper\",\n        total: $setup.pagination.total,\n        onSizeChange: $setup.handleSizeChange,\n        onCurrentChange: $setup.handleCurrentChange\n      }, null, 8 /* PROPS */, [\"currentPage\", \"page-size\", \"total\", \"onSizeChange\", \"onCurrentChange\"])])];\n    }),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_el_button","type","onClick","$setup","goToCreate","_withCtx","_cache","_createTextVNode","_","goToImport","_createCommentVNode","_component_el_card","shadow","_component_el_form","inline","model","searchParams","_component_el_form_item","label","_component_el_select","modelValue","severity","$event","placeholder","clearable","_component_el_option","value","status","_component_el_input","searchTerm","search","resetSearch","_createBlock","_component_el_table","data","vulnerabilities","border","style","onSortChange","handleSortChange","_component_el_table_column","prop","sortable","scope","_component_router_link","to","concat","row","id","_toDisplayString","title","width","_component_el_tag","_ctx","$filters","severityClass","severityText","statusClass","statusText","_scope$row$cvss","_normalizeClass","getCvssClass","cvss","toFixed","formatDate","discoveredAt","fixed","size","link","viewDetails","confirmDelete","loading","_hoisted_4","_component_el_pagination","currentPage","page","perPage","layout","total","pagination","onSizeChange","handleSizeChange","onCurrentChange","handleCurrentChange"],"sources":["/Users/yue/Desktop/vuln-Management/frontend/src/views/vulnerabilities/VulnerabilityList.vue"],"sourcesContent":["<template>\n  <div class=\"vulnerability-list\">\n    <div class=\"page-header\">\n      <div>\n        <h1 class=\"page-title\">漏洞列表</h1>\n        <p class=\"page-subtitle\">查看和管理所有漏洞信息</p>\n      </div>\n      <div class=\"header-actions\">\n        <el-button type=\"primary\" @click=\"goToCreate\">\n          添加漏洞\n        </el-button>\n        <el-button @click=\"goToImport\">\n          导入漏洞\n        </el-button>\n      </div>\n    </div>\n\n    <!-- 过滤和搜索区域 -->\n    <el-card shadow=\"hover\" class=\"filter-card\">\n      <el-form :inline=\"true\" :model=\"searchParams\" class=\"search-form\">\n        <el-form-item label=\"严重程度\">\n          <el-select v-model=\"searchParams.severity\" placeholder=\"选择严重程度\" clearable>\n            <el-option label=\"严重\" value=\"critical\" />\n            <el-option label=\"高危\" value=\"high\" />\n            <el-option label=\"中危\" value=\"medium\" />\n            <el-option label=\"低危\" value=\"low\" />\n            <el-option label=\"信息\" value=\"info\" />\n          </el-select>\n        </el-form-item>\n        \n        <el-form-item label=\"状态\">\n          <el-select v-model=\"searchParams.status\" placeholder=\"选择状态\" clearable>\n            <el-option label=\"开放\" value=\"open\" />\n            <el-option label=\"处理中\" value=\"in_progress\" />\n            <el-option label=\"已解决\" value=\"resolved\" />\n            <el-option label=\"已关闭\" value=\"closed\" />\n            <el-option label=\"误报\" value=\"false_positive\" />\n          </el-select>\n        </el-form-item>\n        \n        <el-form-item label=\"搜索\">\n          <el-input \n            v-model=\"searchParams.searchTerm\" \n            placeholder=\"搜索标题、描述或CVE编号\"\n            clearable\n          />\n        </el-form-item>\n        \n        <el-form-item>\n          <el-button type=\"primary\" @click=\"search\">搜索</el-button>\n          <el-button @click=\"resetSearch\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n\n    <!-- 漏洞列表 -->\n    <el-card shadow=\"hover\" class=\"vuln-table-card\">\n      <el-table \n        v-loading=\"loading\"\n        :data=\"vulnerabilities\" \n        border \n        style=\"width: 100%\"\n        @sort-change=\"handleSortChange\"\n      >\n        <el-table-column prop=\"title\" label=\"标题\" min-width=\"200\" sortable=\"custom\">\n          <template #default=\"scope\">\n            <router-link :to=\"`/vulnerabilities/${scope.row.id}`\" class=\"vuln-link\">\n              {{ scope.row.title }}\n            </router-link>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"severity\" label=\"严重程度\" width=\"120\" sortable=\"custom\">\n          <template #default=\"scope\">\n            <el-tag :type=\"$filters.severityClass(scope.row.severity)\">\n              {{ $filters.severityText(scope.row.severity) }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"status\" label=\"状态\" width=\"120\" sortable=\"custom\">\n          <template #default=\"scope\">\n            <el-tag :type=\"$filters.statusClass(scope.row.status)\">\n              {{ $filters.statusText(scope.row.status) }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"cve\" label=\"CVE编号\" width=\"150\" />\n        \n        <el-table-column prop=\"cvss\" label=\"CVSS评分\" width=\"120\" sortable=\"custom\">\n          <template #default=\"scope\">\n            <span class=\"cvss-score\" :class=\"getCvssClass(scope.row.cvss)\">\n              {{ scope.row.cvss?.toFixed(1) || '-' }}\n            </span>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"discoveredAt\" label=\"发现时间\" width=\"180\" sortable=\"custom\">\n          <template #default=\"scope\">\n            {{ $filters.formatDate(scope.row.discoveredAt) }}\n          </template>\n        </el-table-column>\n        \n        <el-table-column label=\"操作\" width=\"150\" fixed=\"right\">\n          <template #default=\"scope\">\n            <el-button \n              size=\"small\" \n              type=\"primary\" \n              link\n              @click=\"viewDetails(scope.row.id)\"\n            >\n              查看\n            </el-button>\n            <el-button \n              size=\"small\" \n              type=\"danger\" \n              link\n              @click=\"confirmDelete(scope.row)\"\n            >\n              删除\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      \n      <!-- 分页 -->\n      <div class=\"pagination-container\">\n        <el-pagination\n          v-model:currentPage=\"searchParams.page\"\n          v-model:page-size=\"searchParams.perPage\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"pagination.total\"\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n        />\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { reactive, computed, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport { ElMessageBox, ElMessage } from 'element-plus'\n\nexport default {\n  name: 'VulnerabilityList',\n  \n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const loading = computed(() => store.getters['vulnerability/isLoading'])\n    \n    // 搜索参数\n    const searchParams = reactive({\n      severity: '',\n      status: '',\n      assignedTo: '',\n      searchTerm: '',\n      sortBy: 'createdAt',\n      sortOrder: 'desc',\n      page: 1,\n      perPage: 10\n    })\n    \n    // 获取漏洞列表和分页信息\n    const vulnerabilities = computed(() => store.getters['vulnerability/allVulnerabilities'])\n    const pagination = computed(() => store.getters['vulnerability/pagination'])\n    \n    // 搜索方法\n    const search = () => {\n      store.dispatch('vulnerability/updateSearchParams', { ...searchParams })\n    }\n    \n    // 重置搜索条件\n    const resetSearch = () => {\n      Object.assign(searchParams, {\n        severity: '',\n        status: '',\n        assignedTo: '',\n        searchTerm: '',\n        sortBy: 'createdAt',\n        sortOrder: 'desc',\n        page: 1\n      })\n      search()\n    }\n    \n    // 处理表格排序变化\n    const handleSortChange = ({ prop, order }) => {\n      if (!prop) return\n      \n      // 映射前端属性名到后端字段名\n      const fieldMapping = {\n        'title': 'title',\n        'severity': 'severity',\n        'status': 'status',\n        'cvss': 'cvss',\n        'discoveredAt': 'discoveredAt',\n        'createdAt': 'createdAt'\n      }\n      \n      // 转换排序字段和顺序\n      const sortBy = fieldMapping[prop] || 'createdAt'\n      const sortOrder = order === 'ascending' ? 'asc' : 'desc'\n      \n      // 更新搜索参数并重新获取数据\n      store.dispatch('vulnerability/updateSearchParams', {\n        sortBy,\n        sortOrder\n      })\n    }\n    \n    // 处理分页大小变化\n    const handleSizeChange = (newSize) => {\n      store.dispatch('vulnerability/updateSearchParams', {\n        perPage: newSize\n      })\n    }\n    \n    // 处理页码变化\n    const handleCurrentChange = (newPage) => {\n      store.dispatch('vulnerability/updateSearchParams', {\n        page: newPage\n      })\n    }\n    \n    // 查看漏洞详情\n    const viewDetails = (id) => {\n      router.push(`/vulnerabilities/${id}`)\n    }\n    \n    // 跳转到创建页面\n    const goToCreate = () => {\n      router.push('/vulnerabilities/create')\n    }\n    \n    // 跳转到导入页面\n    const goToImport = () => {\n      router.push('/vulnerabilities/import')\n    }\n    \n    // 确认删除对话框\n    const confirmDelete = (row) => {\n      ElMessageBox.confirm(\n        `确定要删除漏洞 \"${row.title}\" 吗？`,\n        '警告',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }\n      ).then(() => {\n        // 执行删除操作\n        deleteVulnerability(row.id)\n      }).catch(() => {\n        // 取消删除\n        ElMessage({\n          type: 'info',\n          message: '已取消删除'\n        })\n      })\n    }\n    \n    // 删除漏洞\n    const deleteVulnerability = async (id) => {\n      try {\n        await store.dispatch('vulnerability/deleteVulnerability', id)\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        })\n      } catch (error) {\n        ElMessage({\n          type: 'error',\n          message: '删除失败: ' + (error.message || '未知错误')\n        })\n      }\n    }\n    \n    // 根据CVSS评分获取颜色类\n    const getCvssClass = (score) => {\n      if (!score) return ''\n      if (score >= 9.0) return 'critical'\n      if (score >= 7.0) return 'high'\n      if (score >= 4.0) return 'medium'\n      if (score >= 0.1) return 'low'\n      return ''\n    }\n    \n    // 组件挂载时获取数据\n    onMounted(() => {\n      store.dispatch('vulnerability/fetchVulnerabilities')\n    })\n    \n    return {\n      loading,\n      searchParams,\n      vulnerabilities,\n      pagination,\n      search,\n      resetSearch,\n      handleSortChange,\n      handleSizeChange,\n      handleCurrentChange,\n      viewDetails,\n      goToCreate,\n      goToImport,\n      confirmDelete,\n      getCvssClass\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.vulnerability-list {\n  margin-bottom: 40px;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n  flex-wrap: wrap;\n  gap: 16px;\n}\n\n.header-actions {\n  display: flex;\n  gap: 12px;\n}\n\n.filter-card {\n  margin-bottom: 24px;\n}\n\n.search-form {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n}\n\n.vuln-table-card {\n  margin-bottom: 24px;\n}\n\n.pagination-container {\n  margin-top: 20px;\n  display: flex;\n  justify-content: flex-end;\n}\n\n.vuln-link {\n  color: #409EFF;\n  text-decoration: none;\n  font-weight: 500;\n  \n  &:hover {\n    text-decoration: underline;\n  }\n}\n\n.cvss-score {\n  font-weight: 600;\n  \n  &.critical {\n    color: #F56C6C;\n  }\n  \n  &.high {\n    color: #E6A23C;\n  }\n  \n  &.medium {\n    color: #F2D864;\n  }\n  \n  &.low {\n    color: #67C23A;\n  }\n}\n\n@media (max-width: 768px) {\n  .page-header {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n  \n  .search-form {\n    flex-direction: column;\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}