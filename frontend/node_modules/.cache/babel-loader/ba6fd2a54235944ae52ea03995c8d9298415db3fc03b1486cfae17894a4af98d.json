{"ast":null,"code":"import _regeneratorRuntime from \"/Users/yue/Desktop/vuln-Management/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"/Users/yue/Desktop/vuln-Management/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/Users/yue/Desktop/vuln-Management/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.date.to-iso-string.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.trim.js\";\nimport { ref, reactive, computed, nextTick } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nexport default {\n  name: 'VulnerabilityCreate',\n  setup: function setup() {\n    var store = useStore();\n    var router = useRouter();\n    var formRef = ref(null);\n    var loading = ref(false);\n    var submitting = ref(false);\n\n    // Markdown 编辑的标签页状态\n    var descriptionTab = ref('edit');\n    var impactTab = ref('edit');\n    var stepsTab = ref('edit');\n    var recommendationTab = ref('edit');\n\n    // 标签输入相关\n    var tagInputRef = ref(null);\n    var inputTagVisible = ref(false);\n    var inputTagValue = ref('');\n\n    // 资产对话框\n    var assetDialogVisible = ref(false);\n    var assetForm = reactive({\n      name: '',\n      details: ''\n    });\n\n    // 漏洞表单数据\n    var vulnerabilityForm = reactive({\n      title: '',\n      description: '',\n      impact: '',\n      steps_to_reproduce: '',\n      recommendation: '',\n      severity: 'medium',\n      status: 'open',\n      cve: '',\n      cvss: 0,\n      cvss_vector: '',\n      discoveredAt: new Date().toISOString().slice(0, 10),\n      affected_assets: [],\n      references: [],\n      tags: []\n    });\n\n    // 表单验证规则\n    var rules = {\n      title: [{\n        required: true,\n        message: '请输入漏洞标题',\n        trigger: 'blur'\n      }, {\n        min: 3,\n        max: 200,\n        message: '长度在 3 到 200 个字符',\n        trigger: 'blur'\n      }],\n      description: [{\n        required: true,\n        message: '请输入漏洞描述',\n        trigger: 'blur'\n      }],\n      severity: [{\n        required: true,\n        message: '请选择严重程度',\n        trigger: 'change'\n      }],\n      status: [{\n        required: true,\n        message: '请选择漏洞状态',\n        trigger: 'change'\n      }],\n      discoveredAt: [{\n        required: true,\n        message: '请选择发现日期',\n        trigger: 'change'\n      }]\n    };\n\n    // 简化的内容渲染，不使用marked和dompurify\n    var renderedDescription = computed(function () {\n      if (!vulnerabilityForm.description) return '';\n      return \"<p>\".concat(vulnerabilityForm.description, \"</p>\");\n    });\n    var renderedImpact = computed(function () {\n      if (!vulnerabilityForm.impact) return '';\n      return \"<p>\".concat(vulnerabilityForm.impact, \"</p>\");\n    });\n    var renderedSteps = computed(function () {\n      if (!vulnerabilityForm.steps_to_reproduce) return '';\n      return \"<p>\".concat(vulnerabilityForm.steps_to_reproduce, \"</p>\");\n    });\n    var renderedRecommendation = computed(function () {\n      if (!vulnerabilityForm.recommendation) return '';\n      return \"<p>\".concat(vulnerabilityForm.recommendation, \"</p>\");\n    });\n\n    // 返回列表\n    var goBack = function goBack() {\n      if (formHasChanges()) {\n        ElMessageBox.confirm('表单内容已修改，确定要离开吗？', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(function () {\n          router.push('/vulnerabilities');\n        })[\"catch\"](function () {\n          // 用户取消\n        });\n      } else {\n        router.push('/vulnerabilities');\n      }\n    };\n\n    // 判断表单是否有修改\n    var formHasChanges = function formHasChanges() {\n      return vulnerabilityForm.title || vulnerabilityForm.description || vulnerabilityForm.impact || vulnerabilityForm.steps_to_reproduce || vulnerabilityForm.recommendation || vulnerabilityForm.cvss !== 0 || vulnerabilityForm.cve || vulnerabilityForm.cvss_vector || vulnerabilityForm.affected_assets.length > 0 || vulnerabilityForm.references.length > 0 || vulnerabilityForm.tags.length > 0;\n    };\n\n    // 提交表单\n    var submitForm = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var vulnerabilityData;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              if (formRef.value) {\n                _context.next = 2;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 2:\n              _context.prev = 2;\n              _context.next = 5;\n              return formRef.value.validate();\n            case 5:\n              submitting.value = true;\n\n              // 准备提交的数据\n              vulnerabilityData = _objectSpread({}, vulnerabilityForm);\n              _context.prev = 7;\n              _context.next = 10;\n              return store.dispatch('vulnerability/createVulnerability', vulnerabilityData);\n            case 10:\n              // 刷新仪表盘数据\n              store.dispatch('dashboard/fetchDashboardData');\n              ElMessage({\n                type: 'success',\n                message: '漏洞创建成功'\n              });\n              router.push('/vulnerabilities');\n              _context.next = 18;\n              break;\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](7);\n              ElMessage({\n                type: 'error',\n                message: '创建漏洞失败: ' + (_context.t0.message || '未知错误')\n              });\n            case 18:\n              _context.prev = 18;\n              submitting.value = false;\n              return _context.finish(18);\n            case 21:\n              _context.next = 26;\n              break;\n            case 23:\n              _context.prev = 23;\n              _context.t1 = _context[\"catch\"](2);\n              ElMessage({\n                type: 'warning',\n                message: '请完善表单信息'\n              });\n            case 26:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[2, 23], [7, 15, 18, 21]]);\n      }));\n      return function submitForm() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    // 标签相关方法\n    var showTagInput = function showTagInput() {\n      inputTagVisible.value = true;\n      nextTick(function () {\n        var _tagInputRef$value;\n        (_tagInputRef$value = tagInputRef.value) === null || _tagInputRef$value === void 0 || _tagInputRef$value.focus();\n      });\n    };\n    var handleInputTagConfirm = function handleInputTagConfirm() {\n      var inputValue = inputTagValue.value.trim();\n      if (inputValue && !vulnerabilityForm.tags.includes(inputValue)) {\n        vulnerabilityForm.tags.push(inputValue);\n      }\n      inputTagVisible.value = false;\n      inputTagValue.value = '';\n    };\n    var handleRemoveTag = function handleRemoveTag(tag) {\n      vulnerabilityForm.tags.splice(vulnerabilityForm.tags.indexOf(tag), 1);\n    };\n\n    // 资产相关方法\n    var showAssetDialog = function showAssetDialog() {\n      assetForm.name = '';\n      assetForm.details = '';\n      assetDialogVisible.value = true;\n    };\n    var handleAddAsset = function handleAddAsset() {\n      if (!assetForm.name.trim()) {\n        ElMessage({\n          type: 'warning',\n          message: '请输入资产名称'\n        });\n        return;\n      }\n      vulnerabilityForm.affected_assets.push({\n        name: assetForm.name.trim(),\n        details: assetForm.details.trim()\n      });\n      assetDialogVisible.value = false;\n    };\n    var handleRemoveAsset = function handleRemoveAsset(asset) {\n      var index = vulnerabilityForm.affected_assets.findIndex(function (a) {\n        return a.name === asset.name;\n      });\n      if (index !== -1) {\n        vulnerabilityForm.affected_assets.splice(index, 1);\n      }\n    };\n\n    // 参考链接相关方法\n    var addReference = function addReference() {\n      vulnerabilityForm.references.push({\n        title: '',\n        url: ''\n      });\n    };\n    var removeReference = function removeReference(index) {\n      vulnerabilityForm.references.splice(index, 1);\n    };\n    return {\n      formRef: formRef,\n      loading: loading,\n      submitting: submitting,\n      vulnerabilityForm: vulnerabilityForm,\n      rules: rules,\n      descriptionTab: descriptionTab,\n      impactTab: impactTab,\n      stepsTab: stepsTab,\n      recommendationTab: recommendationTab,\n      inputTagVisible: inputTagVisible,\n      inputTagValue: inputTagValue,\n      tagInputRef: tagInputRef,\n      assetDialogVisible: assetDialogVisible,\n      assetForm: assetForm,\n      renderedDescription: renderedDescription,\n      renderedImpact: renderedImpact,\n      renderedSteps: renderedSteps,\n      renderedRecommendation: renderedRecommendation,\n      goBack: goBack,\n      submitForm: submitForm,\n      showTagInput: showTagInput,\n      handleInputTagConfirm: handleInputTagConfirm,\n      handleRemoveTag: handleRemoveTag,\n      showAssetDialog: showAssetDialog,\n      handleAddAsset: handleAddAsset,\n      handleRemoveAsset: handleRemoveAsset,\n      addReference: addReference,\n      removeReference: removeReference\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","computed","nextTick","useStore","useRouter","ElMessage","ElMessageBox","name","setup","store","router","formRef","loading","submitting","descriptionTab","impactTab","stepsTab","recommendationTab","tagInputRef","inputTagVisible","inputTagValue","assetDialogVisible","assetForm","details","vulnerabilityForm","title","description","impact","steps_to_reproduce","recommendation","severity","status","cve","cvss","cvss_vector","discoveredAt","Date","toISOString","slice","affected_assets","references","tags","rules","required","message","trigger","min","max","renderedDescription","concat","renderedImpact","renderedSteps","renderedRecommendation","goBack","formHasChanges","confirm","confirmButtonText","cancelButtonText","type","then","push","length","submitForm","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","vulnerabilityData","wrap","_callee$","_context","prev","next","value","abrupt","validate","_objectSpread","dispatch","t0","finish","t1","stop","apply","arguments","showTagInput","_tagInputRef$value","focus","handleInputTagConfirm","inputValue","trim","includes","handleRemoveTag","tag","splice","indexOf","showAssetDialog","handleAddAsset","handleRemoveAsset","asset","index","findIndex","a","addReference","url","removeReference"],"sources":["/Users/yue/Desktop/vuln-Management/frontend/src/views/vulnerabilities/VulnerabilityCreate.vue"],"sourcesContent":["<template>\n  <div class=\"vulnerability-create-page\">\n    <!-- 页面标题 -->\n    <div class=\"page-header\">\n      <div class=\"header-content\">\n        <div class=\"header-back\">\n          <el-button @click=\"goBack\" icon=\"el-icon-arrow-left\" type=\"text\" class=\"back-button\">\n            返回列表\n          </el-button>\n        </div>\n        <h1 class=\"page-title\">\n          <span class=\"title-icon\"><i class=\"el-icon-plus\"></i></span>\n          创建新漏洞\n          <span class=\"title-highlight\">记录</span>\n        </h1>\n        <p class=\"page-subtitle\">添加新发现的安全漏洞，记录详细信息以便团队跟进处理</p>\n      </div>\n    </div>\n\n    <div class=\"form-card\">\n      <el-form \n        ref=\"formRef\"\n        :model=\"vulnerabilityForm\" \n        :rules=\"rules\" \n        label-position=\"top\"\n        v-loading=\"loading\"\n      >\n        <!-- 基本信息卡片 -->\n        <div class=\"section-card\">\n          <div class=\"section-header\">\n            <h2 class=\"section-title\">\n              <i class=\"el-icon-info section-icon\"></i>\n              基本信息\n            </h2>\n            <span class=\"section-subtitle\">漏洞的基本描述和分类信息</span>\n          </div>\n\n          <el-row :gutter=\"24\">\n            <el-col :xs=\"24\" :sm=\"24\" :md=\"24\">\n              <el-form-item label=\"漏洞标题\" prop=\"title\">\n                <el-input \n                  v-model=\"vulnerabilityForm.title\" \n                  placeholder=\"输入漏洞标题，简洁且能清晰表明漏洞类型\"\n                />\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row :gutter=\"24\">\n            <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n              <el-form-item label=\"CVE编号\" prop=\"cve\">\n                <el-input \n                  v-model=\"vulnerabilityForm.cve\" \n                  placeholder=\"例如: CVE-2023-12345（如有）\"\n                  clearable\n                />\n              </el-form-item>\n            </el-col>\n            <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n              <el-form-item label=\"严重程度\" prop=\"severity\">\n                <el-select \n                  v-model=\"vulnerabilityForm.severity\" \n                  placeholder=\"选择漏洞严重程度\" \n                  style=\"width: 100%\"\n                >\n                  <el-option label=\"严重\" value=\"critical\">\n                    <template #default>\n                      <div class=\"severity-option\">\n                        <span class=\"severity-dot critical\"></span>\n                        <span>严重</span>\n                      </div>\n                    </template>\n                  </el-option>\n                  <el-option label=\"高危\" value=\"high\">\n                    <template #default>\n                      <div class=\"severity-option\">\n                        <span class=\"severity-dot high\"></span>\n                        <span>高危</span>\n                      </div>\n                    </template>\n                  </el-option>\n                  <el-option label=\"中危\" value=\"medium\">\n                    <template #default>\n                      <div class=\"severity-option\">\n                        <span class=\"severity-dot medium\"></span>\n                        <span>中危</span>\n                      </div>\n                    </template>\n                  </el-option>\n                  <el-option label=\"低危\" value=\"low\">\n                    <template #default>\n                      <div class=\"severity-option\">\n                        <span class=\"severity-dot low\"></span>\n                        <span>低危</span>\n                      </div>\n                    </template>\n                  </el-option>\n                  <el-option label=\"信息\" value=\"info\">\n                    <template #default>\n                      <div class=\"severity-option\">\n                        <span class=\"severity-dot info\"></span>\n                        <span>信息</span>\n                      </div>\n                    </template>\n                  </el-option>\n                </el-select>\n              </el-form-item>\n            </el-col>\n            <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n              <el-form-item label=\"状态\" prop=\"status\">\n                <el-select \n                  v-model=\"vulnerabilityForm.status\" \n                  placeholder=\"选择漏洞状态\" \n                  style=\"width: 100%\"\n                >\n                  <el-option label=\"开放\" value=\"open\" />\n                  <el-option label=\"处理中\" value=\"in_progress\" />\n                  <el-option label=\"已解决\" value=\"resolved\" />\n                  <el-option label=\"已关闭\" value=\"closed\" />\n                  <el-option label=\"误报\" value=\"false_positive\" />\n                </el-select>\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row :gutter=\"24\">\n            <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n              <el-form-item label=\"发现日期\" prop=\"discoveredAt\">\n                <el-date-picker \n                  v-model=\"vulnerabilityForm.discoveredAt\" \n                  type=\"date\" \n                  placeholder=\"选择漏洞发现日期\"\n                  value-format=\"yyyy-MM-dd\"\n                  style=\"width: 100%\"\n                />\n              </el-form-item>\n            </el-col>\n            <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n              <el-form-item label=\"CVSS评分\" prop=\"cvss\">\n                <el-input-number \n                  v-model=\"vulnerabilityForm.cvss\" \n                  :min=\"0\" \n                  :max=\"10\" \n                  :precision=\"1\" \n                  :step=\"0.1\"\n                  style=\"width: 100%\"\n                />\n              </el-form-item>\n            </el-col>\n            <el-col :xs=\"24\" :sm=\"12\" :md=\"8\">\n              <el-form-item label=\"CVSS向量\" prop=\"cvss_vector\">\n                <el-input \n                  v-model=\"vulnerabilityForm.cvss_vector\" \n                  placeholder=\"例如: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\"\n                  clearable\n                />\n              </el-form-item>\n            </el-col>\n          </el-row>\n        </div>\n\n        <!-- 详细描述卡片 -->\n        <div class=\"section-card\">\n          <div class=\"section-header\">\n            <h2 class=\"section-title\">\n              <i class=\"el-icon-document section-icon\"></i>\n              详细描述\n            </h2>\n            <span class=\"section-subtitle\">漏洞的详细描述和分析</span>\n          </div>\n\n          <el-form-item label=\"漏洞描述\" prop=\"description\">\n            <el-tabs v-model=\"descriptionTab\">\n              <el-tab-pane label=\"编辑\" name=\"edit\">\n                <el-input \n                  v-model=\"vulnerabilityForm.description\" \n                  type=\"textarea\" \n                  :rows=\"8\"\n                  placeholder=\"详细描述漏洞的情况、原理等信息（支持Markdown格式）\"\n                />\n              </el-tab-pane>\n              <el-tab-pane label=\"预览\" name=\"preview\">\n                <div v-if=\"!vulnerabilityForm.description\" class=\"empty-preview\">\n                  暂无内容预览\n                </div>\n                <div v-else class=\"markdown-preview\" v-html=\"renderedDescription\"></div>\n              </el-tab-pane>\n            </el-tabs>\n          </el-form-item>\n\n          <el-form-item label=\"影响分析\" prop=\"impact\">\n            <el-tabs v-model=\"impactTab\">\n              <el-tab-pane label=\"编辑\" name=\"edit\">\n                <el-input \n                  v-model=\"vulnerabilityForm.impact\" \n                  type=\"textarea\" \n                  :rows=\"6\"\n                  placeholder=\"描述漏洞可能造成的安全影响和危害（支持Markdown格式）\"\n                />\n              </el-tab-pane>\n              <el-tab-pane label=\"预览\" name=\"preview\">\n                <div v-if=\"!vulnerabilityForm.impact\" class=\"empty-preview\">\n                  暂无内容预览\n                </div>\n                <div v-else class=\"markdown-preview\" v-html=\"renderedImpact\"></div>\n              </el-tab-pane>\n            </el-tabs>\n          </el-form-item>\n\n          <el-form-item label=\"复现步骤\" prop=\"steps_to_reproduce\">\n            <el-tabs v-model=\"stepsTab\">\n              <el-tab-pane label=\"编辑\" name=\"edit\">\n                <el-input \n                  v-model=\"vulnerabilityForm.steps_to_reproduce\" \n                  type=\"textarea\" \n                  :rows=\"6\"\n                  placeholder=\"详细列出漏洞的复现步骤，便于其他人理解和验证（支持Markdown格式）\"\n                />\n              </el-tab-pane>\n              <el-tab-pane label=\"预览\" name=\"preview\">\n                <div v-if=\"!vulnerabilityForm.steps_to_reproduce\" class=\"empty-preview\">\n                  暂无内容预览\n                </div>\n                <div v-else class=\"markdown-preview\" v-html=\"renderedSteps\"></div>\n              </el-tab-pane>\n            </el-tabs>\n          </el-form-item>\n\n          <el-form-item label=\"修复建议\" prop=\"recommendation\">\n            <el-tabs v-model=\"recommendationTab\">\n              <el-tab-pane label=\"编辑\" name=\"edit\">\n                <el-input \n                  v-model=\"vulnerabilityForm.recommendation\" \n                  type=\"textarea\" \n                  :rows=\"6\"\n                  placeholder=\"提供修复或缓解该漏洞的方法和建议（支持Markdown格式）\"\n                />\n              </el-tab-pane>\n              <el-tab-pane label=\"预览\" name=\"preview\">\n                <div v-if=\"!vulnerabilityForm.recommendation\" class=\"empty-preview\">\n                  暂无内容预览\n                </div>\n                <div v-else class=\"markdown-preview\" v-html=\"renderedRecommendation\"></div>\n              </el-tab-pane>\n            </el-tabs>\n          </el-form-item>\n        </div>\n\n        <!-- 额外信息卡片 -->\n        <div class=\"section-card\">\n          <div class=\"section-header\">\n            <h2 class=\"section-title\">\n              <i class=\"el-icon-info section-icon\"></i>\n              额外信息\n            </h2>\n            <span class=\"section-subtitle\">受影响资产和参考链接</span>\n          </div>\n\n          <el-form-item label=\"受影响资产\" prop=\"affected_assets\">\n            <el-tag\n              v-for=\"(asset, index) in vulnerabilityForm.affected_assets\"\n              :key=\"index\"\n              closable\n              :disable-transitions=\"false\"\n              @close=\"handleRemoveAsset(asset)\"\n              class=\"tag-item\"\n            >\n              {{ asset.name }}\n            </el-tag>\n            <el-button type=\"text\" @click=\"showAssetDialog\" class=\"add-tag-button\">\n              <i class=\"el-icon-plus\"></i> 添加资产\n            </el-button>\n          </el-form-item>\n\n          <el-form-item label=\"参考链接\" prop=\"references\">\n            <div v-for=\"(reference, index) in vulnerabilityForm.references\" :key=\"index\" class=\"reference-item\">\n              <el-input \n                v-model=\"reference.title\" \n                placeholder=\"参考标题\" \n                class=\"reference-title-input\"\n              />\n              <el-input \n                v-model=\"reference.url\" \n                placeholder=\"参考链接URL\" \n                class=\"reference-url-input\"\n              />\n              <el-button \n                type=\"danger\" \n                icon=\"el-icon-delete\" \n                circle \n                size=\"mini\"\n                @click=\"removeReference(index)\"\n              />\n            </div>\n            <el-button type=\"text\" @click=\"addReference\" class=\"add-reference-button\">\n              <i class=\"el-icon-plus\"></i> 添加参考链接\n            </el-button>\n          </el-form-item>\n        </div>\n\n        <el-form-item label=\"标签\" prop=\"tags\">\n          <el-tag\n            v-for=\"tag in vulnerabilityForm.tags\"\n            :key=\"tag\"\n            closable\n            :disable-transitions=\"false\"\n            @close=\"handleRemoveTag(tag)\"\n            class=\"tag-item\"\n          >\n            {{ tag }}\n          </el-tag>\n          <el-input\n            v-if=\"inputTagVisible\"\n            ref=\"tagInputRef\"\n            v-model=\"inputTagValue\"\n            class=\"tag-input\"\n            size=\"small\"\n            @keyup.enter=\"handleInputTagConfirm\"\n            @blur=\"handleInputTagConfirm\"\n          />\n          <el-button v-else type=\"text\" @click=\"showTagInput\" class=\"add-tag-button\">\n            <i class=\"el-icon-plus\"></i> 添加标签\n          </el-button>\n        </el-form-item>\n\n        <!-- 表单底部操作按钮 -->\n        <div class=\"form-actions\">\n          <el-button @click=\"goBack\" class=\"cancel-btn\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"submitting\" class=\"submit-btn\">\n            <i class=\"el-icon-check\"></i> 保存漏洞\n          </el-button>\n        </div>\n      </el-form>\n    </div>\n\n    <!-- 添加资产对话框 -->\n    <el-dialog\n      title=\"添加受影响资产\"\n      v-model=\"assetDialogVisible\"\n      width=\"500px\"\n    >\n      <el-form :model=\"assetForm\" label-position=\"top\">\n        <el-form-item label=\"资产名称\" required>\n          <el-input v-model=\"assetForm.name\" placeholder=\"输入资产名称\" />\n        </el-form-item>\n        <el-form-item label=\"资产详情\">\n          <el-input \n            v-model=\"assetForm.details\" \n            type=\"textarea\" \n            :rows=\"3\"\n            placeholder=\"对资产的详细描述，如版本、位置等\"\n          />\n        </el-form-item>\n      </el-form>\n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"assetDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"handleAddAsset\">添加</el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, computed, nextTick } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport { ElMessage, ElMessageBox } from 'element-plus'\n\nexport default {\n  name: 'VulnerabilityCreate',\n  \n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const formRef = ref(null)\n    \n    const loading = ref(false)\n    const submitting = ref(false)\n    \n    // Markdown 编辑的标签页状态\n    const descriptionTab = ref('edit')\n    const impactTab = ref('edit')\n    const stepsTab = ref('edit')\n    const recommendationTab = ref('edit')\n    \n    // 标签输入相关\n    const tagInputRef = ref(null)\n    const inputTagVisible = ref(false)\n    const inputTagValue = ref('')\n    \n    // 资产对话框\n    const assetDialogVisible = ref(false)\n    const assetForm = reactive({\n      name: '',\n      details: ''\n    })\n    \n    // 漏洞表单数据\n    const vulnerabilityForm = reactive({\n      title: '',\n      description: '',\n      impact: '',\n      steps_to_reproduce: '',\n      recommendation: '',\n      severity: 'medium',\n      status: 'open',\n      cve: '',\n      cvss: 0,\n      cvss_vector: '',\n      discoveredAt: new Date().toISOString().slice(0, 10),\n      affected_assets: [],\n      references: [],\n      tags: []\n    })\n    \n    // 表单验证规则\n    const rules = {\n      title: [\n        { required: true, message: '请输入漏洞标题', trigger: 'blur' },\n        { min: 3, max: 200, message: '长度在 3 到 200 个字符', trigger: 'blur' }\n      ],\n      description: [\n        { required: true, message: '请输入漏洞描述', trigger: 'blur' }\n      ],\n      severity: [\n        { required: true, message: '请选择严重程度', trigger: 'change' }\n      ],\n      status: [\n        { required: true, message: '请选择漏洞状态', trigger: 'change' }\n      ],\n      discoveredAt: [\n        { required: true, message: '请选择发现日期', trigger: 'change' }\n      ]\n    }\n    \n    // 简化的内容渲染，不使用marked和dompurify\n    const renderedDescription = computed(() => {\n      if (!vulnerabilityForm.description) return ''\n      return `<p>${vulnerabilityForm.description}</p>`\n    })\n    \n    const renderedImpact = computed(() => {\n      if (!vulnerabilityForm.impact) return ''\n      return `<p>${vulnerabilityForm.impact}</p>`\n    })\n    \n    const renderedSteps = computed(() => {\n      if (!vulnerabilityForm.steps_to_reproduce) return ''\n      return `<p>${vulnerabilityForm.steps_to_reproduce}</p>`\n    })\n    \n    const renderedRecommendation = computed(() => {\n      if (!vulnerabilityForm.recommendation) return ''\n      return `<p>${vulnerabilityForm.recommendation}</p>`\n    })\n    \n    // 返回列表\n    const goBack = () => {\n      if (formHasChanges()) {\n        ElMessageBox.confirm(\n          '表单内容已修改，确定要离开吗？',\n          '提示',\n          {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }\n        ).then(() => {\n          router.push('/vulnerabilities')\n        }).catch(() => {\n          // 用户取消\n        })\n      } else {\n        router.push('/vulnerabilities')\n      }\n    }\n    \n    // 判断表单是否有修改\n    const formHasChanges = () => {\n      return vulnerabilityForm.title ||\n        vulnerabilityForm.description ||\n        vulnerabilityForm.impact ||\n        vulnerabilityForm.steps_to_reproduce ||\n        vulnerabilityForm.recommendation ||\n        vulnerabilityForm.cvss !== 0 ||\n        vulnerabilityForm.cve ||\n        vulnerabilityForm.cvss_vector ||\n        vulnerabilityForm.affected_assets.length > 0 ||\n        vulnerabilityForm.references.length > 0 ||\n        vulnerabilityForm.tags.length > 0\n    }\n    \n    // 提交表单\n    const submitForm = async () => {\n      if (!formRef.value) return\n      \n      try {\n        await formRef.value.validate()\n        \n        submitting.value = true\n        \n        // 准备提交的数据\n        const vulnerabilityData = { ...vulnerabilityForm }\n        \n        try {\n          // 创建漏洞\n          await store.dispatch('vulnerability/createVulnerability', vulnerabilityData)\n          \n          // 刷新仪表盘数据\n          store.dispatch('dashboard/fetchDashboardData')\n          \n          ElMessage({\n            type: 'success',\n            message: '漏洞创建成功'\n          })\n          \n          router.push('/vulnerabilities')\n        } catch (error) {\n          ElMessage({\n            type: 'error',\n            message: '创建漏洞失败: ' + (error.message || '未知错误')\n          })\n        } finally {\n          submitting.value = false\n        }\n      } catch (error) {\n        ElMessage({\n          type: 'warning',\n          message: '请完善表单信息'\n        })\n      }\n    }\n    \n    // 标签相关方法\n    const showTagInput = () => {\n      inputTagVisible.value = true\n      nextTick(() => {\n        tagInputRef.value?.focus()\n      })\n    }\n    \n    const handleInputTagConfirm = () => {\n      const inputValue = inputTagValue.value.trim()\n      if (inputValue && !vulnerabilityForm.tags.includes(inputValue)) {\n        vulnerabilityForm.tags.push(inputValue)\n      }\n      inputTagVisible.value = false\n      inputTagValue.value = ''\n    }\n    \n    const handleRemoveTag = (tag) => {\n      vulnerabilityForm.tags.splice(vulnerabilityForm.tags.indexOf(tag), 1)\n    }\n    \n    // 资产相关方法\n    const showAssetDialog = () => {\n      assetForm.name = ''\n      assetForm.details = ''\n      assetDialogVisible.value = true\n    }\n    \n    const handleAddAsset = () => {\n      if (!assetForm.name.trim()) {\n        ElMessage({\n          type: 'warning',\n          message: '请输入资产名称'\n        })\n        return\n      }\n      \n      vulnerabilityForm.affected_assets.push({\n        name: assetForm.name.trim(),\n        details: assetForm.details.trim()\n      })\n      \n      assetDialogVisible.value = false\n    }\n    \n    const handleRemoveAsset = (asset) => {\n      const index = vulnerabilityForm.affected_assets.findIndex(a => a.name === asset.name)\n      if (index !== -1) {\n        vulnerabilityForm.affected_assets.splice(index, 1)\n      }\n    }\n    \n    // 参考链接相关方法\n    const addReference = () => {\n      vulnerabilityForm.references.push({ title: '', url: '' })\n    }\n    \n    const removeReference = (index) => {\n      vulnerabilityForm.references.splice(index, 1)\n    }\n    \n    return {\n      formRef,\n      loading,\n      submitting,\n      vulnerabilityForm,\n      rules,\n      descriptionTab,\n      impactTab,\n      stepsTab,\n      recommendationTab,\n      inputTagVisible,\n      inputTagValue,\n      tagInputRef,\n      assetDialogVisible,\n      assetForm,\n      renderedDescription,\n      renderedImpact,\n      renderedSteps,\n      renderedRecommendation,\n      goBack,\n      submitForm,\n      showTagInput,\n      handleInputTagConfirm,\n      handleRemoveTag,\n      showAssetDialog,\n      handleAddAsset,\n      handleRemoveAsset,\n      addReference,\n      removeReference\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.vulnerability-create-page {\n  padding: 24px;\n  animation: fadeIn 0.6s ease;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; transform: translateY(10px); }\n  to { opacity: 1; transform: translateY(0); }\n}\n\n.page-header {\n  margin-bottom: 24px;\n  \n  .header-back {\n    margin-bottom: 16px;\n    \n    .back-button {\n      display: flex;\n      align-items: center;\n      color: #409EFF;\n      padding: 0;\n      transition: all 0.3s;\n      \n      i {\n        margin-right: 6px;\n        font-size: 16px;\n      }\n      \n      &:hover {\n        transform: translateX(-4px);\n        color: #66b1ff;\n      }\n    }\n  }\n  \n  .page-title {\n    font-size: 28px;\n    font-weight: 600;\n    margin: 0 0 8px 0;\n    display: flex;\n    align-items: center;\n    color: #303133;\n    \n    .title-icon {\n      margin-right: 12px;\n      font-size: 28px;\n      color: #409EFF;\n    }\n    \n    .title-highlight {\n      background: linear-gradient(120deg, #409EFF, #53A8FF);\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      margin-left: 8px;\n      font-weight: 700;\n    }\n  }\n  \n  .page-subtitle {\n    color: #606266;\n    font-size: 16px;\n    margin: 0;\n  }\n}\n\n.form-card {\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.03);\n  padding: 20px;\n  margin-bottom: 24px;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);\n  }\n}\n\n.section-card {\n  background: #f9fbfd;\n  border-radius: 8px;\n  padding: 20px;\n  margin-bottom: 24px;\n  transition: all 0.3s ease;\n  \n  &:hover {\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n  }\n}\n\n.section-header {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 20px;\n  \n  .section-title {\n    font-size: 18px;\n    font-weight: 600;\n    margin: 0 0 6px 0;\n    color: #303133;\n    display: flex;\n    align-items: center;\n    \n    .section-icon {\n      margin-right: 8px;\n      color: #409EFF;\n    }\n  }\n  \n  .section-subtitle {\n    color: #909399;\n    font-size: 14px;\n  }\n}\n\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 32px;\n  gap: 12px;\n  \n  .cancel-btn {\n    border-radius: 8px;\n    padding: 10px 20px;\n  }\n  \n  .submit-btn {\n    border-radius: 8px;\n    padding: 10px 24px;\n    font-weight: 500;\n    transition: all 0.3s;\n    \n    i {\n      margin-right: 6px;\n    }\n    \n    &:hover {\n      transform: translateY(-2px);\n      box-shadow: 0 4px 12px rgba(64, 158, 255, 0.2);\n    }\n  }\n}\n\n.severity-option {\n  display: flex;\n  align-items: center;\n  \n  .severity-dot {\n    width: 10px;\n    height: 10px;\n    border-radius: 50%;\n    margin-right: 8px;\n    \n    &.critical {\n      background-color: #F44336;\n    }\n    \n    &.high {\n      background-color: #FF9800;\n    }\n    \n    &.medium {\n      background-color: #FFEB3B;\n    }\n    \n    &.low {\n      background-color: #4CAF50;\n    }\n    \n    &.info {\n      background-color: #2196F3;\n    }\n  }\n}\n\n// 表单元素样式优化\n:deep(.el-form-item__label) {\n  padding-bottom: 8px;\n  font-weight: 500;\n  color: #606266;\n}\n\n:deep(.el-input__inner), :deep(.el-textarea__inner) {\n  border-radius: 8px;\n  transition: all 0.3s;\n  \n  &:focus {\n    box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);\n  }\n}\n\n:deep(.el-select-dropdown__item) {\n  padding: 8px 12px;\n}\n\n// 响应式调整\n@media (max-width: 768px) {\n  .vulnerability-create-page {\n    padding: 16px;\n  }\n  \n  .page-header {\n    .page-title {\n      font-size: 24px;\n      \n      .title-icon {\n        font-size: 24px;\n      }\n    }\n    \n    .page-subtitle {\n      font-size: 14px;\n    }\n  }\n  \n  .form-card, .section-card {\n    padding: 16px;\n  }\n  \n  .section-header {\n    .section-title {\n      font-size: 16px;\n    }\n  }\n  \n  .form-actions {\n    flex-direction: column-reverse;\n    \n    .el-button {\n      width: 100%;\n    }\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}